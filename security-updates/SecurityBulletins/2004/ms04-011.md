---
TOCTitle: 'MS04-011'
Title: 'Microsoft Security Bulletin MS04-011 - 重大'
ms:assetid: 'ms04-011'
ms:contentKeyID: 61237350
ms:date: '04/18/2014'
ms:mtpsurl: 'https://technet.microsoft.com/zh-TW/library/ms04-011(v=Security.10)'
---

Security Bulletin

Microsoft Security Bulletin MS04-011 - 重大
===========================================

Microsoft Windows (835732) 安全性更新
-------------------------------------

發行: 2004年4月13日 | 更新: 2004年8月10日

**發佈日期：**2004 年 4 月 14 日
**更新日期：**2006 年 8 月 14 日
**版本：** 2.0

#### 摘要

**應該閱讀此文件的對象：**使用 Microsoft® Windows® 的客戶

**這個弱點的影響：**遠端執行程式碼

**最高的嚴重性等級：**重大

**建議：**客戶應立即套用此更新程式。

**安全性更新取代資訊：** 本公告會取代數個先前發行的安全性更新程式。請參閱本公告的＜常見問題集＞(FAQ) 以查看完整的清單。

**警告：**安裝 Windows NT Server 4.0 Terminal Server Edition Service Pack 6 的安全性更新之前，需要先套用 Windows NT Server 4.0 Terminal Server Edition 安全性彙總套件 (SRP)。如果要下載 SRP，請到這個[網站](http://www.microsoft.com/ntserver/terminalserver/downloads/critical/q317636/default.asp)下載。 您必須先安裝 SRP，才能安裝本安全性公告提供的安全性更新程式。如果您並未使用 Windows NT Server 4.0 Terminal Server Edition Service Pack 6，就不需要安裝 SRP。

Microsoft 知識庫文件編號 [835732](http://support.microsoft.com/default.aspx?scid=kb;en-us;835732) 記載了客戶在安裝本安全性更新時可能會遇到的一些已知問題。本文章同時也包含這些問題的建議解決方法。如需更多資訊，請參閱 Microsoft 知識庫文件編號 [835732](http://support.microsoft.com/default.aspx?scid=kb;en-us;835732)。

**受影響的軟體：**

-   Microsoft Windows NT® Workstation 4.0 Service Pack 6a –[英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=7f1713fc-f95c-43e5-b825-3cf72c1a0a3e&displaylang=en) │ [中文下載更新程式](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-tw&familyid=7f1713fc-f95c-43e5-b825-3cf72c1a0a3e)
-   Microsoft Windows NT Server 4.0 Service Pack 6a –[英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=67a6f461-d2fc-4aa0-957e-3b8dc44f9d79&displaylang=en) │ [中文下載更新程式](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-tw&familyid=67a6f461-d2fc-4aa0-957e-3b8dc44f9d79)
-   Microsoft Windows NT Server 4.0 Terminal Server Edition Service Pack 6 –[英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=62cba527-a827-4777-8641-28092d3aae4f&displaylang=en)
-   Microsoft Windows 2000 Service Pack 2, Microsoft Windows 2000 Service Pack 3, and Microsoft Windows 2000 Service Pack 4 – [英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=0692c27e-f63a-414c-b3eb-d2342fbb6c00&displaylang=en) │ [中文下載更新程式](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-tw&familyid=0692c27e-f63a-414c-b3eb-d2342fbb6c00)
-   Microsoft Windows XP and Microsoft Windows XP Service Pack 1 –[英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=3549ea9e-da3f-43b9-a4f1-af243b6168f3&displaylang=en) │ [中文下載更新程式](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-tw&familyid=3549ea9e-da3f-43b9-a4f1-af243b6168f3)
-   Microsoft Windows XP 64-Bit Edition Service Pack 1 –[英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=c6b55ef2-d9fe-4dbe-ab7d-73a20c82ff73&displaylang=en)
-   Microsoft Windows XP 64-Bit Edition Version 2003 –[英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=c207d372-e883-44a6-a107-6cd2d29fc6f5&displaylang=en)
-   Microsoft Windows Server™ 2003 –[英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=eab176d0-01cf-453e-ae7e-7495864e8d8c&displaylang=en) │ [中文下載更新程式](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-tw&familyid=eab176d0-01cf-453e-ae7e-7495864e8d8c)
-   Microsoft Windows Server 2003 64-Bit Edition - [英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=c207d372-e883-44a6-a107-6cd2d29fc6f5&displaylang=en)
-   Microsoft NetMeeting
-   Microsoft Windows 98, Microsoft Windows 98 Second Edition (SE), and Microsoft Windows Millennium Edition (ME) – Review the FAQ section of this bulletin for details about these operating systems.

以上所列的軟體版本已經過測試判斷其是否會受到影響。其他版本已不再包含安全性更新支援，同時也不一定會受到影響。請瀏覽 [Microsoft 技術支援週期準則](http://go.microsoft.com/fwlink/?linkid=21742)網站，以瞭解您的產品及版本的支援生命週期。

### 一般資訊

詳細技術資訊
------------

<span></span>
**提要：**

Microsoft 在 2004 年 6 月 15 日重新發行此公告是對泛中文版的 Windows NT 4.0 Workstation 更新提出通知。

此建議的更新修正了部份客戶在原始更新遇到的安裝問題。此問題與公告上所探討的安全性弱點並無關聯。不過，此問題已導致一些客戶無法安裝更新。如果您先前有套用過此安全性更新，並不需要安裝此更新來避免在安裝未來安全性更新時發生的潛在問題。此問題只會影響該更新的泛中文版本，以及重新發行過的那些更新版本。此更新的其他語言版本並不會受到影響，也不會重新發行。

本次更新能解決一些最新發現的弱點。本公告會分節說明各項弱點的相關資訊。

一旦攻擊得逞，最嚴重的情況，是攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

Microsoft 建議客戶應該立即套用此更新程式。

**嚴重性等級和弱點識別碼：**

| 弱點識別碼                                                                                                                        | 這個弱點的影響 | Windows 98、SE、ME | Windows NT 4.0 | Windows 2000 | Windows XP | Windows Server 2003 |
|-----------------------------------------------------------------------------------------------------------------------------------|----------------|--------------------|----------------|--------------|------------|---------------------|
| LSASS 弱點 - [CAN-2003-0533](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0533)                                     | 遠端執行程式碼 | 無                 | 無             | 重大         | 重大       | 低                  |
| LDAP 弱點 - [CAN-2003-0663](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0663)                                      | 拒絕服務       | 無                 | 無             | 重要         | 無         | 無                  |
| PCT 弱點 - [CAN-2003-0719](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0719)                                       | 遠端執行程式碼 | 無                 | 重大           | 重大         | 重大       | 低                  |
| Winlogon 弱點 - [CAN-2003-0806](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0806)                                  | 遠端執行程式碼 | 無                 | 中度           | 中度         | 中度       | 無                  |
| 中繼檔弱點 - [](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0906)CAN-2003-0906                                     | 遠端執行程式碼 | 無                 | 重大           | 重大         | 重大       | 無                  |
| 說明及支援中心弱點 - [CAN-2003-0907](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0907)                             | 遠端執行程式碼 | 無                 | 無             | 無           | 重大       | 重大                |
| 公用程式管理員弱點 - [CAN-2003-0908](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0908)                             | 提高權限       | 無                 | 無             | 重要         | 無         | 無                  |
| Windows 管理弱點 - [](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0909)CAN-2003-0909                               | 提高權限       | 無                 | 無             | 無           | 重要       | 無                  |
| 本機描述元表弱點 - [CAN-2003-0910](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0910)                               | 提高權限       | 無                 | 重要           | 重要         | 無         | 無                  |
| H.323 弱點\* - [CAN-2004-0117](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0117)                                   | 遠端執行程式碼 | 非重大             | 無             | 重要         | 重要       | 重要                |
| 虛擬 DOS 機器 (VDM) 弱點 - [CAN-2004-0118](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0118)                       | 提高權限       | 無                 | 重要           | 重要         | 無         | 無                  |
| 交涉 SSP 弱點 - [CAN-2004-0119](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=%20can-2004-0119)                               | 遠端執行程式碼 | 無                 | 無             | 重大         | 重大       | 重大                |
| SSL弱點 - [CAN-2004-0120](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=%20can-2004-0120)                                     | 拒絕服務       | 無                 | 無             | 重要         | 重要       | 重要                |
| ASN.1 Double Free (重複釋放相同記憶體) 弱點 - [CAN-2004-0123](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=%20can-2004-0123) | 遠端執行程式碼 | 非重大             | 重大           | 重大         | 重大       | 重大                |
| **所有弱點的彙總嚴重性**                                                                                                          |                | **非重大**         | **重大**       | **重大**     | **重大**   | **重大**            |

**\*注意** H.323 弱點 - CAN-2004-0117 的嚴重性等級對 NetMeeting 獨立版為重要。下列[網站](http://www.microsoft.com/windows/netmeeting/)中可以找到能解決此弱點的 NetMeeting 更新版。此 NetMeeting 版本可以安裝在所有 Windows 98、Windows 98 Second Edition、Windows Millennium Edition，以及 Windows NT 4.0 的系統中。

以上[評估](http://technet.microsoft.com/security/bulletin/rating)的根據包括：受弱點影響的系統類型、系統的一般部署模式，以及利用弱點對系統所造成的影響後果。

與本安全性更新相關的常見問題集
------------------------------

<span></span>
**Microsoft 為什麼要重新發行此公告？**
Microsoft 在 2004 年 6 月 15 日重新發行此公告是對泛中文版的 Windows NT 4.0 Workstation 更新提出通知。

此建議的更新修正了部份客戶在原始更新遇到的安裝問題。此問題與公告上所探討的安全性弱點並無關聯。不過，此問題已導致一些客戶無法安裝更新。如果您先前有套用過此安全性更新，並不需要安裝此更新來避免在安裝未來安全性更新時發生的潛在問題。此問題只會影響該更新的泛中文版本，以及重新發行過的那些更新版本。此更新的其他語言版本並不會受到影響，也不會重新發行。

**為什麼這個更新要解決幾個已報告的安全性弱點？**
此更新包含對於數個弱點的支援，因為解決這些問題所需要的修改位於相關檔案中。與其安裝數個包含幾乎完全相同檔案的更新，客戶只要安裝這個更新即可。

**這次發行的更新程式取代了哪些更新？**
本安全性更新取代了數個先前發行的安全性公告。下表列出受影響的安全性公告編號及相關的作業系統。

| 公告編號                                                                        | Windows NT 4.0 | Windows 2000 | Windows XP | Windows Server 2003 |
|---------------------------------------------------------------------------------|----------------|--------------|------------|---------------------|
| [**MS99-023**](http://technet.microsoft.com/security/bulletin/ms99-023)         | 取代           | 不適用       | 不適用     | 不適用              |
| [**MS00-027**](http://technet.microsoft.com/security/bulletin/ms00-027)         | 未取代         | 取代         | 不適用     | 不適用              |
| [**MS00-032**](http://technet.microsoft.com/security/bulletin/ms00-032)         | 不適用         | 取代         | 不適用     | 不適用              |
| [**MS00-070**](http://technet.microsoft.com/security/bulletin/ms00-070)         | 未取代         | 取代         | 不適用     | 不適用              |
| [**MS02-050**](http://www.microsoft.com/taiwan/security/bulletins/ms02-050.asp) | 取代           | 未取代       | 不適用     | 不適用              |
| [**MS02-051**](http://www.microsoft.com/taiwan/security/bulletins/ms02-051.asp) | 不適用         | 取代         | 未取代     | 不適用              |
| [**MS02-071**](http://www.microsoft.com/taiwan/security/bulletins/ms02-071.asp) | 取代           | 取代         | 取代       | 不適用              |
| [**MS03-007**](http://www.microsoft.com/taiwan/security/bulletins/ms03-007.asp) | 未取代         | 取代         | 未取代     | 不適用              |
| [**MS03-013**](http://www.microsoft.com/taiwan/security/bulletins/ms03-013.asp) | 取代           | 未取代       | 未取代     | 不適用              |
| [**MS03-025**](http://www.microsoft.com/taiwan/security/bulletins/ms03-025.asp) | 不適用         | 取代         | 不適用     | 不適用              |
| [**MS03-027**](http://www.microsoft.com/taiwan/security/bulletins/ms03-027.asp) | 不適用         | 不適用       | 未取代     | 不適用              |
| [**MS03-041**](http://www.microsoft.com/taiwan/security/bulletins/ms03-041.asp) | 取代           | 未取代       | 未取代     | 未取代              |
| [**MS03-045**](http://www.microsoft.com/taiwan/security/bulletins/ms03-045.asp) | 取代           | 取代         | 未取代     | 未取代              |

**這個更新是累計安全性更新程式或安全性更新彙總程式？**
都不是。累計安全性更新通常包含所有先前的更新；這個更新不包含支援所有平台上的所有先前更新。 安全性更新彙總程式通常會將先前的版本結合為單一的更新程式，使安裝更簡便、下載更快速。安全性更新彙總程式不會包含新的修改以解決新的弱點，本更新程式則包含了這些部份。

A Security Update Roll-up is typically used to combine previous releases into a single update to allow for easier installation and faster download. Security Update Roll-ups typically do not include modifications to address new vulnerabilities; this update does.

**Windows 98、Windows 98 Second Edition 和 Windows Millennium Edition 的延伸支援服務，對於針對這些作業系統發行的安全性更新有什麼影響？**
Microsoft 僅會針對重大安全性問題發行安全性更新。在支援服務期間，不會對非重大安全性的問題提供安全性更新。如想瞭解這些作業系統的 Microsoft 技術支援週期準則，請瀏覽這個[網站](http://support.microsoft.com/default.aspx?pr=lifean1)。

如需更多有關這些嚴重性等級的資訊，請參閱此[網站](http://technet.microsoft.com/security/bulletin/rating)。

**本安全性公告所提到的弱點，是否會對 Windows 98、Windows 98 Second Edition 或 Windows Millennium Edition 帶來重大的影響？**
不會。這些弱點都不會對 Windows 98、Windows 98 Second Edition 或 Windows Millennium Edition 造成任何重大的影響。

**本更新程式是否包含任何其他功能的變更？**
是的。除了以下每個弱點詳細資訊章節中列出的變更外，這個更新還包含下列功能上的變更。副檔名為 .folder 的檔案不再與目錄關聯。相關系統仍然支援包含此副檔名的檔案；不過這些檔案不會繼續在 Windows 檔案總管和其他應用程式中顯示成為目錄。

**是否能使用 Microsoft Baseline Security Analyzer (MBSA) 來判斷是否需要此更新？**
可以。MBSA 能判斷是否需要此更新程式。不過，目前 MBSA 不支援為單機版 NetMeeting 進行偵測。如果單機版 NetMeeting 是安裝於 Windows NT 4.0 系統上，MBSA 便無法為它提供需要的更新。在此[網站](http://www.microsoft.com/windows/netmeeting/)中，可以下載能解決 H.323 弱點 (CAN-2004-0117) 的 NetMeeting 單機更新版。MBSA 會偵測 Windows 2000、Windows XP 或 Windows Server 2003 之中提供的 NetMeeting 版本是否需要 H.323 弱點 (CAN-2004-0117) 的更新程式。

如需有關 H.323 弱點 (CAN-2004-0117) 的進一步資訊，請參閱本公告中關於該項弱點的部份。如需有關 MBSA 的進一步資訊，請參閱 [MBSA](http://go.microsoft.com/fwlink/?linkid=21134) 網站。如需有關 MBSA 偵測限制的進一步資訊，請參閱 Microsoft 知識庫文件編號 [306460](http://support.microsoft.com/default.aspx?scid=kb;zh-tw;306460)。

**這些變更與本公告初次發行時的情形有何不同？**
當本公告於 2004 年 4 月 13 日初次發行時，尚未對單機版 NetMeeting 提供偵測支援 (如本公告前面所述)，因此 MBSA 對於 Windows NT 4.0 系統停用本安全性更新的偵測功能。這個情形到 2004 年 4 月 21 日時已有所變更。即使這項限制仍然存在，MBSA 現在可以偵測 Windows NT 4.0 是否需要這個安全性更新。

**是否能使用 Systems Management Server (SMS) 來判斷是否需要此更新？**
可以。MBSA 能判斷是否需要此更新程式。如需有關 MBSA 的進一步資訊，請參閱 [MBSA 網站](http://go.microsoft.com/fwlink/?linkid=21134)。SMS 會使用 MBSA 進行偵測，因此 SMS 也會面臨本公告先前所述有關單機版 NetMeeting 的同樣限制。

**我是否能用 Systems Management Server (SMS) 判斷 Windows NT 4.0 系統中是否安裝了單機版的 NetMeeting？**
可以。SMS 可以協助判斷 Windows NT 4.0 系統是否需要更新的單機版 NetMeeting。SMS 會搜尋一個名為 "Conf.exe" 的檔案。所有早於 3.01 (4.4.3399) 的版本都應該要更新。

弱點詳細資訊
------------

<span></span>
#### LSASS 弱點 - CAN-2003-0533：

LSASS 具有一項[緩衝區滿溢弱點](http://go.microsoft.com/fwlink/?linkid=21142)，可能導致在受影響系統上遠端執行程式碼。成功利用此弱點的攻擊者可以取得受影響系統的完整控制權。

#### LSASS 弱點 - CAN-2003-0533 緩和因素：

-   只有 Windows 2000 和 Windows XP 可能受遠端匿名使用者攻擊。Windows Server 2003 和 Windows XP 64-Bit Edition Version 2003 有此弱點，但只有本機系統管理員可以利用。
-   Windows NT 4.0 並未受此弱點影響。
-   防火牆的最佳實務作法與標準的預設防火牆組態，都有助於保護網路免於遭受企業外部發動之攻擊的威脅。最佳的實務作法建議，是讓任何會連線至網際網路的系統僅開放最少量的連接埠。

#### LSASS 弱點 - CAN-2003-0533 替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

-   建立一個名為 %systemroot%\\debug\\dcpromo.log 的檔案，並將它設成唯讀。若要執行這個動作，請執行下列的命令：

    **echo dcpromo ＞%systemroot%\\debug\\dcpromo.log & attrib +r %systemroot%\\debug\\dcpromo.log**

    **注意：**這是能最有效緩和危機的作法，因為它會讓有弱點的程式碼永遠不被執行，完全中和這項弱點。這個替代解決方案適用於傳送至任何易受侵襲之連接埠的封包。

-   **使用**[**網際網路連線防火牆**](http://www.microsoft.com/security/protect/windowsxp/firewall.asp)**之類的個人防火牆 (Windows XP 和 Windows Server 2003 中有提供)。**

    使用 Windows XP 或 Windows Server 2003 中的網際網路防火牆來保護網際網路連線時，它會預設封鎖所有來源不明的網際網路內送傳輸。Microsoft 建議封鎖所有來源不明的網際網路內送傳輸。

    如要使用「網路安裝精靈」啟用「網際網路連線防火牆」，請依照下列步驟進行：

    1.  按一下 \[開始\]，然後按一下 \[控制台\]。
    2.  在預設類別檢視中，按一下 \[網路和網際網路連線\]，再按一下 \[設定或變更您的家用或小型辦公室網路\]。當您在「網路設定精靈」中選擇系統已直接連線網際網路的設定時，\[網際網路連線防火牆\] 功能就會啟用。

    若要手動設定用於連線的「網際網路連線防火牆」，請依照下列步驟進行：

    1.  按一下 \[開始\]，然後按一下 \[控制台\]。
    2.  在預設類別檢視中，按兩下 \[網路和網際網路連線\]，然後再按 \[網路連線\]。
    3.  在想要啟用「網際網路連線防火牆」的連線上按右鍵，再按一下 \[內容\]。
    4.  按一下 \[進階\] 索引標籤。
    5.  核選 \[以限制或防止來自網際網路對這台電腦的存取來保護我的電腦和網路\] 核取方塊，再按 \[確定\]。

    **注意：**如果您想讓部份程式及服務仍然能透過防火牆使用，請按 \[進階\] 索引標籤上的 \[設定\]，再選擇程式、通訊協定及需要的服務。

-   **在防火牆上封鎖下列連接埠：**

    -   **UDP 連接埠 135、137、138 和 445，以及 TCP 連接埠 135、139、445 和 593**
    -   **所有在 1024 以上連接埠收到的來源不明內送傳輸**
    -   **所有其他特殊設定的 RPC 連接埠**

    這些連接埠是用來對 RPC 的連線進行初始化。在防火牆上阻擋這些連接埠，將有助於避免攻擊者嘗試利用這個弱點，對防火牆之後的系統進行攻擊。同時您也應該要阻擋遠端系統上其他經過特別設定的 RPC 通訊埠。Microsoft 建議您封鎖所有來源不明的網際網路內送傳輸，如此將有助於避免可能使用其他連接埠的攻擊手段。如需 PRC 所使用連接埠的詳細資訊，請參訪下面的[網站](http://www.microsoft.com/resources/documentation/windows/2000/server/reskit/en-us/tcpip/part4/tcpappc.mspx)。

-   **如果系統能支援進階 TCP/IP 篩選功能，就啟用該項功能。**

    您可以啟用進階的 TCP/IP 篩選功能，封鎖所有不請自來的內送傳輸。如需有關設定 TCP/IP 篩選功能的其他資訊，請參閱 Microsoft 知識庫文件編號 [309798](http://support.microsoft.com/default.aspx?kbid=309798)。

-   **在受影響的系統上，使用 IPSec 阻擋受影響的連接埠。**

    使用 Internet Protocol Security (IPSec) 來保障網路的通訊安全。如需有關 IPSec 以及如何套用篩選器之詳細資訊，請參閱 Microsoft 知識庫文件 [313190](http://support.microsoft.com/default.aspx?kbid=313190) 及 [813878](http://support.microsoft.com/default.aspx?kbid=813878)。

#### LSASS 弱點 - CAN-2003-0533 常見問題集：

**這個弱點的範圍為何？**
這是[緩衝區滿溢](http://go.microsoft.com/fwlink/?linkid=21141)的弱點。一旦攻擊得逞，攻擊者將能在遠端取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**造成這個弱點的原因為何？**
LSASS 服務中的未檢查緩衝區。

**何謂 LSASS？**
本地安全性授權子系統服務 (LSASS，Local Security Authority Subsystem Service) 提供了一種介面，能用來管理本地安全性、網域授權及 Active Directory 程序。它能夠處理用戶端及伺服器的驗證，同時包含用來支援 Active Directory 公用程式的功能。

**攻擊者可能會利用這項弱點採取什麼動作？**
成功利用此弱點的攻擊者可以取得受影響系統的完整控制權。

**誰可以利用這項弱點？**
在 Windows 2000 和 Windows XP 中，任何匿名使用者只要可以將蓄意設計的訊息傳送到受影響系統中，就可以利用這個弱點。

**攻擊者將如何擅用這個弱點？**
攻擊者會建立蓄意設計的訊息並將它傳入受影響的系統，使系統執行程式碼。

攻擊者可以透過其他方式存取受到影響的元件，像是以互動方式登入系統，或是使用另一個應用程式以本機或遠端方式將參數傳送至防備不周延的元件中。

**因這項弱點所產生的風險主要會發生在那些系統上？**
Windows 2000 和 Windows XP 受到這個弱點影響的風險最高。

Windows Server 2003 和 Windows XP 64-Bit Edition Version 2003 提供額外保護，需要系統管理員登入到受影響系統的本機才能利用這項弱點。

**更新的作用何在？**
本更新程式會修改在將訊息傳遞至分配的緩衝區之前，LSASS 驗證訊息長度的方式，因此消除此項弱點。

此更新也會移除 Windows 2000 Professional 和 Windows XP 中有弱點的程式碼，因為這些作業系統已不再需要這些有弱點的介面。這樣可以避免此服務未來可能有的弱點。

#### LDAP 弱點 - CAN-2003-0663：

有一個[拒絕服務](http://go.microsoft.com/fwlink/?linkid=21142)的弱點，可導致攻擊者傳送蓄意設計的 LDAP 訊息到 Windows 2000 網域控制站。攻擊者可能導致 Active Directory 網域中負責驗證使用者身份的服務停止回應。

#### LDAP 弱點 - CAN-2003-0663 緩和因素：

-   要利用這項弱點，攻擊者需要將蓄意設計的 LDAP 訊息傳送到網域控制站。如果 LDAP 連接埠未以防火牆設定封鎖，攻擊者不需要任何其他的權限就可以利用此弱點。
-   此弱點僅影響 Windows 2000 Server 網域控制站；Windows Server 2003 網域控制站則不受影響。
-   Windows NT 4.0 和 Windows XP 並未受此弱點的影響。
-   如果攻擊者成功利用此弱點，受影響系統會顯示一個警告訊息，表示在 60 秒關機後會自動重新啟動。60 秒倒數結束時，受影響的系統會自動重新開機。重新開機之後，受影響的系統可以回復正常的運作。不過在套用更新程式之前，受影響的系統有可能會再度受到新的拒絕服務攻擊。
-   防火牆的最佳實務作法與標準的預設防火牆組態，都有助於保護網路免於遭受企業外部發動之攻擊的威脅。最佳的實務作法建議，是讓任何會連線至網際網路的系統僅開放最少量的連接埠。

#### LDAP 弱點 - CAN-2003-0663 替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

-   **鎖防火牆上的 LDAP TCP 連接埠 389、636、3268 和 3269。**

    這些連接埠是用來對包含 Windows 2000 網域控制站的 LDAP 連線進行初始化。在防火牆上阻擋這些連接埠，將有助於避免攻擊者嘗試利用這個弱點，於企業外部對防火牆之後的系統進行攻擊。其他連接埠可能被用來利用此弱點，但上列的連接埠是最常受到攻擊的方式。Microsoft 建議封鎖所有來源不明的網際網路內送傳輸，如此將有助於避免可能使用其他連接埠的攻擊手段。

    **替代性解決方案的影響：**封鎖這些連接埠的網路連線會無法使用 Active Directory 網域驗證。

#### LDAP 弱點 - CAN-2003-0663 常見問題集：

**這個弱點的範圍為何？**

這是[拒絕服務](http://go.microsoft.com/fwlink/?linkid=21142)的弱點。利用此弱點的攻擊者可造成伺服器自動重新啟動，使伺服器在這段時間內無法回應驗證要求。此弱點存在於以網域控制台角色執行的 Windows 2000 Server 系統。對其他 Windows 2000 系統的影響，是如果網域控制台停止回應時，用戶端可能無法登入到網域中。

**造成這個弱點的原因為何？**

本地安全性授權子系統服務 (LSASS) 處理到蓄意設計的 LDAP 訊息。

**何謂 LDAP？**

LDAP (Lightweight Directory Access Protocol，輕量型目錄存取協定) 是業界標準通訊協定，可允許授權使用者查詢或修改 metadirectory 中的資料。例如，在 Windows 2000 中，LDAP 是用來存取 [Active Directory](http://go.microsoft.com/fwlink/?linkid=21200) 中資料的通訊協定。

**蓄意設計的 LDAP 訊息處理方式有什麼問題？**

攻擊者可以傳送一個蓄意設計的 LDAP 訊息到 LSASS 服務，造成停止回應。

**何謂 LSASS？**

本地安全性授權子系統服務 (LSASS，Local Security Authority Subsystem Service) 提供了一種介面，能用來管理本地安全性、網域授權及 Active Directory 程序。它能夠處理用戶端及伺服器的驗證，同時包含用來支援 Active Directory 公用程式的功能。

**攻擊者可能會利用這項弱點採取什麼動作？**

利用此弱點的攻擊者可能導致 LSASS 停止回應，並使受影響系統重新啟動。受影響系統可能會顯示一個 60 秒後將自動重新開機的警告。在 60 秒倒數計時期間，將無法使用受影響系統主控台的本機驗證與受影響系統的使用者網域驗證。60 秒倒數結束時，受影響的系統會自動重新開機。如果使用者未執行受影響系統的網域驗證，可能會無法存取網域資源。重新開機之後，受影響的系統可以回復正常的運作。不過在套用更新程式之前，它有可能會再度受到新的拒絕服務攻擊。

**誰可以利用這項弱點？**

任何匿名使用者，只要可以將蓄意設計的 LDAP 訊息傳送到受影響系統上，都可以利用這個弱點。

**攻擊者如何利用這個弱點？**

攻擊者可以利用這個弱點，透過傳送特殊設計的 LDAP 訊息到單一樹系或多重樹系中的網域控制台，就可能造成整個企業網域驗證的拒絕服務。如此可能會造成 LSASS 停止回應且使受影響系統重新開機。攻擊者不需要具有網域中的有效使用者帳戶，就可以傳送這個蓄意設計的 LDAP 訊息。此攻擊可以由任何匿名存取帳戶發動。

**因這項弱點所產生的風險主要會發生在那些系統上？**

只有 Windows 2000 網域控制台具有此弱點。

**我使用 Windows 2000。我應該更新哪些系統？**

用來解決此弱點的更新程式必須安裝在 Windows 2000 網域控制站的系統上。不過，您也可以在其他角色的 Windows 2000 Servers 上安全地安裝此更新。Microsoft 建議在未來可能升級到網域控制台的系統上，安裝這個更新程式。

**更新的作用何在？**

本更新程式修改了 LSASS 處理特殊設計 LDAP 訊息的方式，因而消除此項弱點。

#### PCT 弱點 - CAN-2003-0719：

Private Communications Transport (PCT) 通訊協定是屬於 SSL (Secure Sockets Layer) 函式庫的一部份。PCT 具有一項[緩衝區滿溢](http://go.microsoft.com/fwlink/?linkid=21142)的弱點。只有啟用 SSL 的系統 (在某些狀況下會是 Windows 2000 網域控制器)，具備此項弱點。成功利用此弱點的攻擊者可以取得受影響系統的完整控制權。

#### PCT 弱點 - CAN-2003-0719 緩和因素：

-   只有啟用 SSL 的系統才會受影響，通常這些系統都是伺服器系統。在受影響的系統中，並不會預設啟用 SSL 支援。不過，網頁伺服器經常會使用 SSL 來支援電子商務程式、線上銀行或是其他需要安全通訊的程式。
-   只有系統管理員已經手動啟用 PCT (即使已啟用 SSL) 的情況下，Windows Server 2003 才會受到此弱點影響。
-   在有些情況下，ISA Server 2000 的 Web Publishing 功能或 Proxy Server 2.0 可以成功封鎖試圖利用此弱點的攻擊。測試顯示，ISA Server 2000 的 Web Publishing 功能加選 Packet Filtering 和所有 Packet Filtering 選項後，可以成功封鎖此類攻擊且沒有明顯的副作用。Proxy Server 2.0 也能夠成功封鎖這種攻擊。不過在未將安全性更新套用到 Proxy Server 2.0 系統以前，此類攻擊會導致 Proxy Server 2.0 Web 服務停止回應或必須重新啟動系統。
-   防火牆的最佳實務作法與標準的預設防火牆組態，都有助於保護網路免於遭受企業外部發動之攻擊的威脅。最佳的實務作法建議，是讓任何會連線至網際網路的系統僅開放最少量的連接埠。

#### PCT 弱點 - CAN-2003-0719 替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

-   **透過登錄停用 PCT 支援**

    這個替代解決方案已經詳細記錄在 Microsoft 知識庫文件 [187498](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;187498) 中。文件摘要如下。

    下列步驟說明如何停用 PCT 1.0 通訊協定，避免受影響系統試圖使用。

    **注意：**不當使用「登錄編輯器」可能會造成嚴重的問題，甚至可能需要重新安裝您的作業系統。因不當使用「登錄編輯器」所造成的問題，Microsoft 無法保證能夠順利解決。如要使用「登錄編輯器」，請自行負擔相關的風險。

    有關編輯登錄的方法，請檢視「登錄編輯器」(Regedit.exe) 中的＜變更號碼及數值＞說明主題，或 Regedt32.exe 中＜新增及刪除 \[登錄\] 中的資訊＞與＜編輯登錄資料＞說明主題。

    **注意：**您最好先備份登錄後再編輯。

    1.  按一下 \[開始\]，按一下 \[執行\]，鍵入 regedt32，再按 \[確定〕。
    2.  在「登錄編輯器」中，尋找下列登錄機碼：

        `HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\PCT 1.0\Server`

    3.  在 \[編輯\] 功能表中，按一下 \[新增值\] 以便在 **Server** 子機碼中建立一個名為 Enabled 的新 REG\_BINARY 值。
    4.  在 \[資料類型\] 清單中，按一下 \[REG\_BINARY\]。
    5.  在 \[值的名稱\] 文字方塊中，鍵入 Enabled 後按一下 \[確定\]。

        **注意：**如果已顯示此值，按兩下該值以編輯目前的值並前往步驟 6。

    6.  在「二進位編輯器」中，將新機碼值設為 0，方法是輸入下列字串：
        **00000000**。
    7.  按一下 \[確定\] 然後重新啟動系統。

        **注意：**要啟用 PCT，請將 Enabled 登錄機碼的值改為 **00000001**，然後重新啟動系統。

        **Note** If you are using Windows XP RTM you must also create a second registry key to fully disable PCT. This is not required on later versions of Windows XP or other affected operating systems. Use the instructions provided earlier and create a second REG\_DWORD value named “**Client**”. Use the same values as documented earlier.

#### PCT 弱點 - CAN-2003-0719 常見問題集：

**這個弱點的範圍為何？**

Private Communications Transport (PCT) 通訊協定是屬於 SSL (Secure Sockets Layer) 函式庫的一部份。PCT 具有一項[緩衝區滿溢](http://go.microsoft.com/fwlink/?linkid=21142)緩衝區滿溢的弱點。只有啟用 SSL 的系統 (在某些狀況下會是 Windows 2000 網域控制器)，具備此項弱點。

所有使用 SSL 的程式均可能會受到影響。雖然 SSL 通常與「網際網路資訊服務」(Internet Information Services) 有關 (因為使用 HTTPS 和連接埠 443)，不過任何在受影響的平台上執行 SSL 的服務都可能會受到此弱點的影響。這些應用程式包括 (但是不限於此處所列)：Microsoft Internet Information Services 4.0、Microsoft Internet Information Services 5.0、Microsoft Internet Information Services 5.1、Microsoft Exchange Server 5.5、Microsoft Exchange Server 2000、Microsoft Exchange Server 2003、Microsoft Analysis Services 2000 (隨 SQL Server 2000 提供) 以及使用 PCT 的協力廠商應用程式。SQL Server 2000 不受此弱點的影響，因為它會刻意阻擋 PCT 連接。

唯一會讓 Windows Server 2003 和 Internet Information Services 6.0 受到此弱點影響的狀況，是發生系統管理員手動啟用 PCT 的情形 (即使已啟用 SSL)。

一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**造成這個弱點的原因為何？**

SSL 函式庫用來檢查訊息輸入的處理程序。

**SSL 函式庫是什麼？**

Microsoft Secure Sockets Layer (SSL) 函式庫包含一些安全通訊協定的支援。這些包括 Transport Layer Security 1.0 (TLS 1.0)、Secure Sockets Layer 3.0 (SSL 3.0) 以及較舊且很少使用的 Secure Sockets Layer 2.0 (SSL 2.0) 和 Private Communication Technology 1.0 (PCT 1.0) 通訊協定。

這些通訊協定能讓伺服器與用戶端系統之間維持加密的連線。進行跨公用網路 (如網際網路) 傳送時，SSL 有助於保護資訊。SSL 支援需要一份安裝在伺服器上的 SSL 憑證。如需有關 SSL 的進一步資訊，請參閱 Microsoft 知識庫文件編號 [245152](http://support.microsoft.com/default.aspx?scid=kb;en-us;q245152)。

**何謂 PCT？**

Private Communication Technology (PCT) 是由 Microsoft 和 Visa International 所研發、加密保護網際網路通訊的通訊協定。它是 SSL 2.0 的替代品，事實上與 SSL 也有多處相似之處。它們訊息格式相近，使得使用支援 SSL 的用戶端伺服器也可以使用支援 PCT 的用戶端。

PCT 是早期的網路協定，已經由 SSL 3.0 取代而且已很少有人使用。Microsoft Secure Sockets Layer (SSL) 函式庫僅為回溯相容性支援 PCT。現今多數程式與伺服器都使用 SSL 3.0，不再需要 PCT。如需更詳細的資訊，請參訪 [MSDN Library](http://go.microsoft.com/fwlink/?linkid=21199)網站。

**攻擊者可能會利用這項弱點採取什麼動作？**

一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**誰可以利用這項弱點？**

任何匿名使用者，只要可以將蓄意設計的 TCP 訊息傳送到受影響系統上啟用的 SSL 服務，都可以利用這項弱點。

**攻擊者如何利用這個弱點？**

攻擊者可以透過啟用的 SSL 服務與受影響系統通訊，傳送一個蓄意設計的 TCP 訊息。只要接收這類訊息，就可能會造成防備不周全的系統上的服務受影響，而得以執行程式碼。

攻擊者可以透過其他方式存取受到影響的元件，像是以互動方式登入系統，或是使用另一個應用程式以本機或遠端方式將參數傳送至防備不周延的元件中。

**因這項弱點所產生的風險主要會發生在那些系統上？**

所有使用 SSL 的程式均可能會受到影響。雖然 SSL 通常與「網際網路資訊服務」(Internet Information Services) 有關 (因為使用 HTTPS 和連接埠 443)，不過任何在受影響的平台上執行 SSL 的服務都可能會受到此弱點的影響。這些應用程式包括 (但是不限於此處所列)：Internet Information Services 4.0、Internet Information Services 5.0、Internet Information Services 5.1、Exchange Server 5.5、Exchange Server 2000、Exchange Server 2003、Analysis Services 2000 (隨 SQL Server 2000 提供) 以及使用 PCT 的協力廠商應用程式。SQL Server 2000 不受此弱點的影響，因為它會刻意阻擋 PCT 連接。

唯一會讓 Windows Server 2003 和 Internet Information Services 6.0 受到此弱點影響的狀況，是發生系統管理員手動啟用 PCT 的情形 (即使已啟用 SSL)。

安裝「企業根憑證授權單位」的 Active Directory 網域也可能受此弱點影響，因為 Windows 2000 網域控制台會自動聆聽 SSL 連線。

**Windows Server 2003 如何受影響？**

Windows Server 2003 的 PCT 實作包含與其他平台相同的緩衝區滿溢問題；不過預設為停用 PCT。如果 PCT 通訊協定是利用登錄機碼啟用，Windows Server 2003 可能會因此出現這個弱點。因此，Microsoft 為 Windows Server 2003 發行了一個安全性更新來解決這個緩衝區滿溢弱點，同時繼續停用 PCT。

**更新的作用何在？**

本更新程式會變更 PCT 實作驗證傳入資訊的方式，並且停用 PCT 通訊協定，因而消除此項弱點。

**此更新程式會造成任何的行為變更嗎？**

會。此更新程式除了會解決 PCT 的弱點外，也會停用 PCT，因為已經不再使用這個通訊協定，而被 SSL 3.0 取代。此動作與 Windows Server 2003 的預設設定一致。 如果系統管理員需要使用 PCT，可以用＜替代解決方案＞一節中所描述的登錄機碼來啟用。

#### Winlogon 弱點 - CAN-2003-0806：

Windows 登入程序 (Winlogon) 中有一個[緩衝區滿溢弱點](http://go.microsoft.com/fwlink/?linkid=21142)。登入程序中未檢查某個值所使用的大小，就將值插入分配的緩衝區。所造成的滿溢可以讓攻擊者在遠端於受影響的系統上執行程式碼。不是網域成員的系統不會受此弱點影響。成功利用此弱點的攻擊者可以取得受影響系統的完整控制權。

#### Winlogon 弱點 - CAN-2003-0806 緩和因素：

-   只有身為網域一份子的 Windows NT 4.0、Windows 2000 及 Windows XP 系統，才會受到此弱點的影響。Windows Server 2003 並未受此弱點影響。
-   攻擊者如想利用此項弱點，必須要具備能夠在網域中修改使用者物件的權限。一般而言，只有管理員或帳戶操作員群組的成員具有這種權限不過也可能會有將此種權限委派給網域中其他使用者帳戶的情形。
-   網域通常支援對使用者物件的變更進行稽核。這些稽核記錄可以檢視，以決定哪個使用者帳戶可能曾惡意修改其他使用者帳戶以利用此弱點。

#### Winlogon 弱點 - CAN-2003-0806 替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

-   **減少有帳戶修改權限的使用者數量。**

    若要利用這個弱點，攻擊者必須能夠在網域中修改使用者物件。有些組織會將不必要的使用者帳戶加入系統管理員或帳戶操作員群組中。例如，如果客服人員只需要能夠重設使用者密碼，系統管理員應該直接授予該權限而非將此人員加入帳戶操作員群組中。

    減少系統管理群組中的使用者帳戶數量，可協助封鎖已知的攻擊方式。應只將信任的員工作為系統管理群組的成員。如需網域最佳實例的詳細資訊，請參閱此 [網站](http://go.microsoft.com/fwlink/?linkid=21566)。

#### Winlogon 弱點 - CAN-2003-0806 常見問題集：

**這個弱點的範圍為何？**

這是[缓沖區溢出](http://go.microsoft.com/fwlink/?linkid=21141)緩衝區滿溢的弱點。一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**造成這個弱點的原因為何？**

Winlogon 從網域讀取值後，不會在將此值插入配置緩衝區前檢查此值大小。

**何謂 winlogon？**

Windows 登入處理 (Winlogon) 是 Windows 作業系統的元件，能提供互動式的登入支援。Winlogon.exe 是 Windows 中用來管理安全性相關使用者互動的處理。它會處理登入與登出要求、鎖定或解除鎖定系統、變更密碼及其他請求。它會在登入處理時從網域讀取資料，並使用該資料來設定使用者的環境。如需有關 Winlogon 的進一步資訊，請參閱 [MSDN Library](http://go.microsoft.com/fwlink/?linkid=21516) 網站。

**何謂網域？**

網域可用來虛擬儲存有關任何網路物件的資訊，例如印表機、檔案共用位置及個人資訊。如需使用 Windows 2000 Server 或 Windows Server 2003 來建立網域的詳細資訊，請參閱此[網站](http://go.microsoft.com/fwlink/?linkid=21200)。

**這個弱點可能讓攻擊者採取什麼動作？**

一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**誰可以利用這項弱點？**

攻擊者如想利用此項弱點，必須要具備能夠在網域中修改使用者物件的權限。一般而言，只有管理員或帳戶操作員群組的成員具有這種權限不過也可能會有將此種權限委派給網域中其他使用者帳戶的情形。不具有此權限的使用者帳戶或匿名使用者無法利用這個弱點。

**攻擊者如何利用這個弱點？**

攻擊者可以特定修改網域中儲存的值以加入惡意資料。在登入處理時將此值傳送至 Winlogon 中未檢查的緩衝區，Winlogon 便會允許惡意程式碼執行。

**因這項弱點所產生的風險主要會發生在那些系統上？**

只有身為網域一份子的 Windows NT 4.0、Windows 2000 及 Windows XP 系統，才會受到此弱點的影響。

**更新的作用何在？**

本更新程式修改了 Winlogon 處理對值長度進行驗證的方式，再將值傳送至配置緩衝區，進而消除這項弱點。

#### 中繼檔弱點 - CAN-2003-0906：

轉譯 Windows 中繼檔 (WMF) 與增強型中繼檔 (EMF) 影像格式時有[緩衝區滿溢弱點](http://go.microsoft.com/fwlink/?linkid=21142)弱點，可能會在受影響的系統上允許遠端程式碼執行。在受影響之系統上轉譯 WMF 或 EMF 影像的任何程式，皆可能遭受此攻擊。成功利用此弱點的攻擊者可以取得受影響系統的完整控制權。

#### 中繼檔弱點 - CAN-2003-0906 緩和因素：

-   攻擊者只有在引誘使用者開啟蓄意製作檔案或檢視包含蓄意製作影像的目錄後，才能利用這項弱點。攻擊者無法強制使用者開啟惡意文件。
-   在網頁式攻擊的案例中，攻擊者必須架設一個網站，並在其中包含利用此弱點的網頁。攻擊者並不能強制使用者造訪惡意的網站，而是引誘他們自行前往。一般的做法是設法讓他們按一下通往攻擊者網站的連結。
-   成功利用這項弱點的攻擊者可以取得與使用者相同的權限。系統上帳戶權限較少的使用者，其風險比擁有管理權限的使用者要小。
-   Windows Server 2003 並未受此弱點影響。

#### 中繼檔弱點 - CAN-2003-0906 替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

-   **如果您使用的是 Outlook 2002 或是 Outlook Express 6.0 SP1 或以上的版本，請用純文字格式來閱讀電子郵件，這樣就可以保護自己的電腦不受 HTML 電子郵件攻擊模式的侵害。**

    已套用 Office XP Service Pack 1 或以上版本的 Microsoft Outlook 2002 使用者，以及已套用 Internet Explorer 6 Service Pack 1 或以上版本的 Outlook Express 6 使用者，可以啟用這項功能，只用純文字格式來檢視所有未經數位簽章的電子郵件或是未經加密的電子郵件。

    數位簽章的電子郵件或加密的電子郵件不會受到這個設定的影響，仍然可以用原來的格式閱讀。如需有關在 Outlook 2002 中啟用此設定的進一步資訊，請參閱 Microsoft 知識庫文件編號 [307594](http://support.microsoft.com/default.aspx?scid=kb;en-us;307594)。

    如需 Outlook Express 6 中這項設定的相關說明，請參閱知識庫文件編號 [291387](http://support.microsoft.com/?kbid=291387)。

    **使用替代的解決方案所受的影響：**用纯文本格式查看的电子邮件中不会包含图片、特殊字体、动画或其他富格式内容。另外：

    -   這些變更會套用至預覽窗格及開啟的訊息。
    -   圖片會變成附件的形式，因此不會流失。
    -   由於訊息在儲存區內仍然是 Rich Text 或 HTML 格式，物件模型 (自定程式碼解決方案) 可能產生一些難以預期的狀況。

#### 中繼檔弱點 - CAN-2003-0906 常見問題集：

**這個弱點的範圍為何？**

這是[緩衝區滿溢](http://go.microsoft.com/fwlink/?linkid=21141)的弱點。一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**造成這個弱點的原因為何？**

轉譯 Windows 中繼檔 (WMF) 與增強型中繼檔 (EMF) 影像格式時未檢查緩衝區。

**何謂 Windows 中繼檔 (WMF) 與增強型中繼檔 (EMF) 影像格式？**

WMF 影像是16 位元的中繼檔格式，其中可同時包含向量圖資訊與點陣圖資訊。此格式已針對 Windows 作業系統最佳化。

EMF 影像是 32 位元格式，其中可同時包含向量圖資訊與點陣圖資訊。此格式是依 Windows 中繼檔格式改良並包含擴充功能。

如需關於影像類型與格式的詳細資訊，請參閱 Microsoft 知識庫文件編號 [320314](http://support.microsoft.com/default.aspx?scid=kb;en-us;320314)。有關這些檔案格式的其他資訊也可在以下連結取得 [MSDN Library](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/gdicpp/gdiplus/aboutgdiplus/imagesbitmapsandmetafiles/metafiles.asp) 網站。

**攻擊者可能會利用這項弱點採取什麼動作？**

一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**攻擊者如何利用這個弱點？**

任何轉譯受影響的影像類型的程式都可能會遭受此攻擊﹔以下列出部分範例：

-   攻擊者可以針對這個經由 Internet Explorer 6 引起的弱點來設計以架設惡意網站，然後引誘使用者檢視該網站。
-   攻擊者也可以撰寫一封 HTML 電子郵件，其中附加蓄意製作的影像 (針對這個經由 Outlook 2002 或 Outlook Express 6 引起的弱點設計的蓄意製作影像)，然後引誘使用者檢視該封 HTML 電子郵件。
-   攻擊者可以將蓄意製作的影像嵌入 Office 文件中，然後引誘使用者檢視該文件。
-   攻擊者可以將蓄意製作的影像放置在本機檔案系統或網路共用區中，然後引誘使用者以 Windows XP 的「Windows 檔案總管」預覽該目錄。

**因這項弱點所產生的風險主要會發生在那些系統上？**

攻擊者只有在引誘使用者開啟蓄意製作的檔案或檢視包含蓄意製作影像的目錄後，才能利用這項弱點。攻擊者無法強制使用者開啟惡意文件。

在網頁式攻擊的案例中，攻擊者必須架設一個網站，並在其中包含利用此弱點的網頁。攻擊者並不能強制使用者造訪惡意的網站，而是引誘他們自行前往。一般的做法是設法讓他們按一下通往攻擊者網站的連結。

**更新的作用何在？**

本更新程式修改了 Windows 對受影響之影像類型進行驗證的方式，因而消除這項弱點。

#### 說明及支援中心弱點 - CAN-2003-0907：

由於「說明及支援中心」處理 HCP URL 驗證的方式，使得其中含有遠端程式碼執行的弱點。攻擊者可以架構惡意的 HCP URL 來利用這個弱點，當使用者瀏覽惡意網站或檢視惡意電子郵件訊息時，便可能允許遠端程式碼執行。成功利用此弱點的攻擊者可以取得受影響系統的完整控制權。

#### 說明及支援中心弱點 - CAN-2003-0907 緩和因素：

-   在網頁式攻擊的案例中，攻擊者必須架設一個網站，並在其中包含利用此弱點的網頁。攻擊者並不能強制使用者造訪惡意的網站，而是引誘他們自行前往。一般的做法是設法讓他們按一下通往攻擊者網站的連結。
-   而依照預設，Outlook Express 6、Outlook 2002 和 Outlook 2003 都會在「受限制的網站區域」開啟 HTML 電子郵件。此外，如果已經安裝 [Outlook 電子郵件安全性更新程式](http://www.microsoft.com/office/outlook/evaluation/security.asp)，Outlook 98 和 Outlook 2000 也會在「受限制的網站區域」開啟 HTML 電子郵件。「受限制的網站區域」有助於減少企圖利用這個弱點的攻擊。

    如果您能符合下列所有條件，就可以大幅降低遭到 HTML 電子郵件攻擊的風險：

    -   套用 Microsoft 安全性公告 [MS03-040](http://www.microsoft.com/taiwan/security/bulletins/ms03-040.asp) 中包含的更新程式。
    -   使用 Internet Explorer 6 或以上的版本。
    -   使用 Microsoft Outlook 電子郵件安全性更新或 Microsoft Outlook Express 6 (含) 以上的版本，或是 Microsoft Outlook 2000 Service Pack 2 或以上的版本，而且使用預設的設定。

-   成功利用這項弱點的攻擊者可以取得與使用者相同的權限。系統上帳戶權限較少的使用者，其風險比擁有管理權限的使用者要小。
-   Windows NT 4.0 和 Windows 2000 並未受此弱點的影響。

#### 說明及支援中心弱點 - CAN-2003-0907 替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

-   **取消登錄 HCP 協定。**

    為了協助預防攻擊，您可以從登錄刪除下列機碼來取消登錄 HCP 協定：HKEY\_CLASSES\_ROOT\\HCP。請依照以下的步驟進行：

    1.  按一下 \[開始\]，然後按一下 \[執行\]。
    2.  輸入 **regedit** 後按一下 \[確定\]。

        畫面上會開啟登錄編輯器程式。

    3.  展開 **HKEY\_CLASSES\_ROOT**，再選取 **HCP** 機碼。
    4.  在 HCP 機碼上按一下滑鼠右鍵，再選擇 \[刪除\]。

    **注意：**不當使用「登錄編輯器」可能會造成嚴重的問題，甚至可能需要重新安裝 Windows。因不當使用「登錄編輯器」所造成的問題，Microsoft 無法保證能夠順利解決。如要使用「登錄編輯器」，請自行負擔相關的風險。

    **使用替代的解決方案所受的影響：**取消登錄 HCP 協定，會導致本機上所有使用 hcp:// 的合法說明連結中斷。例如，連至「控制台」的連結將無法再使用。

-   **如果您使用的是 Outlook 2000 SP1 或更早的版本，請安裝** [**Outlook 電子郵件安全性更新程式**](http://www.microsoft.com/office/outlook/evaluation/security.asp)**。**

    依照預設，Outlook Express 6、Outlook 2002 和 Outlook 2003 會在「受限制的網站區域」開啟 HTML 電子郵件。此外，如果已經安裝 [Outlook 電子郵件安全性更新程式](http://www.microsoft.com/office/outlook/evaluation/security.asp)，Outlook 98 和 Outlook 2000 也會在「受限制的網站區域」開啟 HTML 電子郵件。

    使用這些產品的客戶，除非使用者按一下電子郵件中的惡意連結，否則就可降低受到企圖利用這些弱點的電子郵件訊息攻擊的風險。

-   **如果您使用的是 Outlook 2002 或是 Outlook Express 6.0 SP1 或以上的版本，請用純文字格式來閱讀電子郵件，這樣就可以保護自己的電腦不受 HTML 電子郵件攻擊模式的侵害。**

    已套用 Office XP Service Pack 1 或以上版本的 Microsoft Outlook 2002 使用者，以及已套用 Internet Explorer 6 Service Pack 1 或以上版本的 Outlook Express 6 使用者，可以啟用這項功能，只用純文字格式來檢視所有未經數位簽章的電子郵件或是未經加密的電子郵件。

    數位簽章的電子郵件或加密的電子郵件不會受到這個設定的影響，仍然可以用原來的格式閱讀。如需有關在 Outlook 2002 中啟用此設定的進一步資訊，請參閱 Microsoft 知識庫文件編號 [307594](http://support.microsoft.com/default.aspx?scid=kb;en-us;307594)。

    如需 Outlook Express 6 中這項設定的相關說明，請參閱知識庫文件編號 [291387](http://support.microsoft.com/?kbid=291387)。

    **使用替代的解決方案所受的影響：**以純文字格式檢視的電子郵件訊息不能包含圖片、特殊字型、動畫效果或其他多媒體式的範圍。此外：

    -   這些變更會套用至預覽窗格及開啟的訊息。
    -   圖片會變成附件的形式，因此不會流失。
    -   由於訊息在儲存區內仍然是 Rich Text 或 HTML 格式，物件模型 (自定程式碼解決方案) 可能產生一些難以預期的狀況。

#### 說明及支援中心弱點 - CAN-2003-0907 常見問題集：

**這個弱點的範圍為何？**

「說明及支援中心」具有一項遠端程式碼執行的弱點（說明及支援中心功能是受影響系統中包含的一項功能）。這個弱點，是「說明及支援中心」處理 HCP URL 驗證時採用的方式所造成的。

這是[遠端程式碼執行](http://technet.microsoft.com/security/bulletin/glossary)的弱點。成功利用此弱點的攻擊者可以取得受影響系統的完整控制權。攻擊者將能在系統上進行任何動作，包括安裝程式、檢視資料、變更資料、刪除資料或建立擁有完整權限的新帳戶。

**造成這個弱點的原因為何？**

由於「說明及支援中心」驗證資料輸入值時使用的處理所引起。

**什麼是說明及支援中心？**

「說明及支援中心」(HSC) 是 Windows 中的功能，可以提供各類主題的說明。例如，HSC 可以讓使用者了解 Windows 功能、下載並安裝軟體更新、判斷特定硬體是否與 Windows 相容，以及取得 Microsoft 協助等等。使用者和程式只要在 URL 連結中使用「hcp://」代替「http://」做為前置詞，即可用 URL 連結至「說明及支援中心」。

**HCP 協定是什麼？**

HCP 協定可以執行 URL 連結以開啟「說明及支援中心」的功能，與能夠執行 URL 連結以開啟瀏覽器的 HTTP 協定十分類似。

**說明及支援中心有什麼問題？**

發生輸入值驗證的錯誤。

**攻擊者可能會利用這項弱點採取什麼動作？**

一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**攻擊者如何利用這個弱點？**

攻擊者會架設惡意網站來利用這個弱點，然後引誘使用者檢視該網站。攻擊者也可以撰寫一封 HTML 電子郵件，其中包含蓄意製作的連結，然後引誘使用者檢視該封 HTML 電子郵件，並按一下郵件中的惡意連結。如果使用者按一下此連結，便會透過 Internet Explorer 開啟攻擊者指定的 HCP URL，而可能允許任何程式碼執行。

**因這項弱點所產生的風險主要會發生在那些系統上？**

Windows XP 與 Windows Server 2003 中的「說明及支援中心」版本會受影響。Windows NT 4.0 與 Windows 2000 不受影響，因為他們未包含「說明及支援中心」。

**我目前是在Windows Server 2003 上執行 Internet Explorer。Windows Server 2003 是否能緩和這項弱點？**

不行。依照預設，Windows Server 2003 上的 Internet Explorer 是在受限制的模式中執行，此模式一般稱為「增強式安全性設定」(Enhanced Security Configuration)。不過，依預設會允許 HCP 通訊協定存取「說明及支援中心」因此，Windows Server 2003 可能會遭受攻擊。

如需更多有關增強式安全性設定的資訊，請參閱此[網站](http://www.microsoft.com/downloads/details.aspx?familyid=d41b036c-e2e1-4960-99bb-9757f7e9e31b&displaylang=en)。

**更新的作用何在？**

本更新程式修改了傳送到「說明及支援中心」的資料驗證，進而消除這項弱點。

#### 公用程式管理員弱點 - CAN-2003-0908：

「公用程式管理員」啟動應用程式的方式中，含有[權限提升](http://go.microsoft.com/fwlink/?linkid=21142)的弱點。已登入的使用者可以透過系統權限強制「公用程式管理員」啟動應用程式，並取得系統的完整控制權。

#### 公用程式管理員弱點 - CAN-2003-0908 緩和因素：

-   攻擊者必須擁有有效的登入憑證才能利用這項弱點。匿名使用者無法利用這項弱點。
-   Windows NT 4.0、Windows XP 及 Windows Server 2003 並不受這項弱點影響。Windows NT 4.0 並未導入「公用程式管理員」。
-   《[Windows 2000 強化指南](http://www.microsoft.com/downloads/details.aspx?familyid=15e83186-a2c8-4c8f-a9d0-a0201f639a56&displaylang=en)》(英文) 中建議停用「公用程式管理員」服務。遵守這些指導方針的環境，可以降低這項弱點所產生的風險。

#### 公用程式管理員弱點 - CAN-2003-0908 替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

-   **使用「群組原則」，在所有不需要「公用程式管理員」的受影響系統上，停用此項功能。**

    因為「公用程式管理員」會是可能的攻擊對象，請用「群組原則」停用這項功能。「公用程式管理員」處理名稱為 Utilman.exe。下列指南提供的資訊，能說明如何利用[群組原則](http://www.microsoft.com/windows2000/techinfo/howitworks/management/grouppolwp.asp)，要求使用者僅能執行經過核准的應用程式。

    **注意：**您也可以參閱《[Windows 2000 強化指南](http://www.microsoft.com/downloads/details.aspx?familyid=15e83186-a2c8-4c8f-a9d0-a0201f639a56&displaylang=en)》(英文)。其中包含了如何停用「公用程式管理員」的資訊。

    **使用替代的解決方案所受的影響：**

    「公用程式管理員」提供許多作業系統的協助工具功能。在移除了限制後，您才可以使用這些功能。若要尋找如何手動啟動許多協助工具功能的指示，請參閱此[網站](http://www.microsoft.com/enable/training/windows2000/default.aspx)。

#### 公用程式管理員弱點 - CAN-2003-0908 常見問題集：

**這個弱點的範圍為何？**

這是[權限提升](http://go.microsoft.com/fwlink/?linkid=21142)的弱點。一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**造成這個弱點的原因為何？**

由於「公用程式管理員」啟動應用程式的處理所引起。「公用程式管理員」得以使用系統權限來啟動應用程式。

**何謂公用程式管理員？**

「公用程式管理員」是[協助工具公用程式](http://www.microsoft.com/enable/at/default.aspx)，讓使用者可以檢查協助工具程式 (例如：Microsoft 放大鏡，朗讀程式，螢幕小鍵盤) 的狀態，並能啟動或停止這些程式。

**攻擊者可能會利用這項弱點採取什麼動作？**

一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**誰可以利用這項弱點？**

要利用這項弱點，攻擊者必須登入系統、啟動「公用程式管理員」，然後執行可傳送蓄意製作訊息的程式，將其傳送到「公用程式管理員」來利用這個弱點。

**攻擊者如何利用這個弱點？**

若要利用這項弱點，攻擊者必須先在 Windows 2000 啟動「公用程式管理員」，然後執行特別設計的應用程式便能利用這項弱點。在 Windows 2000 的預設組態中，「公用程式管理員」已安裝但未執行。這項弱點可讓攻擊者在 Windows 2000 系統上取得完整控制權。

**因這項弱點所產生的風險主要會發生在那些系統上？**

只有 Windows 2000 會受這項弱點影響。Windows 2000 的工作站與終端伺服器的風險最高。只有在沒有足夠管理憑證的使用者被授予登入伺服器並執行程式的能力時，伺服器才會有此風險。然而，最佳實務強烈建議您制止這個行為。

**我使用 Windows 2000，但不使用公用程式管理員或其他協助工具功能，還是會受此弱點影響嗎？**

會。依預設值，系統會安裝且啟用「公用程式管理員」。不過並不會預設執行「公用程式管理員」。

**能夠在網際網路上利用這項弱點嗎？**

不行。攻擊者必須要能登入意圖攻擊的特定系統。攻擊者無法利用此弱點在遠端載入及執行程式。

**更新的作用何在？**

本更新程式修改了「公用程式管理員」啟動應用程式的方式，進而消除這項弱點。

#### Windows 管理弱點 - CAN-2003-0909

Windows XP 允許建立工作的方式，其中含有[權限提升](http://go.microsoft.com/fwlink/?linkid=21142)弱點。在特殊條件之下，不具權限的使用者可以建立工作並使用系統權限來執行，進而取得系統的完整控制權。

#### Windows 管理弱點 - CAN-2003-0909 緩和因素：

-   攻擊者必須擁有有效的登入憑證才能利用這項弱點。匿名使用者無法利用這項弱點。
-   Windows NT 4.0、Windows 2000 及 Windows Server 2003 並不受這項弱點影響。

#### Windows 管理弱點 - CAN-2003-0909 替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

**刪除受影響的 Windows 管理介面 (WMI) 提供者。**

具有本機系統管理權限的系統管理員可以在副檔名為 vbs 的文字檔中插入下列指令碼，然後執行檔案，便可刪除受影響的 WMI 提供者。

**刪除受影響的 WMI 提供者：**

`set osvc = getobject("winmgmts:root\cimv2")set otrigger = osvc.get("__win32provider='cmdtriggerconsumer'")otrigger.delete_`

安裝更新程式時，會自動重新登錄上述 WMI 提供者。套用更新程式之後，並不需要進行額外的步驟來還原系統的一般功能。

**使用替代的解決方案所受的影響：**建立作為事件式觸發程序的工作，在提供者未登錄之前將無法使用。如需關於事件式觸發程序的詳細資訊，請參閱此[網站](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/taskschd/taskschd/triggers.asp)。

**注意：**在少數情況下，Windows XP 會重新登錄此 WMI 提供者。例如，如果Windows XP 偵測到 WMI 儲存庫已損毀，便會嘗試重新登錄受影響的 WMI 提供者。

#### Windows 管理弱點 - CAN-2003-0909 常見問題集：

**這個弱點的範圍為何？**

這是[權限提升](http://go.microsoft.com/fwlink/?linkid=21142)的弱點。一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**造成這個弱點的原因為何？**

在特殊條件之下，Microsoft Windows XP 中不具權限的使用者可以建立工作，並使用系統權限來執行。

**攻擊者可能會利用這項弱點採取什麼動作？**

一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**攻擊者如何利用這個弱點？**

若要利用這項弱點，攻擊者必須能夠登入系統並建立工作。因為攻擊者必須具有有效的登入憑證才能利用這項弱點，所以遠端系統不會遭受此風險。

**因這項弱點所產生的風險主要會發生在那些系統上？**

只有 Windows XP 會受這項弱點影響。

**更新的作用何在？**

本更新程式可以防止使用者建立高於本身權限層級的工作，進而消除這項弱點。

**本更新程式是否包含任何其他的行為變更？**

是的。本更新程式還包含許多功能的變更，詳述如下：

-   在本更新程式之前，使用者有時候可以使用 Eventtriggers.exe 命令列來建立事件式觸發程序，而不需要提供使用者名稱與密碼。安裝本更新程式後，使用者必須提供有效的使用者名稱與密碼，才能使用 eventttrigers.exe 來建立事件式觸發程序。如需有關 eventtriggers.exe 命令列選項的詳細資訊，請參閱此[網站](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/eventtriggers.mspx)。
-   系統管理員原本可以在停止或停用工作排程器服務的情況下建立事件式觸發程序，現在則必須執行工作排程器服務。如需關於工作排程器的詳細資訊，請參閱此[網站](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/taskschd/taskschd/about_the_task_scheduler.asp)。
-   本更新程式也同時訂定 1,000 個觸發程序的新限制。安裝本更新程式後，超出此限制的現有事件式觸發程序仍可繼續使用﹔不過，您便無法再建立其他的事件式觸發程序。
-   在安裝本更新程式後所建立的事件式觸發程序，權限便已強化。

#### 本機描述元表弱點 - CAN-2003-0910

用來在本機描述元表 (LDT，Local Descriptor Table) 中建立項目的程式開發介面，含有[權限提升](http://go.microsoft.com/fwlink/?linkid=21142)弱點。這些項目包含了有關記憶體區段的資訊。在本機登入的攻擊者可以建立惡意的項目，藉機存取受保護的記憶體，並取得系統的完整控制權。

#### 本機描述元表弱點 - CAN-2003-0910 緩和因素：

-   攻擊者必須擁有有效的登入憑證登入本機，才能利用這項弱點。其無法以遠端方式利用這項弱點。
-   本機描述元表弱點 - CAN-2003-0910 替代解決方案：

#### 本機描述元表弱點 - CAN-2003-0910 替代解決方案：

無。

#### 本機描述元表弱點 - CAN-2003-0910 常見問題集：

**這個弱點的範圍為何？**

這是[權限提升](http://go.microsoft.com/fwlink/?linkid=21142)的弱點。一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**造成這個弱點的原因為何？**

用來在 LDT 中建立項目的程式開發介面。這些項目包含了有關記憶體區段的資訊。攻擊者可以建立惡意的項目，而得以存取受保護的核心記憶體。

**何謂本機描述元表？**

本機描述元表 (LDT) 包含了名為描述元的項目，這些項目中包含用來定義特定記憶體區段的資訊。

**可以在 LDT 中建立描述元項目的方式有什麼問題？**

程式開發介面不應該允許程式在 LDT 中建立指向受保護記憶體的描述元項目。

**攻擊者可能會利用這項弱點採取什麼動作？**

成功利用此弱點的攻擊者可以取得受影響系統的完整控制權。攻擊者將能在系統上進行任何動作，包括安裝程式、檢視資料、變更資料、刪除資料或建立擁有完整權限的新帳戶。

**誰可以利用這項弱點？**

攻擊者必須能夠在本機登入系統並執行程式，才能利用這項弱點。

**攻擊者如何利用這個弱點？**

攻擊者如果想利用此弱點發動攻擊，就必須先登入系統。攻擊者可以執行特別設計的程式來利用這項弱點，而可能取得受影響系統的完整控制權。

**因這項弱點所產生的風險主要會發生在那些系統上？**

工作站和終端伺服器的風險最高。只有在沒有足夠管理憑證的使用者被授予登入並執行程式的能力時，伺服器才會有此風險。然而，最佳實務強烈建議您制止這個行為。

**能夠在網際網路上利用這項弱點嗎？**

不會。攻擊者必須要能登入意圖攻擊的特定系統。攻擊者無法利用此弱點在遠端載入及執行程式。

**更新的作用何在？**

本更新程式修改了描述元在 LDT 中建立的方法，因而消除此項弱點。

#### H.323 弱點 - CAN-2004-0117

Microsoft [H.323 通訊協定](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/netmeet/nm3_9mqs.asp)實作處理格式錯誤之要求時具有一項遠端執行程式碼弱點。成功利用此弱點的攻擊者可以取得受影響系統的完整控制權。

#### H.323 弱點 - CAN-2004-0117 緩和因素：

-   在大多數常見案例中，NetMeeting (使用 H.323) 必須在執行中才會受此弱點影響。
-   在大多數常見案例中，使用網際網路連線防火牆 (ICF，Internet Connection Firewall)、且未執行任何 H.323 應用程式的系統，並不會受到此弱點影響。
-   除非系統管理員已經手動安裝 NetMeeting 的獨立版本，否則 Windows NT 4.0 並不會受到此弱點的影響。

#### H.323 弱點 - CAN-2004-0117 替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

-   **封鎖防火牆連接埠 TCP 1720 和 TCP 1503 的內送與輸出傳輸。**

    防火牆的最佳實務作法與標準的預設防火牆組態，都有助於保護網路免於遭受企業外部發動之攻擊的威脅。最佳的實務作法建議，是讓任何會連線至網際網路的系統僅開放最少量的連接埠。Microsoft 建議封鎖所有來源不明的網際網路內送傳輸，如此將有助於避免可能使用其他連接埠的攻擊手段。

    **使用替代的解決方案所受的影響：**

    如果已經封鎖 TCP 連接埠 1503、1720 的內送和輸出傳輸，使用者將無法連線至網際網路定址服務 ([ILS，Internet Locator Service](http://www.microsoft.com/windows2000/en/server/help/default.asp?url=/windows2000/en/server/help/sag_tapiconcepts_125.htm))、或是其他的 NetMeeting 用戶端。

#### H.323 弱點 - CAN-2004-0117 常見問題集：

**這個弱點的範圍為何？**

這是[緩衝區滿溢](http://go.microsoft.com/fwlink/?linkid=21141)的弱點。一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**造成這個弱點的原因為何？**

Microsoft H.323 實作時的未檢查緩衝區。

**何謂 H.323？**

H.323 是一種 ITU 標準，可以指定用於多媒體的個人電腦、設備和服務如何透過無服務層次保證的網路 (例如網際網路) 來進行通訊。H.323 終端機和設備可傳送即時視訊、聲音、資料，或是這些項目的任意組合。使用應用 H.323 於音訊與視訊的產品時，使用者可以透過網際網路與其他人連線並進行通訊，就像人們使用各種不同產品與機型的電話機來透過電話通訊一樣。

**有哪些受影響應用程式會使用 H.323 通訊協定？**

有些 Microsoft 應用程式與作業系統元件會執行 H.323 通訊協定。系統若是有執行下列其中一項、或更多項服務或應用程式，就會受到此問題影響：

-   Telephony Application Programming Interface (TAPI) 應用程式
-   [NetMeeting](http://www.microsoft.com/windows/netmeeting/)
-   網際網路連線防火牆 [(ICF)](http://www.microsoft.com/windowsxp/pro/using/howto/networking/icf.asp)
-   網際網路連線共用 (ICS)
-   Microsoft 路由及遠端存取服務 (RRAS)

**何謂 TAPI？**

Windows Telephony Applications Programming Interface (TAPI) 是 Windows Open System Architecture 的一部份。使用 TAPI，開發人員可以建立電話語音應用程式。TAPI 是開放式業界標準，是集結全球電話語音和運算社群的大量與持續增加意見所定義的成果。由於 TAPI 不受限於硬體種類，所以相容的應用程式可以在多種類型的個人電腦和電話語音硬體上執行，而且可以支援多種網路服務。TAPI 會執行 H.323 通訊協定。使用 TAPI 的應用程式可能會受到本公告中所述問題的影響。

**受影響系統是否有預設安裝任何以 TAPI 為基礎的 H.323 應用程式？**

Microsoft Phone Dialer 是唯一預設安裝於 Windows 2000、Windows XP 上的 H.323 TAPI 應用程式。協力廠商應用程式可以透過 TAPI 來啟用、並使用 H.323 功能。

**注意**Microsoft Phone Dialer 並未包含於 Windows Server 2003 中。

**何謂 NetMeeting？**

NetMeeting 為所有 Windows 使用者提供了完整的網際網路和企業會議解決方案，其中包括多方資料會議、文字聊天、電子白板、檔案傳輸，以及點對點的音訊和視訊。所有的受影響系統都會安裝 NetMeeting，且此程式會執行 H.323 通訊協定，但是並非預設執行。

**如果我在執行 NetMeeting 時沒有執行網際網路連線共用 (ICS)、ICF 或路由及遠端存取服務 (RRAS)，是否會受到此弱點影響？**

會。您在執行 NetMeeting 的同時，就會受到此問題弱點的影響。

**如果我在執行 NetMeeting 時並未連線到 ILS 伺服器、或是我正處於對等網路 NetMeeting 工作階段中，我是否會受到此弱點的影響？**

是，除非您已封鎖系統上的 TCP 連接埠 1720 和 1503。

**如果我從未安裝的 NetMeeting 的獨立版本，是否會受到此弱點的影響？**

NetMeeting 會隨 Windows 2000、Windows XP 和 Windows Server 2003 提供，而本更新程式可以解決隨這些系統所提供之 NetMeeting 版本的問題。其他作業系統和其他應用程式的部分元件，因為可以下載 NetMeeting 的獨立版本，可能也會受到受到此問題弱點的影響。如果您已安裝 NetMeeting 的獨立版本，應該要安裝可解決此弱點的更新版本。如果要下載更新的版本，請到這個 [網站](http://www.microsoft.com/windows/netmeeting/)下載。

**這項弱點是否會對 Windows 98、Windows 98 Second Edition 或 Windows Millennium Edition 帶來重大的影響？**

否。雖然這些作業系統可能包含 NetMeeting，但此弱點並不會對這些作業系統帶來重大的影響。您可以從這個 [網站](http://www.microsoft.com/windows/netmeeting/)下載並在這些作業系統上安裝 NetMeeting 的獨立版本，以便解決這個弱點。如需更多有關這些嚴重性等級的資訊，請參閱此 [網站](http://technet.microsoft.com/security/bulletin/rating)。

**何謂網際網路連線防火牆 (ICF)？**

網際網路連線防火牆 (ICF) 為執行 Windows XP 或 Windows Server 2003 的系統提供了基本的入侵防禦功能。這項功能所設計的使用目標，是直接連線到公用網路的系統，以及使用「網際網路連線共用」功能之家用網路中的組成系統。

**如果我在 Windows XP 或 Windows Server 2003 上只有執行網際網路連線防火牆，是否會受到此弱點的影響？**

否，不會自動受到影響。但是，如果您使用 NetMeeting，即使是執行 ICF，就會受到此問題弱點的影響。NetMeeting 會在 ICF 中開啟可能會暴露此弱點的連接埠。

手動開啟 TCP 連接埠 1720 和 1503 也可能會導致受此弱點影響。協力廠商應用程式也可能為回應 H.323 通訊而導致 ICF 開啟連接埠。

**何謂網際網路連線共用？**

使用網際網路連線共用時，使用者可以將系統連線到網際網路，並與家用或小型辦公室網路的幾部其他系統共用網際網路服務。Windows XP 中的「網路安裝精靈」將自動提供所有必要的網路設定，以便網路中的所有系統可共用網際網路連線。當系統直接連線到網際網路時，每部系統都可以使用 Internet Explorer 與 Outlook Express 等程式。

網際網路連線共用屬於 Windows 2000、Windows XP 和 Windows Server 2003 的功能，但是並非任何受影響系統的預設啟用功能。

**如果我已經啟用網際網路連線共用，但是尚未啟用網際網路連線防火牆，我是否會受到此弱點的影響？**

會。網際網路連線共用會啟用必要的連接埠，而使得系統可能遭到此弱點的影響。

如果同時執行 ICF 與網際網路連線共用，就不會遭到攻擊，除非該使用者也同時在使用 NetMeeting 應用程式，或是已手動開啟連接埠 1503 或連接埠 1720。

**何謂 Microsoft 路由及遠端存取服務 (RRAS)？**

Microsoft 路由及遠端存取服務 (RRAS) 使得執行 Windows 2000 Server 或 Windows Server 2003 的系統得以執行如同網路路由器的功能。有遠端系統的使用者可以透過遠端存取，建立對組織網路、或網際網路的邏輯連線。Microsoft 路由及遠端存取服務 (RRAS) 支援經過網路發出或接收的 H.323 要求。

**如果我正在 Windows 2000 上執行 Microsoft 路由及遠端存取服務，是否會受到此弱點的影響？**

會。依預設值，Windows 2000 會搭配使用 Microsoft 路由及遠端存取服務及網路位址轉譯 (NAT) 功能，因此會暴露出這項弱點。但是，系統管理員可以使用 netsh 命令來停用 H.323 功能。如需詳細說明步驟，請參閱 Microsoft 知識庫文件編號[838834](http://support.microsoft.com/?kbid=838834)。

**注意：**如果系統已設定成執行另一個未啟用 NAT 的 RRAS (例如，虛擬私人網路、OSPF 或 Routing Information Protocol)，該系統便不會受到此弱點的影響。

**如果我正在 Windows Server 2003 上執行 Microsoft 路由及遠端存取服務，我是否會受到此弱點的影響？**

不會。依照預設，Windows Server 2003 路由及遠端存取服務不會啟用 H.323 功能。但是，系統管理員可以啟用 H.323 功能，而導致系統受此弱點影響。

**攻擊者可能會利用這項弱點採取什麼動作？**

一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**誰可以利用這項弱點？**

任何可向上述任一受影響系統，傳送蓄意設計的 H.323 要求的匿名使用者。

**攻擊者如何利用這個弱點？**

攻擊者可能會透過找出執行 NetMeeting 的使用者或是以 H.323 為基礎的 TAPI 應用程式，或是上述二者，再伺機利用此弱點發動攻擊。

攻擊者也可能透過網際網路連線共用，在已啟用網際網路連線共用的系統中遠端執行程式碼，伺機利用此弱點發動攻擊。如果系統同時執行 ICF 和網路網路連線共用，就不可能遭到攻擊，除非使用者也同時使用 NetMeeting 應用程式。

**因這項弱點所產生的風險主要會發生在那些系統上？**

執行 NetMeeting 的系統，或是執行 H.323 程式的系統。

**更新的作用何在？**

本更新程式會修改受影響系統對蓄意設計之 H.323 要求的處理方式。

#### 虛擬 DOS 機器弱點 - CAN-2004-0118：

處理虛擬 DOS 機器 (VDM，Virtual DOS Machine) 子系統的作業系統元件具有一項[權限提昇](http://go.microsoft.com/fwlink/?linkid=21142)的弱點。這項弱點可能讓已登入使用者取得系統的完整控制權。

#### 虛擬 DOS 機器弱點 - CAN-2004-0118 緩和因素：

-   攻擊者必須擁有有效的登入憑證登入本機，才能利用這項弱點。其無法以遠端方式利用這項弱點。
-   Windows XP 和 Windows Server 2003 並未受此弱點的影響。

#### 虛擬 DOS 機器弱點 - CAN-2004-0118 替代解決方案：

無

#### 虛擬 DOS 機器弱點 - CAN-2004-0118 常見問題集：

**這個弱點的範圍為何？**

這是權限提昇的弱點。一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。攻擊者必須先本機登入至系統、並執行程式，才能利用此弱點發動攻擊。

**造成這個弱點的原因為何？**

處理 VDM 子系統的作業系統元件，會被用來作為取得受保護核心記憶體存取權的工具。在特定環境下，某些具權限的作業系統功能可能未能驗證系統結構，而使得攻擊者得以用系統權限來執行惡意程式碼。

**何謂虛擬 DOS 機器子系統？**

虛擬 DOS 機器 (VDM) 是能 Windows NT 作業系統中模擬 MS-DOS 和以 DOS 為基礎的 Windows 的環境。每當使用者在 Windows NT 作業系統上啟動 MS-DOS 應用程式時，就會建立 VDM。

**攻擊者可能會利用這項弱點採取什麼動作？**

一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**誰可以利用這項弱點？**

攻擊者必須先本機登入至系統、並執行程式，才能利用此弱點發動攻擊。

**攻擊者如何利用這個弱點？**

攻擊者如果想利用此弱點發動攻擊，就必須先登入系統。接著，攻擊者便可執行可利用此弱點發動攻擊之蓄意設計的應用程式，進一步取得受影響系統的完整控制權。

**因這項弱點所產生的風險主要會發生在那些系統上？**

工作站和終端伺服器的風險最高。只有在沒有足夠管理憑證的使用者被授予登入伺服器並執行程式的能力時，伺服器才會有此風險。然而，最佳實務強烈建議您制止這個行為。

**能夠在網際網路上利用這項弱點嗎？**

不會。攻擊者必須要能登入意圖攻擊的特定系統。攻擊者無法利用此弱點在遠端載入及執行程式。

**更新的作用何在？**

本更新程式會修改 Windows 在參照 VDM 所配置記憶體位置時進行驗證資料的方式。

#### 交涉 SSP 弱點 - CAN-2004-0119

交涉安全性支援提供者 (SSP，Security Software Provider) 介面具有一項[緩衝區滿溢](http://go.microsoft.com/fwlink/?linkid=21142)的弱點，可能會導致允許執行程式碼。這項弱點的出現原因，是因為交涉 SSP 介面在驗證通訊協定選取過程中驗證數值的方法所造成的。成功利用此弱點的攻擊者可以取得受影響系統的完整控制權。

#### 交涉 SSP 弱點 - CAN-2004-0119 緩和因素：

-   在大多數常見案例中，這項弱點屬於[拒絕服務](http://go.microsoft.com/fwlink/?linkid=21142)的弱點。
-   網際網路資訊服務 (IIS) 中也會預設啟用交涉 SSP 介面但是，只有 Windows 2000 (IIS 5.0) 和 Windows Server 2003 Web Server Edition (IIS 6.0) 會預設安裝網際網路資訊服務 (IIS)。
-   Windows NT 4.0 並未受此弱點影響。

#### 交涉 SSP 弱點 - CAN-2004-0119 替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

-   **網際網路資訊服務攻擊方法的替代解決方案**
    -   **停用整合式 Windows 驗證**

        系統管理員可以停用 \[整合式 Windows 驗證\] 來降低網際網路資訊服務受到攻擊的風險。如需如何啟用或停用此選項的詳細資訊，請參閱[網站](http://www.microsoft.com/resources/documentation/iis/6/all/proddocs/en-us/default.asp?url=/resources/documentation/iis/6/all/proddocs/en-us/sec_auth_intwinauth.asp)。

        **使用替代的解決方案所受的影響：**任何需要 Windows NT 挑戰/回應驗證 (NTLM) 或 Kerberos 驗證的 IIS 應用程式將無法正常執行。

    -   **停用交涉 SSP**

        系統管理員可以依照下面的 Microsoft 知識庫文件編號[215383](http://support.microsoft.com/?id=215383) 中的步驟，只停用交涉 SSP (NTLM 仍然保持啟用狀態)，以下摘要列出執行步驟：

        如果要停用交涉 (因而避免進行 Kerberos 驗證)，請使用下列命令。請注意，NTLM 必須是大寫，才不會造成任何不良效果：

        `cscript adsutil.vbs set w3svc/NTAuthenticationProviders "NTLM"`

        **使用替代的解決方案所受的影響：**任何要求 Kerberos 驗證的 IIS 應用程式將無法正常執行。

#### 交涉 SSP 弱點 - CAN-2004-0119 常見問題集：

**這個弱點的範圍為何？**

這是緩衝區滿溢的弱點。不過它最可能造成拒絕服務的情形。一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**造成這個弱點的原因為何？**

交涉 SSP 介面中的未檢查緩衝區。

**何謂交涉安全性支援提供者介面？**

由於 Windows 支援許多不同類型的驗證方式，所以必須交涉當用戶端連線到伺服器時所使用的驗證方式。交涉 SSP 介面便是提供這項功能的作業系統元件。這個元件是架構在 [RFC 2478](http://www.ietf.org/rfc/rfc2478.txt?number=2478) 所定義的簡單保護 GSS-API 交涉機制 (SPNEGO，Simple and Protected GSS-API Negotiate Mechanism) 之上。如需更多有關這些 Windows 驗證方法的資訊，請參閱此 [網站](http://www.windowsitlibrary.com/content/617/06/1.html)。

**為何網際網路資訊服務會受到影響？**

網際網路資訊服務 (IIS) 也會預設啟用交涉 SSP 介面，如此 IIS 才可使用例如 NTLM 或 Kerberos 等驗證通訊協定來提供資源的安全存取。如需關於 IIS 所支援驗證方式的詳細資訊，請造訪下面的 [網站](http://support.microsoft.com/default.aspx?scid=kb;en-us;264921)。

**攻擊者可能會利用這項弱點採取什麼動作？**

儘管多半只會造成拒絕服務的問題，但是一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或是建立具有完整權限的新帳戶。如果攻擊者造成受影響系統沒有回應，系統管理員可以重新啟動該受影響系統來回復正常功能；但是在套用更新程式之前，該系統仍然非常容易受到新的拒絕服務攻擊。

**誰可以利用這項弱點？**

任何匿名使用者，只要可以將蓄意設計的訊息傳送到受影響系統，都可以利用這項弱點來發動攻擊。因為所有的受影響系統都是預設此功能為啟用狀態，這表示任何一位可與受影響系統建立連線的使用者，都可以嘗試利用這項弱點來發動攻擊。

**攻擊者如何利用這個弱點？**

攻擊者會建立蓄意設計的網路訊息、並將它傳送給受影響系統，再伺機利用此弱點來發動攻擊。

攻擊者可以透過其他方式存取受到影響的元件，像是以互動方式登入系統，或是使用另一個應用程式以本機或遠端方式將參數傳送至防備不周延的元件中。

**因這項弱點所產生的風險主要會發生在那些系統上？**

依照預設，所有受影響系統都會受到此問題弱點的影響。此外，依照預設，執行 Internet Information Service 5.0、Internet Information Service 5.1 和 Internet Information Service 6.0 的系統也會因為聽候連接埠而受到這個弱點的影響。

**更新的作用何在？**

本更新程式能修改在訊息傳送到分配緩衝區之前、交涉 SSP 介面為該訊息長度進行驗證的方式，進而消除上述弱點。

#### SSL 弱點 - CAN-2004-0120：

Microsoft Secure Sockets Layer (SSL) 函式庫具有一項[拒絕服務](http://go.microsoft.com/fwlink/?linkid=21142)的弱點。此弱點是因為 Microsoft SSL 函式庫對格式錯誤 SSL 訊息的處理方式所導致。這項弱點會導致受影響系統停止接受 Windows 2000 和 Windows XP 上面的 SSL 連線。在 Windows Server 2003 中，此項弱點會導致受影響系統自動重新啟動。

#### SSL 弱點 - CAN-2004-0120 緩和因素：

-   只有啟用 SSL 的系統才會受影響，通常這些系統都是伺服器系統。在受影響的系統中，並不會預設啟用 SSL 支援。不過，網頁伺服器經常會使用 SSL 來支援電子商務程式、線上銀行或是其他需要安全通訊的程式。
-   防火牆的最佳實務作法與標準的預設防火牆組態，都有助於保護網路免於遭受企業外部發動之攻擊的威脅。最佳的實務作法建議，是讓任何會連線至網際網路的系統僅開放最少量的連接埠。
-   Windows NT 4.0 並未受此弱點影響。

#### SSL 弱點 - CAN-2004-0120 替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

-   **封鎖防火牆上的 443 和 636 連接埠**

    連接埠 443 是用來接收 SSL 傳輸。連接埠 636 是用於 LDAP SSL 連線 (LDAPS)。在防火牆上阻擋這些連接埠，將有助於避免攻擊者嘗試利用這個弱點，對防火牆之後的系統進行攻擊。日後攻擊者也可能會透過其他連接埠來利用此項弱點。不過，此處列出的連接埠是最常用來攻擊的對象。Microsoft 建議封鎖所有來源不明的網際網路內送傳輸，如此將有助於避免可能使用其他連接埠的攻擊手段。

    **使用替代的解決方案所受的影響：**如果連接埠 443 或 636 已完成封鎖，此類受影響的系統將無法接受使用 SSL 或 LDAPS 的外部連線。

#### SSL 弱點 - CAN-2004-0120 常見問題集：

**這個弱點的範圍為何？**

Microsoft Secure Sockets Layer (SSL) 函式庫具有一項[拒絕服務](http://go.microsoft.com/fwlink/?linkid=21142)的弱點，這項弱點會影響 SSL 對蓄意設計之 SSL 訊息的處理方式。這項弱點會導致受影響系統停止接受 Windows 2000 和 Windows XP 中的 SSL 連線。在 Windows Server 2003 中，此項弱點會導致受影響系統自動重新啟動。

請注意，拒絕服務弱點不會允許攻擊者執行程式碼、或提昇他們的權限，但是會導致受影響系統停止接受要求。

**造成這個弱點的原因為何？**

SSL 函式庫用來檢查訊息輸入的處理程序。

**何謂 Microsoft Secure Sockets Layer 函式庫？**

Microsoft Secure Sockets Layer 函式庫包含一些安全通訊協定的支援。這些通訊協定包括 Transport Layer Security 1.0 (TLS 1.0)、Secure Sockets Layer 3.0 (SSL 3.0)、舊版及較少使用的 Secure Sockets Layer 2.0 (SSL 2.0)，以及 Private Communication Technology 1.0 (PCT 1.0) 通訊協定。

這些通訊協定能讓伺服器與用戶端系統之間維持加密的連線。SSL 可以在使用者連線至公用網路 (例如，網際網路) 時協助保護私人資訊。SSL 支援需要一份安裝在伺服器上的 SSL 憑證。如需有關 SSL 的進一步資訊，請參閱 Microsoft 知識庫文件編號 [245152](http://support.microsoft.com/default.aspx?scid=kb;en-us;q245152)。

**攻擊者可能會利用這項弱點採取什麼動作？**

在 Windows 2000 與 Windows XP 中，成功利用此弱點發動攻擊的攻擊者，可能會導致受影響系統停止接受 SSL 連線。在 Windows Server 2003 中，攻擊者會導致受影響系統自動重新啟動。而受影響的系統在那段期間就會無法回應驗證要求。重新開機之後，受影響的系統可以回復正常的運作。不過在套用更新程式之前，它有可能會再度受到新的拒絕服務攻擊。

如果攻擊者利用此弱點發動攻擊，系統就會記錄系統錯誤事件。「系統事件日誌」可能記錄「訊息識別碼 5000」，其中 SymbolicName 的值為 SPMEVENT\_PACKAGE\_FAULT，以及下列的描述：

The security package NAME generated an exception (安全性封裝 NAME產生例外狀況)，其中 NAME 的值會是 Schannel 或 Microsoft Unified Security Protocol Provider。

**誰可以利用這項弱點？**

任何匿名使用者，只要可以將蓄意設計的 SSL 訊息傳送到受影響系統，都可以利用這項弱點來發動攻擊。

**攻擊者如何利用這個弱點？**

想要利用此弱點之攻擊者可以建立一個程式，透過啟用 SSL 的服務與防備不周全的伺服器進行通訊，以傳送特定種類的蓄意設計 TCP 訊息。只要接收這類訊息，就可能會造成防備不周全的系統執行失敗，而導致拒絕服務。

攻擊者可以透過其他方式存取受到影響的元件，像是以互動方式登入系統，或是使用另一個應用程式以本機或遠端方式將參數傳送至防備不周延的元件中。

**因這項弱點所產生的風險主要會發生在那些系統上？**

所有啟用 SSL 的系統都會受到此弱點的影響。雖然 SSL 通常與「網際網路資訊服務」(Internet Information Services) 有關 (因為使用 HTTPS 和連接埠 443)，不過任何在受影響的平台上執行 SSL 的服務都可能會受到此弱點的影響。這些應用程式包括 (但是不限於此處所列)：Internet Information Services 4.0、Internet Information Services 5.0、Internet Information Services 5.1、Exchange Server 5.5、Exchange Server 2000、Exchange Server 2003、Analysis Services 2000 (隨 SQL Server 2000 提供) 以及使用 SSL 的協力廠商應用程式。

已同時安裝「企業根憑證授權單位」的 Active Directory 網域中所安裝的 Windows 2000 網域控制站，也會受到此弱點的影響，因為這些控制站會自動聆聽安全的 SSL 連線。

**更新的作用何在？**

本更新程式會修改蓄意設計之 SSL 訊息的處理方式，藉以消除此項弱點。

#### ASN.1 Double Free (重複釋放相同記憶體) 弱點 - CAN-2004-0123

Microsoft ASN.1 LIBRARY 具有一項遠端程式碼執行的弱點。這項弱點是由 Microsoft ASN.1 LIBRARY 中可能導致受影響系統的記憶體毀損的可能 double-free (釋放相同的記憶體空間兩次) 情形所造成。成功利用此弱點的攻擊者可以取得受影響系統的完整控制權。但是在大多數可能的攻擊案例中，這屬於[拒絕服務](http://go.microsoft.com/fwlink/?linkid=21142)的弱點。

#### ASN.1 Double Free (重複釋放相同記憶體) 弱點 - CAN-2004-0123 緩和因素：

-   由於每個受影響系統具有唯一獨特的記憶體結構配置，所以利用此項弱點發動全面性的攻擊應該比較困難。

#### ASN.1 Double Free (重複釋放相同記憶體) 弱點 - CAN-2004-0123 替代解決方案：

無

#### ASN.1 Double Free (重複釋放相同記憶體) 弱點 - CAN-2004-0123 常見問題集：

**這個弱點的範圍為何？**

雖然這屬於潛在的遠端程式碼執行弱點，這個問題多半屬於[拒絕服務](http://go.microsoft.com/fwlink/?linkid=21142)的弱點。但是，可以成功利用此項弱點來執行程式碼的攻擊者，將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。

**造成這個弱點的原因為何？**

Microsoft ASN.1 LIBRARY 中可能導致記憶體毀損的潛在 double-free (重複釋放相同記憶體) 情形。

**何謂 double-free (重複釋放相同記憶體) 情形？**

攻擊者可能藉由使受影響系統處理蓄意設計訊息的方式，使系統「釋放」已多次釋出使用的記憶體。釋放已經被釋出的記憶體，可能會導致記憶體毀損的情形。攻擊者可能會在記憶體中加入任意程式碼，以便在發生毀損時執行。這段程式碼可能會在特定系統權限之下執行。

一般而言，這項弱點會造成拒絕服務。但是，在少數情況中也會發生執行程式碼的情形。由於每個受影響系統的記憶體配置方式都不盡相同，所以利用此項弱點發動全面性的攻擊應該比較困難。

**何謂 ASN.1？**

Abstract Syntax Notation 1 (ASN.1) 是用來定義標準的語言。科技業界中有許多應用程式與設備會使用這項語言，讓資料能夠在各種平台之間進行交換。ASN.1 與任何特定標準、編碼方式、程式語言或硬體平台沒有直接的關聯，如需有關 ASN.1 的進一步資訊，請參閱 Microsoft 知識庫文件編號 [252648](http://support.microsoft.com/default.aspx?scid=kb;en-us;252648)。

**攻擊者可能會利用這項弱點採取什麼動作？**

一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立具有完整權限的新帳戶。

在大多數的案例中，攻擊者可能會導致[拒絕服務](http://go.microsoft.com/fwlink/?linkid=21142)情形。系統管理員可以重新啟動受影響系統來回復正常的運作。

**攻擊者如何利用這個弱點？**

由於 ASN.1 是許多應用程式及設備的標準，有數種潛在的攻擊方式必須留意。攻擊者若是要成功利用此項弱點來發動攻擊，就必須強迫系統解碼蓄意設計的 ASN.1 資料。例如，使用以 ASN.1 為基礎的驗證通訊協定時，攻擊者就能蓄意建構特殊的驗證要求，以利用這一項弱點。

**因這項弱點所產生的風險主要會發生在那些系統上？**

伺服器系統面臨的風險會高於用戶端系統，因為前者比較可能會執行負責 ASN.1 資料解碼的伺服器處理序。

**這項弱點是否會對 Windows 98、Windows 98 Second Edition 或 Windows Millennium Edition 帶來重大的影響？**

不會。由於 Windows Millennium Edition 並未包含受影響元件，這項弱點不會產生重大的影響。如需更多有關這些嚴重性等級的資訊，請參閱此[網站](http://technet.microsoft.com/security/bulletin/rating)。

**更新的作用何在？**

更新程式會修改 ASN.1 Library 處理蓄意設計資料的方法，藉以消除此項弱點。

**這個弱點與 MS04-007 所修正的弱點有何關聯？**

這兩項弱點都是出現在 ASN.1 元件中，不過本更新會修正 MS04-007 未解決的最新公佈弱點。MS04-007 可完全保護該公告所討論的弱點項目，但是本更新程式包括了 MS04-007 提供的所有更新程式，因此可以取代前述公告。如果您要安裝此更新程式，就不需安裝 MS04-007。

安全性更新資訊
--------------

<span></span>
**安裝平台及必要條件：**

如需有關您使用平台的特定安全性更新的資訊，請按下適當的連結：

#### Windows Server 2003 (所有版本)

**必要條件**
這個安全性更新需要 Windows Server 2003 的發行版本。

**未來將包含於此 Service Pack 中：**
本問題的更新程式會包含在 Windows Server 2003 Service Pack 1 中。

**Installation Information**

This security update supports the following setup switches:

**/help** 顯示命令列選項

**安裝模式**

**/quiet** ****無訊息模式 (無使用者互動，不顯示任何訊息)

**/passive** 自動安裝模式 (僅顯示進度列)

**/uninstall**將套件解除安裝

**重新啟動選項**

**/norestart** 安裝完成時不要重新開機

**/forcerestart** 安裝之後重新開機

**特殊選項**

**/l** 列出安裝的 Windows Hotfix 或更新的套件

**/o** 不先提示，直接覆寫 OEM 檔案

**/n** 不備份解除安裝所需的檔案

**/f** 當電腦關機時，強制其他程式關閉

**注意**您可以在同一個指令中合併使用這些參數。為符合回溯相容性，安全性更新程式也支援舊版安裝公用程式使用的設定參數。如需關於支援的安裝參數的詳細資訊，請參閱 Microsoft 知識庫文件編號 [262841](http://support.microsoft.com/default.aspx?kbid=262841)。

**部署資訊**

在 Windows Server 2003 上，如想在不需要使用者介入的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windowsserver2003-kb835732-x86-enu /passive /quiet**

在 Windows Server 2003 上，如想在不強制系統重新開機的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windowsserver2003-kb835732-x86-enu /norestart**

如想進一步瞭解如何透過「軟體更新服務」部署這個安全性更新，請瀏覽[軟體更新服務網站](http://go.microsoft.com/fwlink/?linkid=21125)。

**重新開機需求**

套用此安全性更新程式之後，您必須重新啟動系統。

**移除資訊**

若要移除此更新程式，請使用 \[控制台\] 中的 \[新增/移除程式\]。

系統管理員也可以使用 Spuninst.exe 公用程式來移除此安全性更新。Spuninst.exe 位於 %Windir%\\$NTUninstallKB828741$\\Spuninst 資料夾中。Spuninst.exe 公用程式支援以下的安裝參數：

**/?**：顯示安裝參數

**/u**：使用自動安裝模式

**/f**：當電腦關機時，強制其他程式結束

**/z**：安裝完成時，不重新啟動

**/q**：使用無訊息模式 (沒有使用者介面)

**檔案資訊**

本補充程式的英文版本具有下表列出的檔案屬性 (或更新的版本)。這些檔案的日期及時間均使用 Coordinated Universal Time (UTC)。當您檢視檔案資訊時，它會轉換為當地時間。如想知道 UTC 及當地時間的時差，請使用 \[控制台\] 內的 \[日期/時間\] 工具的 **\[時區\] 索引標籤。**

Windows Server 2003、Enterprise Edition、Windows Server 2003 Standard Edition、Windows Server 2003 Web Edition 及 Windows Server 2003 Datacenter Edition：

`日期         時間      版本              大小         檔案名稱       平台      資料夾-----------------------------------------------------------------------------16-Mar-2004  02:00  5.2.3790.132      364,544  Callcont.dll     X86   RTMGDR16-Mar-2004  02:00  5.2.3790.121       61,440  Eventlog.dll     X86   RTMGDR16-Mar-2004  02:00  5.2.3790.132      256,000  H323.tsp         X86   RTMGDR16-Mar-2004  02:00  5.2.3790.132      601,600  H323msp.dll      X86   RTMGDR16-Mar-2004  02:00  5.2.3790.125      783,360  Helpctr.exe      X86   RTMGDR16-Mar-2004  02:00  5.2.3790.142      448,512  Ipnathlp.dll     X86   RTMGDR16-Mar-2004  02:00  5.2.3790.134      799,232  Lsasrv.dll       X86   RTMGDR16-Mar-2004  02:00  5.2.3790.139       60,928  Msasn1.dll       X86   RTMGDR16-Mar-2004  02:00  5.2.3790.132      253,952  Mst120.dll       X86   RTMGDR16-Mar-2004  02:00  5.2.3790.132       73,728  Nmcom.dll        X86   RTMGDR16-Mar-2004  02:00  5.2.3790.121      565,760  Rtcdll.dll       X86   RTMGDR16-Mar-2004  02:00  5.2.3790.132      153,088  Schannel.dll     X86   RTMGDR16-Mar-2004  02:09  5.2.3790.132      364,544  Callcont.dll     X86   RTMQFE16-Mar-2004  02:09  5.2.3790.121       64,000  Eventlog.dll     X86   RTMQFE16-Mar-2004  02:09  5.2.3790.132      256,000  H323.tsp         X86   RTMQFE16-Mar-2004  02:09  5.2.3790.132      601,600  H323msp.dll      X86   RTMQFE16-Mar-2004  02:09  5.2.3790.125      783,360  Helpctr.exe      X86   RTMQFE16-Mar-2004  02:09  5.2.3790.142      448,512  Ipnathlp.dll     X86   RTMQFE16-Mar-2004  02:09  5.2.3790.134      801,280  Lsasrv.dll       X86   RTMQFE16-Mar-2004  02:09  5.2.3790.139       60,928  Msasn1.dll       X86   RTMQFE16-Mar-2004  02:09  5.2.3790.132      253,952  Mst120.dll       X86   RTMQFE16-Mar-2004  02:09  5.2.3790.132       73,728  Nmcom.dll        X86   RTMQFE16-Mar-2004  02:09  5.2.3790.121      565,760  Rtcdll.dll       X86   RTMQFE16-Mar-2004  02:09  5.2.3790.132      153,088  Schannel.dll     X86   RTMQFE`

Windows Server 2003 64-Bit Enterprise Edition 及 Windows Server 2003 64-Bit Datacenter Edition：

`日期       時間        版本                    大小       檔案名稱        平台    資料夾-----------------------------------------------------------------------------16-Mar-2004  01:54  5.2.3790.121      160,768  Eventlog.dll     IA64   RTMGDR16-Mar-2004  01:54  5.2.3790.132      816,128  H323.tsp         IA64   RTMGDR16-Mar-2004  01:54  5.2.3790.132    1,874,432  H323msp.dll      IA64   RTMGDR05-Feb-2004  00:43  5.2.3790.125    2,063,360  Helpctr.exe      IA64   RTMGDR16-Mar-2004  01:54  5.2.3790.142    1,421,312  Ipnathlp.dll     IA64   RTMGDR16-Mar-2004  01:54  5.2.3790.134    2,034,176  Lsasrv.dll       IA64   RTMGDR16-Mar-2004  01:54  5.2.3790.139      160,256  Msasn1.dll       IA64   RTMGDR16-Mar-2004  01:54  5.2.3790.132      479,744  Schannel.dll     IA64   RTMGDR16-Mar-2004  02:00  5.2.3790.132      256,000  Wh323.tsp        X86    RTMGDR\WOW16-Mar-2004  02:00  5.2.3790.132      601,600  Wh323msp.dll     X86    RTMGDR\WOW16-Mar-2004  02:00  5.2.3790.142      448,512  Wipnathlp.dll    X86    RTMGDR\WOW16-Mar-2004  02:00  5.2.3790.139       60,928  Wmsasn1.dll      X86    RTMGDR\WOW16-Mar-2004  02:00  5.2.3790.132      153,088  Wschannel.dll    X86    RTMGDR\WOW16-Mar-2004  02:12  5.2.3790.121      167,424  Eventlog.dll     IA64   RTMQFE16-Mar-2004  02:12  5.2.3790.132      816,128  H323.tsp         IA64   RTMQFE16-Mar-2004  02:12  5.2.3790.132    1,874,432  H323msp.dll      IA64   RTMQFE05-Feb-2004  00:42  5.2.3790.125    2,063,360  Helpctr.exe      IA64   RTMQFE16-Mar-2004  02:12  5.2.3790.142    1,421,312  Ipnathlp.dll     IA64   RTMQFE16-Mar-2004  02:12  5.2.3790.134    2,038,272  Lsasrv.dll       IA64   RTMQFE16-Mar-2004  02:12  5.2.3790.139      160,256  Msasn1.dll       IA64   RTMQFE16-Mar-2004  02:12  5.2.3790.132      479,744  Schannel.dll     IA64   RTMQFE16-Mar-2004  02:09  5.2.3790.132      256,000  Wh323.tsp        X86    RTMQFE\WOW16-Mar-2004  02:09  5.2.3790.132      601,600  Wh323msp.dll     X86    RTMQFE\WOW16-Mar-2004  02:09  5.2.3790.142      448,512  Wipnathlp.dll    X86    RTMQFE\WOW16-Mar-2004  02:09  5.2.3790.139       60,928  Wmsasn1.dll      X86    RTMQFE\WOW16-Mar-2004  02:09  5.2.3790.132      153,088  Wschannel.dll    X86    RTMQFE\WOW`

**附註：**當您在 Windows Server 2003 或 Windows XP 64-Bit Edition Version 2003 電腦上安裝安全性更新時，安裝程式會檢查系統上要更新的檔案先前是否曾經用 Microsoft Hotfix 作過更新。如果您先前曾經安裝 Hotfix 更新其中一個檔案，安裝程式會將 RTMQFE 檔案複製到您的系統中。否則，安裝程式會將 RTMGDR 檔案複製到您的系統中。如需更多資訊，請參閱 Microsoft 知識庫文件編號 [824994](http://support.microsoft.com/default.aspx?kbid=824994)。

**確認更新的安裝**

如果想確定受影響的系統是否安裝了某個安全性更新，您可以使用 Microsoft Baseline Security Analyzer (MBSA) 工具。這個工具能讓系統管理員掃描本機和遠端系統，判斷是否漏裝了安裝性更新或是有一般安全性設定不當的情形。如需更多有關 MBSA 的資訊，請瀏覽 [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134)網站。

您也可以查看下列的登錄機碼，來確認安全性更新安裝的檔案：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB835732\\Filelist

**注意：**如果管理員或 OEM 將 835732 安全性更新整合 (或 slipstream) 到 Windows 安裝來源檔時，這個登錄機碼可能無法正確建立。

#### Windows XP (所有版本)

**附註**就 Windows XP 64-Bit Edition Version 2003 而言，這個安全性更新與 Windows Server 2003 64-Bit Edition 安全性更新是相同的。

**必要條件**
這個安全性更新程式需要 Windows XP 或 Windows XP Service Pack 1 (SP1) 的發行版本。如需更多資訊，請參閱 Microsoft 知識庫文件編號[322389](http://support.microsoft.com/default.aspx?scid=kb;en-us;322389)。

未來將包含於此 Service Pack 中：

**安裝資訊**

這個安全性更新支援以下的安裝參數：

**/help** 顯示命令列選項

**安裝模式**

**/quiet** ****無訊息模式 (無使用者互動，不顯示任何訊息)

**/passive** 自動安裝模式 (僅顯示進度列)

**/uninstall**將套件解除安裝

**重新啟動選項**

**/norestart** 安裝完成時不要重新開機

**/forcerestart** 安裝之後重新開機

**特殊選項**

**/l** 列出安裝的 Windows Hotfix 或更新的套件

**/o** 不先提示，直接覆寫 OEM 檔案

**/n** 不備份解除安裝所需的檔案

**/f** 當電腦關機時，強制其他程式關閉

**注意**您可以在同一個指令中合併使用這些參數。為符合回溯相容性，安全性更新程式也支援舊版安裝公用程式使用的設定參數。如需關於支援的安裝參數的詳細資訊，請參閱 Microsoft 知識庫文件編號 [262841](http://support.microsoft.com/default.aspx?kbid=262841)。

**部署資訊**

在 Windows XP 上，如想在不需要使用者介入的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windowsxp-kb835732-x86-enu /passive /quiet**

在 Windows XP 上，如想在不強制系統重新開機的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windowsxp-kb835732-x86-enu /norestart**

如想進一步瞭解如何透過「軟體更新服務」部署這個安全性更新，請瀏覽[軟體更新服務網站](http://go.microsoft.com/fwlink/?linkid=21125)。

**重新開機需求**

套用此安全性更新程式之後，您必須重新啟動系統。

**移除資訊**

如果要移除這個安全性更新程式，請使用 \[控制台\] 中的 \[新增或移除程式\] 工具。

系統管理員也可以使用 Spuninst.exe 公用程式來移除此安全性更新。Spuninst.exe 位於 %Windir%\\$NTUninstallKB828741$\\Spuninst 資料夾中。Spuninst.exe 公用程式支援以下的安裝參數：

**/?**：顯示安裝參數

**/u**：使用自動安裝模式

**/f**：當電腦關機時，強制其他程式結束

**/z**：安裝完成時，不重新啟動

**/q**：用無訊息模式 (沒有使用者介面)

**檔案資訊**

本更新程式的英文版本具有下表列出的檔案屬性 (或更新的版本)。這些檔案的日期及時間均使用 Coordinated Universal Time (UTC)。當您檢視檔案資訊時，它會轉換為當地時間。如想知道 UTC 及當地時間的時差，請使用 \[控制台\] 內的 \[日期/時間\] 工具的 **\[時區\] 索引標籤。**

Windows XP Home Edition、Windows XP Professional、Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP Tablet PC Edition 和 Windows XP Media Center Edition：

`日期         時間           版本                大小       檔案名稱        資料夾-----------------------------------------------------------------------27-Mar-2004  01:01  5.1.2600.105       48,640  Browser.dll     *127-Mar-2004  01:01  5.1.2600.133      364,544  Callcont.dll    *127-Mar-2004  01:01  5.1.2600.136       40,960  Evtgprov.dll    *127-Mar-2004  01:01  5.1.2600.132      241,664  Gdi32.dll       *127-Mar-2004  01:01  5.1.2600.134      253,440  H323.tsp        *127-Mar-2004  01:01  5.1.2600.134      593,408  H323msp.dll     *105-Feb-2004  22:14  5.1.2600.128      727,040  Helpctr.exe     *127-Mar-2004  01:01  5.1.2600.137      454,656  Ipnathlp.dll    *127-Mar-2004  01:01  5.1.2600.134      648,192  Lsasrv.dll      *127-Mar-2004  01:01  5.1.2600.132       36,864  Mf3216.dll      *127-Mar-2004  01:01  5.1.2600.137       51,712  Msasn1.dll      *127-Mar-2004  01:01  5.1.2600.128      969,216  Msgina.dll      *127-Mar-2004  01:01  5.1.2600.133      253,952  Mst120.dll      *127-Mar-2004  01:01  5.1.2600.122      301,568  Netapi32.dll    *127-Mar-2004  01:01  5.1.2600.133       73,728  Nmcom.dll       *127-Mar-2004  01:01  5.1.2600.134      550,400  Rtcdll.dll      *127-Mar-2004  01:01  5.1.2600.136      136,704  Schannel.dll    *126-Mar-2004  19:43  5.1.2600.1348     364,544  Callcont.dll    *226-Mar-2004  19:43  5.1.2600.1363      40,960  Evtgprov.dll    *226-Mar-2004  19:43  5.1.2600.1346     257,536  Gdi32.dll       *226-Mar-2004  19:43  5.1.2600.1348     253,440  H323.tsp        *226-Mar-2004  19:43  5.1.2600.1348     593,408  H323msp.dll     *226-Mar-2004  19:30  5.1.2600.1340     741,376  Helpctr.exe     *226-Mar-2004  19:43  5.1.2600.1364     439,808  Ipnathlp.dll    *226-Mar-2004  19:43  5.1.2600.1361     667,648  Lsasrv.dll      *226-Mar-2004  19:43  5.1.2600.1331      36,864  Mf3216.dll      *226-Mar-2004  19:43  5.1.2600.1362      51,712  Msasn1.dll      *226-Mar-2004  19:43  5.1.2600.1343     971,264  Msgina.dll      *226-Mar-2004  19:43  5.1.2600.1348     253,952  Mst120.dll      *226-Mar-2004  19:43  5.1.2600.1343     306,176  Netapi32.dll    *226-Mar-2004  19:43  5.1.2600.1348      73,728  Nmcom.dll       *226-Mar-2004  19:43  5.1.2600.1351     548,352  Rtcdll.dll      *226-Mar-2004  19:43  5.1.2600.1347     136,704  Schannel.dll    *210-Mar-2004  17:59  5.1.2600.1363     593,408  Xpsp2res.dll    *2`

\***1：**未含 SP1

\***2：**含 SP1

Windows XP 64-Bit Edition Service Pack 1：

`日期          時間         版本             大小       檔案名稱        資料夾--------------------------------------------------------------------------26-Mar-2004  19:40  5.1.2600.1363     134,656  Evtgprov.dll     IA6426-Mar-2004  19:40  5.1.2600.1346     884,736  Gdi32.dll        IA6426-Mar-2004  19:40  5.1.2600.1348   1,035,264  H323.tsp         IA6426-Mar-2004  19:40  5.1.2600.1348   2,230,272  H323msp.dll      IA6405-Feb-2004  21:40  5.1.2600.1340   2,426,368  Helpctr.exe      IA6426-Mar-2004  19:40  5.1.2600.1364   1,782,784  Ipnathlp.dll     IA6426-Mar-2004  19:40  5.1.2600.1361   2,069,504  Lsasrv.dll       IA6426-Mar-2004  19:40  5.1.2600.1331     128,512  Mf3216.dll       IA6426-Mar-2004  19:40  5.1.2600.1362     179,200  Msasn1.dll       IA6426-Mar-2004  19:40  5.1.2600.1343   1,272,320  Msgina.dll       IA6426-Mar-2004  19:40  5.1.2600.1343     903,168  Netapi32.dll     IA6426-Mar-2004  19:40  5.1.2600.1347     508,416  Schannel.dll     IA6426-Mar-2004  19:43  5.1.2600.1346     237,568  Wgdi32.dll       X8626-Mar-2004  19:43  5.1.2600.1348     253,440  Wh323.tsp        X8626-Mar-2004  19:43  5.1.2600.1348     593,408  Wh323msp.dll     X8626-Mar-2004  19:43  5.1.2600.1364     439,808  Wipnathlp.dll    X8626-Mar-2004  19:43  5.1.2600.1331      36,864  Wmf3216.dll      X8626-Mar-2004  19:43  5.1.2600.1362      51,712  Wmsasn1.dll      X8626-Mar-2004  19:43  5.1.2600.1343     971,264  Wmsgina.dll      X8626-Mar-2004  19:43  5.1.2600.1343     306,176  Wnetapi32.dll    X8626-Mar-2004  19:43  5.1.2600.1347     136,704  Wschannel.dll    X8610-Mar-2004  17:59  5.1.2600.1363     593,408  Wxpsp2res.dll    X8610-Mar-2004  17:59  5.1.2600.1363     592,896  Xpsp2res.dll     IA64`

Windows XP 64-Bit Edition Version 2003：

`日期       時間        版本                大小       檔案名稱        平台     資料夾-----------------------------------------------------------------------------16-Mar-2004  01:54  5.2.3790.121      160,768  Eventlog.dll     IA64   RTMGDR16-Mar-2004  01:54  5.2.3790.132      816,128  H323.tsp         IA64   RTMGDR16-Mar-2004  01:54  5.2.3790.132    1,874,432  H323msp.dll      IA64   RTMGDR05-Feb-2004  00:43  5.2.3790.125    2,063,360  Helpctr.exe      IA64   RTMGDR16-Mar-2004  01:54  5.2.3790.142    1,421,312  Ipnathlp.dll     IA64   RTMGDR16-Mar-2004  01:54  5.2.3790.134    2,034,176  Lsasrv.dll       IA64   RTMGDR16-Mar-2004  01:54  5.2.3790.139      160,256  Msasn1.dll       IA64   RTMGDR16-Mar-2004  01:54  5.2.3790.132      479,744  Schannel.dll     IA64   RTMGDR16-Mar-2004  02:00  5.2.3790.132      256,000  Wh323.tsp        X86    RTMGDR\WOW16-Mar-2004  02:00  5.2.3790.132      601,600  Wh323msp.dll     X86    RTMGDR\WOW16-Mar-2004  02:00  5.2.3790.142      448,512  Wipnathlp.dll    X86    RTMGDR\WOW16-Mar-2004  02:00  5.2.3790.139       60,928  Wmsasn1.dll      X86    RTMGDR\WOW16-Mar-2004  02:00  5.2.3790.132      153,088  Wschannel.dll    X86    RTMGDR\WOW16-Mar-2004  02:12  5.2.3790.121      167,424  Eventlog.dll     IA64   RTMQFE16-Mar-2004  02:12  5.2.3790.132      816,128  H323.tsp         IA64   RTMQFE16-Mar-2004  02:12  5.2.3790.132    1,874,432  H323msp.dll      IA64   RTMQFE05-Feb-2004  00:42  5.2.3790.125    2,063,360  Helpctr.exe      IA64   RTMQFE16-Mar-2004  02:12  5.2.3790.142    1,421,312  Ipnathlp.dll     IA64   RTMQFE16-Mar-2004  02:12  5.2.3790.134    2,038,272  Lsasrv.dll       IA64   RTMQFE16-Mar-2004  02:12  5.2.3790.139      160,256  Msasn1.dll       IA64   RTMQFE16-Mar-2004  02:12  5.2.3790.132      479,744  Schannel.dll     IA64   RTMQFE16-Mar-2004  02:09  5.2.3790.132      256,000  Wh323.tsp        X86    RTMQFE\WOW16-Mar-2004  02:09  5.2.3790.132      601,600  Wh323msp.dll     X86    RTMQFE\WOW16-Mar-2004  02:09  5.2.3790.142      448,512  Wipnathlp.dll    X86    RTMQFE\WOW16-Mar-2004  02:09  5.2.3790.139       60,928  Wmsasn1.dll      X86    RTMQFE\WOW16-Mar-2004  02:09  5.2.3790.132      153,088  Wschannel.dll    X86    RTMQFE\WOW`

**注意：**Windows XP 及 Windows XP 64-Bit Edition Version 2003 版的安全性更新是以雙重模式加以封裝的，其中包含 Windows XP 和 Windows XP Service Pack 1 (SP1) 兩種版本的原始檔案。有關雙重模式封裝的進一步資訊，請參閱 Microsoft 知識庫文件編號 [328848](http://support.microsoft.com/default.aspx?kbid=328848)。

當您安裝 Windows XP 64-Bit Edition Version 2003 安全性更新時，安裝程式會檢查系統上要更新的檔案先前是否曾經用 Microsoft Hotfix 作過更新。如果您先前曾經安裝 Hotfix 更新其中一個檔案，安裝程式會將 RTMQFE 檔案複製到您的系統中。否則，安裝程式會將 RTMGDR 檔案複製到您的系統中。如需更多資訊，請參閱 Microsoft 知識庫文件編號 [824994](http://support.microsoft.com/default.aspx?kbid=824994)。

**確認更新的安裝**

如果想確定受影響的系統是否安裝了某個安全性更新，您可以使用 Microsoft Baseline Security Analyzer (MBSA) 工具。這個工具能讓系統管理員掃描本機和遠端系統，判斷是否漏裝了安裝性更新或是有一般安全性設定不當的情形。如需更多有關 MBSA 的資訊，請瀏覽[Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134)網站。

您也可以查看下列登錄機碼，來確認此安全性更新程式所安裝的檔案：

Windows XP Home Edition、Windows XP Professional、Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP 64-Bit Edition Service Pack 1、Windows XP Tablet PC Edition、Windows XP Media Center Edition：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP2\\KB835732\\Filelist

Windows XP 64-Bit Edition Version 2003：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB835732\\Filelist

**附註：**如果管理員或 OEM 將 835732 安全性更新整合 (或 slipstream) 到 Windows 安裝來源檔時，這個登錄機碼可能無法正確建立。

#### Windows 2000 (所有版本)

**必要條件**
若為 Windows 2000，本安全性更新需要 Service Pack 2 (SP2)、Service Pack 3 (SP3) 或 Service Pack 4 (SP4)。

以上所列的軟體版本已經過測試判斷其是否會受到影響。其他版本已不再包含安全性更新支援，同時也不一定會受到影響。請瀏覽 [Microsoft 技術支援週期網站](http://go.microsoft.com/fwlink/?linkid=21742)，以瞭解您的產品及版本的支援生命週期。

如需有關取得最新 Service Pack 的進一步資訊，請參閱 Microsoft 知識庫文件編號 [260910](http://support.microsoft.com/default.aspx?scid=kb;en-us;260910)。

**未來將包含於此 Service Pack 中：**
此問題的更新程式將包含在 Windows 2000 Service Pack 5 中。

**安裝資訊**

這個安全性更新支援以下的安裝參數：

**/help** 顯示命令列選項

**安裝模式**

**/quiet** ****無訊息模式 (無使用者互動，不顯示任何訊息)

**/passive** 自動安裝模式 (僅顯示進度列)

**/uninstall**將套件解除安裝

**重新啟動選項**

**/norestart** 安裝完成時不要重新開機

**/forcerestart** 安裝之後重新開機

**特殊選項**

**/l** 列出安裝的 Windows Hotfix 或更新的套件

**/o** 不先提示，直接覆寫 OEM 檔案

**/n** 不備份解除安裝所需的檔案

**/f** 當電腦關機時，強制其他程式關閉

**注意**您可以在同一個指令中合併使用這些參數。為符合回溯相容性，安全性更新程式也支援舊版安裝公用程式使用的設定參數。有關支援的安裝參數的其他資訊，請參閱 Microsoft 知識庫文件編號 [262841](http://support.microsoft.com/default.aspx?kbid=262841)。

**部署資訊**

如使用 Windows 2000 Service Pack 2、Windows 2000 Service Pack 3 和 Windows 2000 Service Pack 4，如想在不需要使用者介入的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windows2000-kb835732-x86-enu /passive /quiet**

如使用 Windows 2000 Server Service Pack 2、Windows 2000 Service Pack 3 和 Windows 2000 Service Pack 4，如想在無需強制重新開機的情況下安裝安全性更新程式，請在命令提示字元後輸入：

**Windows2000-kb835732-x86-enu /norestart**

如想進一步瞭解如何透過「軟體更新服務」部署這個安全性更新，請瀏覽[軟體更新服務網站](http://go.microsoft.com/fwlink/?linkid=21125)。

**重新開機需求**

套用此安全性更新程之後，您必須重新啟動系統。

**移除資訊**

若要移除此安全性更新，請使用 \[控制台\] 中的 \[新增/移除程式\]。

系統管理員也可以使用 Spuninst.exe 公用程式來移除此安全性更新。Spuninst.exe 公用程式位於 %Windir%\\$NTUninstallKB835732$\\Spuninst 資料夾中。Spuninst.exe 公用程式支援以下的安裝參數：

**/?**：顯示安裝參數

**/u**：使用自動安裝模式

**/f**：當電腦關機時，強制其他程式結束

**/z**：安裝完成時，不重新啟動

**/q**：使用無訊息模式 (沒有使用者介面)

**檔案資訊**

本更新程式的英文版本具有下表列出的檔案屬性 (或更新的版本)。這些檔案的日期及時間均使用 Coordinated Universal Time (UTC)。當您檢視檔案資訊時，它會轉換為當地時間。如想知道 UTC 及當地時間的時差，請使用 \[控制台\] 內的 \[日期/時間\] 工具的 **\[時區\] 索引標籤。**

**注意**日期和時間資訊可能會在安裝時有所變更。您應該使用版本、大小及檔案名稱資訊來判斷檔案的正確性。

Windows 2000 Service Pack 2、Windows 2000 Service Pack 3 和 Windows 2000 Service Pack 4：

`日期        時間         版本            大小        檔案名稱        資料夾-----------------------------------------------------------------------24-Mar-2004  02:17  5.0.2195.6876     388,368  Advapi32.dll24-Mar-2004  02:17  5.0.2195.6824      42,256  Basesrv.dll24-Mar-2004  02:17  5.0.2195.6866      69,904  Browser.dll24-Mar-2004  02:17  5.0.2195.6901     394,512  Callcont.dll21-Sep-2003  00:45  5.0.2195.6824     236,304  Cmd.exe24-Mar-2004  02:17  5.131.2195.6824   543,504  Crypt32.dll24-Mar-2004  02:17  5.131.2195.6824    61,200  Cryptnet.dll24-Mar-2004  02:17  5.0.2195.6868      76,048  Cryptsvc.dll24-Mar-2004  02:17  5.0.2195.6824     134,928  Dnsapi.dll24-Mar-2004  02:17  5.0.2195.6876      92,432  Dnsrslvr.dll24-Mar-2004  02:17  5.0.2195.6883      47,888  Eventlog.dll24-Mar-2004  02:17  5.0.2195.6898     242,448  Gdi32.dll24-Mar-2004  02:17  5.0.2195.6901     255,248  H323.tsp24-Mar-2004  00:46                        502  Hfsecper.inf17-Mar-2004  21:50                        502  Hfsecupd.inf24-Mar-2004  02:17  5.0.2195.6902     442,640  Ipnathlp.dll24-Mar-2004  02:17  5.0.2195.6890     143,632  Kdcsvc.dll11-Mar-2004  02:37  5.0.2195.6903     210,192  Kerberos.dll24-Mar-2004  02:17  5.0.2195.6897     742,160  Kernel32.dll21-Sep-2003  00:32  5.0.2195.6824      71,888  Ksecdd.sys11-Mar-2004  02:37  5.0.2195.6902     520,976  Lsasrv.dll25-Feb-2004  23:59  5.0.2195.6902      33,552  Lsass.exe24-Mar-2004  02:17  5.0.2195.6898      37,136  Mf3216.dll10-Feb-2004  19:47  5.0.2195.6897      30,160  Mountmgr.sys24-Mar-2004  02:17  5.0.2195.6824      54,544  Mpr.dll24-Mar-2004  02:17  5.0.2195.6905      53,520  Msasn1.dll24-Mar-2004  02:17  5.0.2195.6895     335,120  Msgina.dll24-Mar-2004  02:17  5.0.2195.6901     249,616  Mst120.dll11-Mar-2004  02:37  5.0.2195.6897     123,152  Msv1_0.dll24-Mar-2004  02:17  5.0.2195.6897     312,592  Netapi32.dll24-Mar-2004  02:17  5.0.2195.6891     371,472  Netlogon.dll24-Mar-2004  02:17  5.0.2195.6901      62,224  Nmcom.dll24-Mar-2004  02:17  5.0.2195.6899     497,936  Ntdll.dll24-Mar-2004  02:17  5.0.2195.6896   1,028,880  Ntdsa.dll25-Feb-2004  23:55  5.0.2195.6902   1,699,904  Ntkrnlmp.exe25-Feb-2004  23:55  5.0.2195.6902   1,699,264  Ntkrnlpa.exe25-Feb-2004  23:55  5.0.2195.6902   1,720,064  Ntkrpamp.exe11-Mar-2004  02:37  5.0.2195.6902   1,726,032  Ntoskrnl.exe24-Mar-2004  02:17  5.0.2195.6824     115,984  Psbase.dll24-Mar-2004  02:17  5.0.2195.6892      90,264  Rdpwd.sys24-Mar-2004  02:17  5.0.2195.6897      49,936  Samlib.dll24-Mar-2004  02:17  5.0.2195.6897     388,368  Samsrv.dll24-Mar-2004  02:17  5.0.2195.6893     111,376  Scecli.dll24-Mar-2004  02:17  5.0.2195.6903     253,200  Scesrv.dll11-Mar-2004  02:37  5.1.2195.6899     143,120  Schannel.dll19-Jun-2003  20:05  5.0.2195.6707      17,168  Seclogon.dll24-Mar-2004  02:17  5.0.2195.6894     971,536  Sfcfiles.dll05-Feb-2004  20:18  5.0.2195.6896   5,869,056  Sp3res.dll24-Mar-2004  02:17  1.0.0.4            27,920  Umandlg.dll24-Mar-2004  02:17  5.0.2195.6897     403,216  User32.dll05-Aug-2003  22:14  5.0.2195.6794     385,808  Userenv.dll24-Mar-2004  02:17  5.0.2195.6824      50,960  W32time.dll21-Sep-2003  00:32  5.0.2195.6824      57,104  W32tm.exe11-Mar-2004  02:37  5.0.2195.6897   1,720,368  Win32k.sys12-Dec-2003  21:38  5.1.2600.1327     311,296  Winhttp.dll11-Mar-2004  02:37  5.0.2195.6898     181,520  Winlogon.exe25-Sep-2003  18:08  5.0.2195.6826     243,984  Winsrv.dll24-Mar-2004  02:17  5.131.2195.6824   167,184  Wintrust.dll24-Mar-2004  02:17  5.0.2195.6897     742,160  Kernel32.dll  Uniproc24-Mar-2004  02:17  5.0.2195.6899     497,936  Ntdll.dll     Uniproc11-Mar-2004  02:37  5.0.2195.6897   1,720,368  Win32k.sys    Uniproc25-Sep-2003  18:08  5.0.2195.6826     243,984  Winsrv.dll    Uniproc`

**確認更新的安裝**

如果想確定受影響的系統是否安裝了某個安全性更新，您可以使用 Microsoft Baseline Security Analyzer (MBSA) 工具。這個工具能讓系統管理員掃描本機和遠端系統，判斷是否漏裝了安裝性更新或是有一般安全性設定不當的情形。如需更多有關 MBSA 的資訊，請瀏覽[Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134)網站。

您也可以查看下列的登錄機碼，來確認安全性更新安裝的檔案：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB835732\\Filelist

**附註：**如果管理員或 OEM 將 835732 安全性更新整合 (或 slipstream) 到 Windows 安裝來源檔時，這個登錄機碼可能無法正確建立。

#### Windows NT 4.0 (所有版本)

**必要條件**
這個安全性更新程式需要 Windows NT Workstation 4.0 Service Pack 6a (SP6a)、Windows NT Server 4.0 Service Pack 6a (SP6a) 或 Windows NT Server 4.0 Terminal Server Edition Service Pack 6 (SP6)。

以上所列的軟體版本已經過測試判斷其是否會受到影響。其他版本已不再包含安全性更新支援，同時也不一定會受到影響。[請瀏覽 Microsoft 技術支援週期 準則網站](http://go.microsoft.com/fwlink/?linkid=21742)，以瞭解您的產品及版本的支援生命週期。

如需有關取得最新 Service Pack 的進一步資訊，請參閱 Microsoft 知識庫文件編號 [152734](http://support.microsoft.com/default.aspx?scid=kb;en-us;152734)。

**安裝資訊**

這個安全性更新支援以下的安裝參數：

**/y:** 執行移除 (只使用 /m 或 /q )

**/f**：在關機程序中強制程式結束

**/n**：不建立解除安裝資料夾

**/z**：更新完成後不重新開機

**/q**：使用無訊息或自動安裝模式，無使用者介面(這個參數是 /m 的超集合)

**/m**：使用有使用者介面的自動安裝模式

**/l**：列出已安裝的 Hotfix

**/x**：在不執行安裝程式的情況下解壓縮檔案

**附註**您可以在同一個指令中合併使用這些參數。有關支援的安裝參數的其他資訊，請參閱 Microsoft 知識庫文件編號[262841](http://support.microsoft.com/default.aspx?kbid=262841)。

**部署資訊**

在 Windows NT Server 4.0 上，如想在不需要使用者介入的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windowsnt4server-kb835732-x86-enu /q**

Windows NT Server 4.0 Terminal Server Edition：

**Windowsnt4terminalserver-kb835732-x86-enu /q**

Windows NT Workstation 4.0：

**Windowsnt4workstation-kb835732-x86-enu /q**

在 Windows NT Server 4.0 上，如想在不強制系統重新開機的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windowsnt4server-kb835732-x86-enu /z**

Windows NT Server 4.0 Terminal Server Edition：

**Windowsnt4terminalserver-kb835732-x86-enu /z**

Windows NT Workstation 4.0：

**Windowsnt4workstation-kb835732-x86-enu /z**

如想進一步瞭解如何透過「軟體更新服務」部署這個安全性更新，請瀏覽 [軟體更新服務](http://www.microsoft.com/windowsserversystem/sus/susoverview.mspx)網站。

**重新開機需求**

套用此安全性更新程式之後，您必須重新啟動系統。

**移除資訊**

若要移除此安全性更新，請使用 \[控制台\] 中的 \[新增/移除程式\]。

系統管理員可使用 Hotfix.exe 公用程式來移除此安全性更新。Hotfix.exe 公用程式位於 %Windir%\\$NTUninstallKB835732$ 資料夾中。Hotfix.exe 公用程式支援以下的安裝參數：

**/y**:**執行移除(只使用 /m 或 /q 參數)**

**/f**：**在關機程序中強制程式結束**

**/n**：**不建立解除安裝資料夾**

**/z**：**安裝完成時，不重新啟動**

**/q**：**使用無訊息或自動安裝模式，無使用者介面 (這個參數是 /m 參數的超集合)**

**/m**：**使用有使用者介面的自動安裝模式**

**/l**：**列出已安裝的 Hotfix**

**檔案資訊**

本更新程式的英文版本具有下表列出的檔案屬性 (或更新的版本)。這些檔案的日期及時間均使用 Coordinated Universal Time (UTC)。當您檢視檔案資訊時，它會轉換為當地時間。如想知道 UTC 及當地時間的時差，請使用 \[控制台\] 內的 \[日期/時間\] 工具的 **\[時區\] 索引標籤。**

**注意**日期和時間資訊可能會在安裝時有所變更。您應該使用版本、大小及檔案名稱資訊來判斷檔案的正確性。

Windows NT Workstation 4.0

`日期           時間      版本                大小       檔案名稱    資料夾--------------------------------------------------------------------24-Jan-2004  00:12  5.131.1880.14     465,680  Crypt32.dll25-Sep-2002  21:36  5.0.1558.6072      90,384  Cryptdlg.dll12-Dec-2003  00:10  5.131.1878.14     440,080  Cryptui.dll27-Feb-2004  16:43  4.0.1381.7263     205,584  Gdi32.dll23-Feb-2004  15:13  4.0.1381.7263      40,720  Mf3216.dll05-Mar-2004  23:59  5.0.2195.6905      53,520  Msasn1.dll28-Feb-2004  01:31  5.131.1880.14      37,136  Mscat32.dll09-Jan-2004  15:40  4.0.1381.7255     125,200  Msgina.dll07-Jan-2003  02:22  5.131.1878.13      28,432  Mssip32.dll18-Mar-2004  10:20  4.0.1381.7265     958,336  Ntkrnlmp.exe18-Mar-2004  10:20  4.0.1381.7265     937,984  Ntoskrnl.exe25-Oct-2003  01:13  4.86.1964.1880    143,632  Schannel.dll12-Dec-2003  22:24  5.131.1880.14       6,928  Softpub.dll27-Feb-2004  16:43  4.0.1381.7255     326,928  User32.dll07-Jan-2004  10:47  4.0.1381.7255   1,255,152  Win32k.sys27-Feb-2004  16:43  4.0.1381.7260     174,864  Winsrv.dll19-Feb-2004  17:50  5.131.1880.14     165,648  Wintrust.dll25-Oct-2003  01:13  4.87.1964.1880    112,912  Schannel.dll 128bit`

Windows NT Server 4.0：

`日期          時間      版本                大小       檔案名稱    資料夾-----------------------------------------------------------------------24-Jan-2004  00:12  5.131.1880.14     465,680  Crypt32.dll25-Sep-2002  21:36  5.0.1558.6072      90,384  Cryptdlg.dll12-Dec-2003  00:10  5.131.1878.14     440,080  Cryptui.dll27-Feb-2004  16:43  4.0.1381.7263     205,584  Gdi32.dll23-Feb-2004  15:13  4.0.1381.7263      40,720  Mf3216.dll05-Mar-2004  23:59  5.0.2195.6905      53,520  Msasn1.dll28-Feb-2004  01:31  5.131.1880.14      37,136  Mscat32.dll09-Jan-2004  15:40  4.0.1381.7255     125,200  Msgina.dll07-Jan-2003  02:22  5.131.1878.13      28,432  Mssip32.dll18-Mar-2004  10:20  4.0.1381.7265     958,336  Ntkrnlmp.exe18-Mar-2004  10:20  4.0.1381.7265     937,984  Ntoskrnl.exe25-Oct-2003  01:13  4.86.1964.1880    143,632  Schannel.dll12-Dec-2003  22:24  5.131.1880.14       6,928  Softpub.dll27-Feb-2004  16:43  4.0.1381.7255     326,928  User32.dll07-Jan-2004  10:47  4.0.1381.7255   1,255,152  Win32k.sys27-Feb-2004  16:43  4.0.1381.7260     174,864  Winsrv.dll19-Feb-2004  17:50  5.131.1880.14     165,648  Wintrust.dll25-Oct-2003  01:13  4.87.1964.1880    112,912  Schannel.dll  128 Bit`

Windows NT Server 4.0 Terminal Server Edition：

`日期           時間      版本                大小       檔案名稱    資料夾-----------------------------------------------------------------------24-Jan-2004  00:12  5.131.1880.14     465,680  Crypt32.dll25-Sep-2002  21:36  5.0.1558.6072      90,384  Cryptdlg.dll12-Dec-2003  00:10  5.131.1878.14     440,080  Cryptui.dll24-Feb-2004  18:25  4.0.1381.33562    206,096  Gdi32.dll24-Feb-2004  18:25  4.0.1381.33562     40,208  Mf3216.dll05-Mar-2004  23:59  5.0.2195.6905      53,520  Msasn1.dll28-Feb-2004  01:31  5.131.1880.14      37,136  Mscat32.dll09-Jan-2004  15:41  4.0.1381.33559    208,656  Msgina.dll07-Jan-2003  02:22  5.131.1878.13      28,432  Mssip32.dll18-Mar-2004  11:44  4.0.1381.33563  1,004,160  Ntkrnlmp.exe18-Mar-2004  11:44  4.0.1381.33563    983,104  Ntoskrnl.exe25-Oct-2003  01:13  4.86.1964.1880    143,632  Schannel.dll12-Dec-2003  22:24  5.131.1880.14       6,928  Softpub.dll19-Aug-2003  13:58  4.0.1381.33552    332,048  User32.dll26-Jan-2004  16:59  4.0.1381.33559  1,280,816  Win32k.sys16-Dec-2003  17:56  4.0.1381.33559    196,368  Winsrv.dll19-Feb-2004  17:50  5.131.1880.14     165,648  Wintrust.dll25-Oct-2003  01:13  4.87.1964.1880    112,912  Schannel.dll 128bit`

**確認更新的安裝**

如果想確定受影響的系統是否安裝了某個安全性更新，您可以使用 Microsoft Baseline Security Analyzer (MBSA) 工具。這個工具能讓系統管理員掃描本機和遠端系統，判斷是否漏裝了安裝性更新或是有一般安全性設定不當的情形。如需更多有關 MBSA 的資訊，請瀏覽[Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134)網站。

您也可以查看下列的登錄機碼，來確認安全性更新安裝的檔案：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Hotfix\\KB835732\\File 1

**附註**如果管理員或 OEM 將 835732 安全性更新整合 (或 slipstream) 到 Windows 安裝來源檔時，這個登錄機碼可能無法正確建立。

### 其他資訊

**取得其他安全性更新：**

其他安全性議題的更新可由下列地點取得：

-   安全性更新可以從 [Microsoft 下載中心](http://www.microsoft.com/downloads/search.asp?search=keyword&value='security_patch'&opsysid=1) 取得，也可以利用 security\_patch 關鍵字搜尋輕易地找到。
-   使用者平台的更新可以在 [WindowsUpdate](http://go.microsoft.com/fwlink/?linkid=21130) 網站取得。

**支援**

-   美國及加拿大地區客戶可電洽 1-866-PCSAFETY [Microsoft 產品支援服務](http://go.microsoft.com/fwlink/?linkid=21131)以取得技術支援。 與安全性更新有關的支援電話不另外收費。
-   不同國家的客戶，可以從當地的 Microsoft 分公司取得支援。與安全性更新有關的支援電話不另外收費。關於如何連絡 Microsoft 技術支援的資訊，請造訪[世界各地技術支援網站](http://go.microsoft.com/fwlink/?linkid=21155)。

**Windows 安全性資源：**

-   [Microsoft TechNet 安全性](http://www.microsoft.com/technet/security/default.asp) 網站提供了有關 Microsoft 產品安全性的其他資訊。
-   [Microsoft 軟體更新服務](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   Windows Update 目錄：請參閱知識庫文件編號 [323166](http://support.microsoft.com/default.aspx?scid=kb;en-us;323166) ，以取得更多關於 Windows Update 類別目錄的資訊。
-   [Office Update](http://office.microsoft.com/zh-tw/officeupdate/default.aspx)

**Software Update Services (SUS)：**

Microsoft Software Update Services (SUS) 能讓客戶以迅速可靠的方式，針對 Windows® 2000 和 Windows Server™ 2003 伺服器以及執行 Windows 2000 Professional 或 Windows XP Professional 的桌面系統部署最新的重要更新程式及安全性更新程式。

如想瞭解如何透過「軟體更新服務」部署這個安全性更新，請瀏覽[軟體更新服務](http://go.microsoft.com/fwlink/?linkid=21133)網站。

**Systems Management Server (SMS):**

Systems Management Server 可以用來協助部署這個安全性更新。如需更多有關 Systems Management Server 的資訊，請瀏覽 [SMS 網站](http://www.microsoft.com/taiwan/smserver/)。SMS 也提供一些額外的工具，例如 [SMS 2.0 Software Update Services Feature Pack](http://go.microsoft.com/fwlink/?linkid=21157) (英文) 及 [SMS 2.0 Administration Feature Pack](http://www.microsoft.com/taiwan/smserver/downloads/2003/adminpack.htm)，能協助系統管理員部署安全性更新。SMS 2.0 Software Update Services Feature Pack 能使用 Microsoft Baseline Security Analyzer 及 Microsoft Office Detection Tool，為安全性公告更新作業提供相當廣泛的支援。某些軟體更新程式在電腦重新啟動之後，會需要用到系統管理員的權限。

**注意：** SMS 2.0 Software Update Services Feature Pack 的編制清查能力，可以用來判斷特定系統所需安裝的更新程式，而 SMS 2.0 Administration Feature Pack 的 Elevated Rights Deployment Tool 則能夠用來進行安裝的作業。對於需要使用 Systems Management Server 來判斷安裝目標的更新，以及重新啟動系統之後需要管理員權限的更新而言，如此會是最佳的部署方式。

**免責聲明：**

Microsoft 知識庫 (Microsoft Knowledge Base) 中的資訊係按「現狀」提供，並不提供任何保證。不論明示或暗示，Microsoft 不作任何責任擔保，包括適售性以及適合特定用途之擔保責任。無論任何情況下的損害，Mi crosoft Corporation 及其供應商皆不負任何法律責任，包括直接、間接、偶發意外、推衍引發、業務利潤損失或特殊損害。即使 Microsoft corporation 及其供應商已被告知此類損害的可能性亦不負任何責任。某些地區並不允許排除及限制推衍後果或意外損害責任，因此前述限制不適用於這些地區。

**修訂：**

-   V1.0 (2004 年 4 月 13 日)：公告發行
-   V1.1 (2004 年 4 月 21 日)：更新公告中＜安全性更新取代資訊＞的內容。在常見問題集的部份中，也記錄了 MBSA 偵測行為的變更情形。此外，公告也同時包含「公用程式管理員弱點 (CAN-2003-0908)」替代解決方案的一些修訂資訊。
-   V1.2 (2004 年 4 月 28 日)：＜警告＞的部份已有所更新，提供 Microsoft 知識庫文件編號 835732 的發行訊息。本文件包含了使用者在安裝此安全性更新時可能會遇到的一些已知問題。本文章同時也包含這些問題的建議解決方法。
-   V1.3 (2004 年 5 月 4 日)：加入有關 LSASS 弱點替代解決方案的新資訊。
-   V2.0 (2004 年 6 月 15 日)：更新公告在於對泛中文版的 Windows NT 4.0 Workstation 更新提出通知。裝有原始更新的客戶也應該安裝此更新。

*Built at 2014-04-18T01:50:00Z-07:00*

---
TOCTitle: 'MS04-012'
Title: 'Microsoft Security Bulletin MS04-012 - 重大'
ms:assetid: 'ms04-012'
ms:contentKeyID: 61237351
ms:date: '04/18/2014'
ms:mtpsurl: 'https://technet.microsoft.com/zh-TW/library/ms04-012(v=Security.10)'
---

Security Bulletin

Microsoft Security Bulletin MS04-012 - 重大
===========================================

Microsoft RPC/DCOM (828741) 的累積更新程式
------------------------------------------

發行: 2004年4月13日 | 更新: 2004年4月21日

**發佈日期：**2004 年 4 月 14 日
**更新日期：**2006 年 8 月 14 日
**版本：** 1.0

#### 摘要

**應該閱讀此文件的對象：**使用 Microsoft® Windows® 的客戶

**這個弱點的影響：**遠端執行程式碼

**最高的嚴重性等級：**重大

**建議：**客戶應立即套用此更新程式。

**安全性更新取代資訊：** 本公告會取代數個先前發行的安全性更新程式。請參閱本公告的＜常見問題集＞以查看完整的清單。

**警告：**無

**已測試軟體及安全性更新下載位置：**

**受影響的軟體：**

-   Microsoft Windows NT Workstation 4.0 Service Pack 6a — [英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=4acb5bd6-a0bf-40bc-8955-d833923642ef&displaylang=en) │ [中文下載更新程式](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=4acb5bd6-a0bf-40bc-8955-d833923642ef)
-   Microsoft Windows NT Server 4.0 Service Pack 6a — [英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=d4f2ad32-fe74-4da1-aeae-80897ac86720&displaylang=en) │ [中文下載更新程式](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-tw&familyid=d4f2ad32-fe74-4da1-aeae-80897ac86720)
-   Microsoft Windows NT Server 4.0 Terminal Server Edition Service Pack 6 — [英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=5b29e35d-e5da-4486-b7eb-d54c7398142c&displaylang=en)
-   Microsoft Windows 2000 Service Pack 2, Microsoft Windows 2000 Service Pack 3, and Microsoft Windows 2000 Service Pack 4 — [英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=fbd38c36-d1d3-47a2-a5d5-6c8f27fdcc40&displaylang=en) │ [中文下載更新程式](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-tw&familyid=fbd38c36-d1d3-47a2-a5d5-6c8f27fdcc40)
-   Microsoft Windows XP and Microsoft Windows XP Service Pack 1 — [英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=d488bbbb-da77-448d-8ff0-0a649a0d8fc3&displaylang=en) │ [中文下載更新程式](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-tw&familyid=d488bbbb-da77-448d-8ff0-0a649a0d8fc3)
-   Microsoft Windows XP 64-Bit Edition Service Pack 1 — [英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=4c3ed21d-ff40-4c9d-99dd-1632e43c1645&displaylang=en)
-   Microsoft Windows XP 64-Bit Edition Version 2003 — [英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=75a08528-5e99-4be0-8e97-f1c9789611eb&displaylang=en)
-   Microsoft Windows Server 2003 — [英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=07317ce9-520d-4574-b575-5fb85da9a4d7&displaylang=en) │ [中文下載更新程式](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-tw&familyid=07317ce9-520d-4574-b575-5fb85da9a4d7)
-   Microsoft Windows Server 2003 64-Bit Edition — [英文下載更新程式](http://www.microsoft.com/downloads/details.aspx?familyid=75a08528-5e99-4be0-8e97-f1c9789611eb&displaylang=en)
-   Microsoft Windows 98, Microsoft Windows 98 Second Edition (SE) and Microsoft Windows Millennium Edition (ME) — Review the FAQ section of this bulletin for details about these operating systems

Microsoft Windows 98、Microsoft Windows 98 Second Edition (SE) 和 Microsoft Windows Millennium Edition (ME) - 請參閱＜常見問題集＞中有關這些作業系統的詳細資訊。

**已測試的 Microsoft Windows 元件：**

**受影響的元件：**

-   Microsoft Jet 資料庫引擎 4.0 版

以上所列的軟體版本已經過測試判斷其是否會受到影響。其他版本已不再包含安全性更新支援，同時也不一定會受到影響。請瀏覽 [Microsoft 技術支援週期準則](http://go.microsoft.com/fwlink/?linkid=21742)網站，以瞭解您的產品及版本的支援生命週期。

### 一般資訊

詳細技術資訊
------------

<span></span>
**提要：**

本次更新能解決一些 RPC/DCOM 中最新發現的弱點。本公告會分節說明各項弱點的相關資訊。

成功利用其中最嚴重弱點的攻擊者，可以取得受影響系統的完整控制權。一旦攻擊得逞，攻擊者將能在系統上進行任何動作，包括安裝程式、檢視變更或刪除資料，或建立具備完整權限的新帳戶。

Microsoft 建議客戶應該立即套用此更新程式。

**嚴重性等級和弱點識別碼：**

| 弱點識別碼                                                                                                                         | 這個弱點的影響 | Windows 98、SE、ME | Windows NT Workstation 4.0 | Windows NT Server 4.0 | Windows NT Server 4.0 Terminal Server Edition | Windows 2000 | Windows XP | Windows Server 2003 |
|------------------------------------------------------------------------------------------------------------------------------------|----------------|--------------------|----------------------------|-----------------------|-----------------------------------------------|--------------|------------|---------------------|
| RPC Runtime 函式庫弱點 - [CAN-2003-0813](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0813)                          | 遠端執行程式碼 | 無                 | 無                         | 無                    | 無                                            | 重大         | 重大       | 重大                |
| RPCSS 服務弱點 - [CAN-2004-0116](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0116)                                  | 拒絕服務       | 無                 | 無                         | 無                    | 無                                            | 重要         | 重要       | 重要                |
| COM Internet Service (CIS) – RPC over HTTP 弱點 - [CAN-2003-0807](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0807) | 拒絕服務       | 無                 | 無                         | 低                    | 低                                            | 低           | 無         | 低                  |
| 物件識別弱點 - [CAN-2004-0124](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0124)                                    | 資訊洩漏       | 低                 | 低                         | 低                    | 低                                            | 低           | 低         | 低                  |
| **所有弱點的彙總嚴重性**                                                                                                           |                | **非重大**         | **低**                     | **低**                | **低**                                        | **重大**     | **重大**   | **重大**            |

以上[評估](http://technet.microsoft.com/security/bulletin/rating)的根據包括：受弱點影響的系統類型、系統的一般部署模式，以及利用弱點對系統所造成的影響後果。

與本安全性更新相關的常見問題集
------------------------------

<span></span>
**這次發行的更新程式取代了哪些更新？**
本安全性更新取代了數個先前發行的安全性公告。下表列出受影響的安全性公告編號及相關的作業系統。

| 公告編號                                                                        | Windows NT 4.0 | Windows 2000 | Windows XP | Windows Server 2003 |
|---------------------------------------------------------------------------------|----------------|--------------|------------|---------------------|
| [**MS98-014**](http://technet.microsoft.com/security/bulletin/ms98-014)         | 取代           | 不適用       | 不適用     | 不適用              |
| [**MS00-066**](http://technet.microsoft.com/security/bulletin/ms00-066)         | 不適用         | 取代         | 不適用     | 不適用              |
| [**MS01-048**](http://technet.microsoft.com/security/bulletin/ms01-048)         | 取代           | 不適用       | 不適用     | 不適用              |
| [**MS03-010**](http://www.microsoft.com/taiwan/security/bulletins/ms03-010.asp) | 不適用         | 取代         | 取代       | 不適用              |
| [**MS03-026**](http://www.microsoft.com/taiwan/security/bulletins/ms03-026.asp) | 取代           | 取代         | 取代       | 取代                |
| [**MS03-039**](http://www.microsoft.com/taiwan/security/bulletins/ms03-039.asp) | 取代           | 取代         | 取代       | 取代                |

**這是累積的安全性更新嗎？**
是的。這個累積安全性更新包含上表中所有先前的 RPC/DCOM 更新。

**Windows 98、Windows 98 Second Edition 和 Windows Millennium Edition 的延伸支援服務，對於針對這些作業系統發行的安全性更新有什麼影響？**
Microsoft 僅會針對重大安全性問題發行安全性更新。在支援服務期間，不會對非重大安全性的問題提供安全性更新。如想瞭解這些作業系統的 Microsoft 技術支援週期準則，請瀏覽這個[網站](http://support.microsoft.com/default.aspx?pr=lifean1)。

如需更多有關這些嚴重性等級的資訊，請參閱此[網站](http://technet.microsoft.com/security/bulletin/rating)。

**本安全性公告所提到的弱點，是否會對 Windows 98、Windows 98 Second Edition 或 Windows Millennium Edition 帶來重大的影響？**
不會。這些弱點都不會對 Windows 98、Windows 98 Second Edition 或 Windows Millennium Edition 造成任何重大的影響。

**是否能使用 Microsoft Baseline Security Analyzer (MBSA) 來判斷是否需要此更新？**
可以。MBSA 能判斷是否需要此更新程式。如需有關 MBSA 的進一步資訊，請參閱 [MBSA 網站](http://go.microsoft.com/fwlink/?linkid=21134)。

**是否能使用 Systems Management Server (SMS) 來判斷是否需要此更新？**
可以。SMS 能協助偵測及部署本安全性更新。如需關於 SMS 的詳細資訊，請瀏覽 [SMS 網站](http://www.microsoft.com/taiwan/smserver/default.htm)。

**何謂遠端程序呼叫 (RPC，Remote Procedure Call)？**
[遠端程序呼叫](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/rpc/rpc/how_rpc_works.asp) (RPC) 是 Windows 作業系統所使用的通訊協定。RPC 提供程序間的通訊機制，讓某個作業系統中執行的程式能順利地存取另一個作業系統上的服務。通訊協定是衍生於開放軟體基金會 (OSF，Open Software Foundation) RPC 通訊協定，但是加入了一些 Microsoft 特有的擴充功能。

弱點詳細資訊
------------

<span></span>
#### RPC Runtime 函式庫弱點 - CAN-2003-0813：

當蓄意製作的訊息經由 RPC Runtime 函式庫處理時，[競爭情形](http://technet.microsoft.com/security/bulletin/glossary)的情況會導致遠端執行程式碼的弱點。成功利用此弱點的攻擊者可以取得受影響系統的完整控制權。不過，在大多數可能的攻擊情境中，這個問題均屬於[拒絕服務](http://technet.microsoft.com/security/bulletin/glossary)的類型。

#### RPC Runtime 函式庫弱點 - CAN-2003-0813 緩和因素：

-   防火牆的最佳實務作法與標準的預設防火牆組態，都有助於保護網路免於遭受企業外部發動之攻擊的威脅。最佳的實務作法建議，是讓任何會連線至網際網路的系統僅開放最少量的連接埠。

#### RPC Runtime 函式庫弱點 - CAN-2003-0813 替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

-   使用[網際網路連線防火牆](http://www.microsoft.com/security/protect/windowsxp/firewall.asp)之類的個人防火牆 (Windows XP 和 Windows Server 2003 中有提供)。

    使用 Windows XP 或 Windows Server 2003 中的網際網路防火牆來保護網際網路連線時，它會預設封鎖所有來源不明的網際網路內送傳輸。Microsoft 建議封鎖所有來源不明的網際網路內送傳輸。

    如要使用「網路安裝精靈」啟用「網際網路連線防火牆」，請依照下列步驟進行：

    1.  按一下 \[開始\]，然後按一下 \[控制台\]。
    2.  在預設類別檢視中，按一下 \[網路和網際網路連線\]，再按一下 \[設定或變更您的家用或小型辦公室網路\]。當您在「網路設定精靈」中選擇系統已直接連線網際網路的設定時，\[網際網路連線防火牆\] 功能就會啟用。

    若要手動設定用於連線的「網際網路連線防火牆」，請依照下列步驟進行：

    1.  按一下 \[開始\]，然後按一下 \[控制台\]。
    2.  在預設類別檢視中，按兩下 \[網路和網際網路連線\]，然後再按 \[網路連線\]。
    3.  在想要啟用「網際網路連線防火牆」的連線上按右鍵，再按一下 \[內容\]。
    4.  按一下 \[進階\] 索引標籤。
    5.  核選 \[以限制或防止來自網際網路對這台電腦的存取來保護我的電腦和網路\] 核取方塊，再按 \[確定\]。

    **注意：**如果您想讓部份程式及服務仍然能透過防火牆使用，請按 \[進階\] 索引標籤上的 \[設定\]，再選擇程式、通訊協定及需要的服務。

-   **在防火牆上封鎖下列連接埠：**

    -   **UDP 連接埠 135、137、138 和 445，以及 TCP 連接埠 135、139、445 和 593**
    -   **所有在 1024 以上連接埠收到的來源不明內送傳輸**
    -   **所有其他特殊設定的 RPC 連接埠**
    -   **聆聽 80 和 443 連接埠的 COM Internet Service (CIS) 或 RPC over HTTP (如果有安裝的話)**

    這些連接埠是用來對 RPC 的連線進行初始化。在防火牆上阻擋這些連接埠，將有助於避免攻擊者嘗試利用這個弱點，對防火牆之後的系統進行攻擊。同時您也應該要阻擋遠端系統上其他經過特別設定的 RPC 通訊埠。Microsoft 建議您封鎖所有來源不明的網際網路內送傳輸，如此將有助於避免可能使用其他連接埠的攻擊手段。如需 PRC 所使用連接埠的詳細資訊，請參訪下面的[網站](http://www.microsoft.com/resources/documentation/windows/2000/server/reskit/en-us/tcpip/part4/tcpappc.mspx)。如需有關如何停用 CIS 的進一步資訊，請參閱 Microsoft 知識庫文件編號 [825819](http://support.microsoft.com/default.aspx?kbid=825819)。

-   **如果系統能支援進階 TCP/IP 篩選功能，就啟用該項功能。**

    您可以啟用進階的 TCP/IP 篩選功能，封鎖所有不請自來的內送傳輸。如需有關設定 TCP/IP 篩選功能的其他資訊，請參閱 Microsoft 知識庫文件編號 [309798](http://support.microsoft.com/default.aspx?kbid=309798)。

-   **在受影響的系統上，使用 IPSec 阻擋受影響的連接埠。**

    使用 Internet Protocol Security (IPSec) 來保障網路的通訊安全。如需有關 IPSec 以及如何套用篩選器之詳細資訊，請參閱 Microsoft 知識庫文件 [313190](http://support.microsoft.com/default.aspx?kbid=313190) 及 [813878](http://support.microsoft.com/default.aspx?kbid=813878)。

#### RPC Runtime 函式庫弱點 - CAN-2003-0813 常見問題集：

**這個弱點的範圍為何？**
這是[競爭情形](http://technet.microsoft.com/security/bulletin/glossary)的弱點。一旦攻擊得逞，攻擊者將能在遠端取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。不過，競爭情形的狀況是難以預期的。在大多數可能的攻擊情境中，這個問題是屬於[拒絕服務](http://technet.microsoft.com/security/bulletin/glossary)的類型。

**造成這個弱點的原因為何？**
當 RPC Runtime 函式庫處理蓄意製作的訊息時，可能會導致[競爭情形](http://technet.microsoft.com/security/bulletin/glossary)。

**何謂 RPC Runtime 函式庫？**
依照預設，RPC Runtime 函式庫會安裝在所有受影響的系統中，為應用程式開發人員提供通訊、目錄或安全性服務。如需 RPC Runtime 函式庫的詳細資訊，請瀏覽 [Microsoft Developer Network (MSDN) 網站](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/rpc/rpc/developing_32_bit_windows_applications.asp)。

**RPC Runtime 函式庫發生了什麼問題？**
當兩個不同的系統執行緒在特定時段內試圖處理蓄意製作的訊息時，就可能會產生 RPC Runtime 函式庫弱點。由於這個事件取決於兩個系統執行緒的相對執行時間，因此算是競爭情形。這個競爭情形可能會造成 RPC Runtime 函式庫不正確地修改內部資料結構，因此受影響的系統可能會發生難以預期的行為。

**何謂競爭情形？**
[競爭情形](http://technet.microsoft.com/security/bulletin/glossary)的形成取決於多執行緒作業系統和軟體中的事件相對執行時間，想要利用這種方法執行程式碼攻擊通常並不容易。如需更多有關競爭情形的資訊，請參閱 [MSDN 網站](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconmanagedthreadingbestpractices.asp)。如需瞭解競爭情形的概略定義，請瀏覽 。

**為什麼競爭情形會造成安全性弱點？**
這種競爭情形可能會造成一種狀況，讓一連串有特殊時間限制的要求造成 RPC Runtime 函式庫執行無法預期的動作。不過由於每次導致競爭情形產生的情形都會有所不同，因此對攻擊者而言，要利用這個弱點可能也並非易事。

**攻擊者可能會利用這項弱點採取什麼動作？**
這個弱點可能會允許攻擊者遠端執行程式碼。一旦攻擊得逞，攻擊者將能取得受影響系統完整的控制權，包括安裝程式、檢視變更或刪除資料，或建立擁有完整權限的新帳戶。不過，競爭情形的狀況是難以預期的。在大多數可能的攻擊情境中，這個問題是屬於[拒絕服務](http://technet.microsoft.com/security/bulletin/glossary)的類型。

**誰可以利用這項弱點？**
任何能夠將蓄意製作的訊息傳送到受影響系統上的匿名使用者，都可以利用這些弱點。這項功能在受影響的系統上預設為啟動，因此任何使用者，只要可以連線至受影響的系統，都可以嘗試利用這項弱點來發動攻擊。

**攻擊者如何利用這個弱點？**
攻擊者會蓄意設計一系列的網路訊息、並將它們傳送給受影響的系統，再伺機利用此弱點來發動攻擊。這些訊息會導致受影響的系統執行程式碼。

攻擊者可以透過其他方式存取受到影響的元件，像是以互動方式登入系統，或是使用另一個應用程式以本機或遠端方式將參數傳送至防備不周延的元件中。

**更新的作用何在？**
本更新程式可以修改 RPC Runtime 函式庫處理上述訊息的執行緒同步處理方式，以解決這個弱點。

#### RPCSS 服務弱點 - CAN-2004-0116：

RPCSS 服務具有一項[拒絕服務](http://technet.microsoft.com/security/bulletin/glossary)的弱點。當 RPCSS 服務收到蓄意製作的訊息時，服務可能無法重新取得記憶體，因而造成拒絕服務的情況。

#### RPCSS 服務弱點的緩和因素：

-   防火牆的最佳實務作法與標準的預設防火牆組態，都有助於保護網路免於遭受企業外部發動之攻擊的威脅。最佳的實務作法建議，是讓任何會連線至網際網路的系統僅開放最少量的連接埠。

#### RPCSS 服務弱點的替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

針對[825750RPC Runtime 函式庫弱點 - CAN-2003-0813](http://www.microsoft.com/taiwan/security/bulletins/ms04-012.asp) 列出的替代解決方案，也適用於這項弱點。此外，以下的替代的解決方案也適用：

-   **停用所有受影響系統的 DCOM。**

    當系統是網路的一部份時，DCOM 有線通訊協定會讓系統上的 COM 物件能與其他系統上的 COM 物件進行通訊。您可以停用特定系統上的 DCOM，以協助保護不受此弱點影響，但如此一來將會停用該系統的物件與其他系統物件間的所有通訊。

    如需有關如何停用 DCOM 的進一步資訊，請參閱 Microsoft 知識庫文件編號 [825750](http://support.microsoft.com/default.aspx?kbid=825750)。

    如果安裝了 COM Internet Services (CIS) 或 RPC over HTTP，Microsoft 也建議您停止轉遞至 DCOM。如需更多資訊，請參閱 Microsoft 知識庫文件編號 [826382](http://support.microsoft.com/default.aspx?kbid=826382)。

    **注意：**在 Windows 2000 中，這個方法只適用於執行 Service Pack 3 (含) 以上的系統。使用 Service Pack 2 (含) 以下的客戶必須升級為較新的 Service Pack，或是使用其他的替代解決方案。

    **使用替代的解決方案所受的影響：**如果停用遠端系統上的 DCOM，您以後將無法以遠端存取該系統的方式重新啟用 DCOM。若要重新啟用 DCOM，您必須實際存取該系統。

#### RPCSS 服務弱點常見問題集：

**這個弱點的範圍為何？**
這是[拒絕服務](http://www.microsoft.com/technet/security/bulletin/glossary.asp)的弱點。利用這個弱點的攻擊者會傳送蓄意製作的訊息到 RPCSS，造成 RPCSS 服務停止回應並使得受影響的系統自動重新開機。

Note that the denial of 服务漏洞 would not allow attackers to execute code or elevate their privileges, but it could cause the affected system to stop accepting requests.

**造成這個弱點的原因為何？**
RPCSS 服務用來檢查訊息輸入的處理程序在某些情況下會造成這個弱點。

**何謂 DCOM？**
分散式元件物件模型 (DCOM，Distributed Component Object Model) 是能夠讓軟體元件在網路上直接進行通訊的協定。DCOM 先前稱為「Network OLE」，其設計目的是用來在多重網路之間進行傳輸，包括 HTTP 等網際網路通訊協定。如需 DCOM 的詳細資訊，請瀏覽這個[網站](http://www.microsoft.com/com/tech/dcom.asp)。

**RPCSS 服務出了什麼問題？**
RPCSS 服務在 DCOM 啟動方面具有一項弱點，可能造成受影響的系統因為不正確地處理蓄意製作的訊息而失敗。這個錯誤會對用來啟動 DCOM 的基礎 RPCSS 服務造成影響。RPSCSS 服務會傾聽 UDP 135、137、138、445 連接埠以及 TCP 135、139、445、593 連接埠。此外，如果啟用了 CIS 或 RPC over HTTP，DCOM 也可以傾聽 80 和 443 連接埠。

攻擊者可以利用傳送蓄意製作的 RPC 訊息，造成遠端系統上的 RPCSS 服務失敗，導致拒絕服務的情形。

**攻擊者可能會利用這項弱點採取什麼動作？**
一旦攻擊得逞，攻擊者將能造成 RPCSS 服務停止回應，並使得受影響的系統自動重新開機。在 Windows NT 4.0 上則能造成 RPCSS 服務停止回應，不過這種行為不會讓系統自動重新開機。接下來您必須為受影響的 Windows NT 4.0 系統手動重新開機。

**誰可以利用這項弱點？**
任何匿名使用者，只要可以將蓄意設計的 RPC 訊息傳送到受影響系統，都可以利用這項弱點來發動攻擊。

**攻擊者如何利用這個弱點？**
利用這個弱點的攻擊者會透過受影響的 TCP/UDP 通訊埠，傳送蓄意製作的 RPC 訊息到受影響的系統上，. 當受影響的系統收到這樣的訊息時，可能會造成 RPCSS 服務停止回應以及系統自動重新開機。

攻擊者可以透過其他方式存取受到影響的元件，像是以互動方式登入系統，或是使用另一個應用程式以本機或遠端方式將參數傳送至防備不周延的元件中。

**更新的作用何在？**
本更新程式修改了 RPCSS 服務驗證傳入訊息的方式，因此可以消除這項弱點。

#### COM Internet Service (CIS) - RPC Over HTTP 弱點 - CAN-2003-0807：

CIS 和 RPC over HTTP Proxy 元件中具有一項[拒絕服務](http://technet.microsoft.com/security/bulletin/glossary)弱點。當轉送到後端系統的要求通過元件時，攻擊者可能會以蓄意製作的訊息回覆要求，造成元件停止接受要求。

#### COM Internet Service (CIS) 以及 RPC over HTTP 弱點的緩和因素：

依預設值，受影響的作業系統都不會受到弱點的影響。只有當系統管理員啟用受影響的元件或是受影響的組態設定後，系統才會有受到這項攻擊的危險。如需進一步瞭解受影響的組態設定發生的原因，請參閱＜常見問題集＞。

#### COM Internet Service (CIS) 以及 RPC over HTTP 弱點的替代解決方案：

Microsoft 已經測試過以下的替代解決方案。這些替代的解決方案並不能徹底解決弱點，但是有助於封鎖已知的攻擊行為。如果替代的解決方案會降低功能，功能降低的情況將會描述於下方。

針對 [RPC Runtime 函式庫弱點 - CAN-2003-0813](http://www.microsoft.com/taiwan/security/bulletins/ms04-012.asp) 列出的替代解決方案，也適用於這項弱點。此外，以下的替代的解決方案也適用：

-   **在受影響的系統上，將 COM Internet Service (CIS) 與 RPC over HTTP 對於不信任來源的轉送功能停用 (如果這些功能已經手動開啟)。**
    -   如果系統管理員已經在 Windows NT 4.0 或 Windows 2000 上安裝並啟用了對於不信任伺服器的 CIS 轉送功能，請確認 CIS 和 RPC over HTTP 都設為僅允許轉送到信任的伺服器。
    -   如果系統管理員已經在 Windows Server 2003 上進行了 RPC over HTTP 設定，請確認 RPC over HTTP 並非在 IIS 5 相容模式下執行。預設的 IIS 6.0 模式並沒有這個弱點，因此建議使用預設的模式。如需有關部署建議及組態設定的詳細資訊，請瀏覽 [MSDN 網站](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/rpc/rpc/rpc_over_http_deployment_recommendations.asp)。

        **注意：**Microsoft 建議系統管理員也停用 DCOM 轉送功能，如需更多資訊，請參閱 Microsoft 知識庫文件編號 [826382](http://support.microsoft.com/default.aspx?kbid=826382)。

-   **如果您不需要使用 CIS 或 RPC over HTTP，請在會受影響的系統上停用這項功能。**
    -   如需關於停用 CIS 的詳細資訊，請參閱 Microsoft 知識庫文件編號 [825819](https://technet.microsoft.com/zh-TW/library///support.microsoft.com/default.aspx?kbid=825819(v=Security.10))。
    -   如需 RPC over HTTP 的詳細資訊，請瀏覽 [MSDN 網站](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/rpc/rpc/rpc_over_http_security.asp)。

#### COM Internet Service (CIS) 以及 RPC over HTTP 弱點常見問題集：

**這個弱點的範圍為何？**
這是[拒絕服務](http://www.microsoft.com/technet/security/bulletin/glossary.asp)弱點。一旦攻擊得逞，攻擊者將能造成 COM Internet Services 或 RPC over HTTP 元件停止接受連線，並使得系統停止回應。系統管理員需要以手動方式重新啟動 Internet Information Services (IIS)，以還原正常作業。

**造成這個弱點的原因為何？**
受影響的元件用來驗證訊息輸入的處理程序在某些情況下會造成這個弱點。

**何謂 COM Internet Service (CIS) 以及 RPC over HTTP？**
RPC over HTTP v1 (Windows NT 4.0 與 Windows 2000) 以及 v2 (Windows Server 2003) 會允許 RPC 透過 TCP 80 與 443 (僅限 v2) 通訊埠作業，因此用戶端與伺服器可以透過大部分 proxy 伺服器和防火牆進行通訊。COM Internet Service (CIS) 讓 DCOM 可以使用 RPC over HTTP，在 DCOM 用戶端和 DCOM 伺服器之間進行通訊。如果 Windows Server 2003 設定為 IIS 5 相容模式，Windows 2003 可以設為支援 RPC over HTTP v1。IIS 6.0 模式使用 RPC over HTTP v2。IIS 6.0 模式並沒有這個弱點，因此建議使用 IIS 6.0 模式。如需有關部署建議及組態設定的詳細資訊，請瀏覽 [MSDN 網站](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/rpc/rpc/rpc_over_http_deployment_recommendations.asp)。

如需有關 Windows Server 2003 的 RPC over HTTP 的詳細資訊，請瀏覽 [MSDN 網站](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/rpc/rpc/remote_procedure_calls_using_rpc_over_http.asp)。
如需 CIS 的詳細資訊，請瀏覽 [MSDN 網站](http://msdn.microsoft.com/library/default.asp?url=/library/zh-cn/dndcom/html/cis.asp)。

**要如何判斷是否已安裝 CIS 或 RPC over HTTP？**
若要判定伺服器上是否安裝了 CIS 或 RPC over HTTP，請視您的作業系統而定，利用下列的方法之一進行：

-   在已安裝 Windows NT Option Pack 的 Windows NT 4.0 系統上：

    在所有磁碟分割上搜尋 **rpcproxy.dll**，如果在伺服器上找得到，就表示已安裝 CIS。

-   在執行 Windows 2000 或 Windows Server 2003 的系統上：

    在 \[控制台\] 中按兩下 \[新增/移除程式\]，然後按兩下 \[新增/移除 Windows 元件\]。

    \[Windows 元件精靈\] 便會啟動。

    按一下 \[網路服務\]，然後再按 \[詳細資料\]。

    如果已經選取 \[COM Internet Services Proxy\] (Windows 2000 Server) 或 \[RPC over HTTP Proxy\] (Windows Server 2003) 核取方塊，就表示已在伺服器上啟用 CIS 或 RPC over HTTP 支援。

    若要在系統上搜尋特定的檔案，請按一下 \[開始\]，按一下 \[搜尋\]，再按一下 \[檔案或資料夾\]，然後輸入要搜尋的檔案名稱。搜尋可能需要數分鐘的時間，視硬碟的大小而定。

**攻擊者可能會利用這項弱點採取什麼動作？**
成功利用拒絕服務弱點的攻擊者可能會使得元件停止回應。

**誰可以利用這項弱點？**
在 Windows NT 4.0 和 Windows 2000 上，當轉送到後端系統的要求通過受影響的元件時，匿名的攻擊者可能會以蓄意製作的訊息回覆要求，造成元件停止接受要求。

在 Windows Server 2003 上，攻擊者也必須要提供有效的登入憑證。

**攻擊者如何利用這個弱點？**
攻擊者可能會以幾種方式利用這個弱點：

-   如果攻擊者控制了設為透過 CIS 或 RPC over HTTP 接收傳輸的系統，將能夠對 CIS 或 RPC over HTTP 傳送的要求製作出惡意的回應，以利用這個弱點。
-   攻擊者也可能在本機上聆聽網路流量，目標是啟用了 CIS 或 RPC over HTTP Proxy 的系統，並試著代表 CIS 或 RPC over HTTP 想要溝通的系統，對轉送的要求傳送蓄意製作的惡意回應，以利用這個弱點。

如果系統收到上述類型的惡意訊息，訊息可能會導致受影響的元件停止回應。

攻擊者可以透過其他方式存取受到影響的元件，像是以互動方式登入系統，或是使用另一個應用程式以本機或遠端方式將參數傳送至防備不周延的元件中。

**因這項弱點所產生的風險主要會發生在那些系統上？**
在所有受影響的平台上，這些受影響的元件依照預設都是停用的。

不過，如果安裝了 Windows NT 4.0 Option Pack，就會在Windows NT 4.0 Server 以及 Windows NT 4.0 Terminal Server Edition 上安裝受影響的元件，這是預設的配置模式。受影響的元件仍然會維持停用狀態，直到系統管理員執行Microsoft 知識庫文件編號 [282261](http://support.microsoft.com/default.aspx?kbid=282261) 中所述的步驟為止。

Windows 2000 或 Windows Server 2003 依照預設不會安裝受影響的元件，因此只有當系統管理員手動安裝這些元件後，系統才有受到這項攻擊的危險。

以上兩個系統也只有在系統管理員手動設定受影響的元件，讓他們轉送要求給其他系統時，才有受到這項攻擊的危險。

Windows Server 2003 所受的影響比較小，因為即使安裝了受影響的元件，網際網路資訊服務的預設組態仍然可以避免這個弱點，只有在啟用 IIS 5.0 相容模式時，Windows Server 2003 才會暴露於危險中。Microsoft 並不建議使用 RPC over HTTP 時啟用 IIS 5.0 相容模式。如需部署建議的詳細資訊，請瀏覽 [MSDN 網站](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/rpc/rpc/rpc_over_http_deployment_recommendations.asp)。

Windows NT 4.0 Workstation 和 Windows XP 不支援安裝受影響的元件。因此，這些作業系統不會受這項弱點的影響。

**更新程式需要任何手動步驟嗎？**
如果系統是在 Windows NT 4.0 上執行 CIS，就需要進行一些手動的步驟。在 Windows NT 4.0 中，系統管理員需要手動執行 Microsoft 知識庫文件編號 [282261](http://support.microsoft.com/default.aspx?kbid=282261) 中所述的步驟以啟用 CIS，包括指定 rpcproxy.dll 的實際位置。因為更新程式無法判斷這個位置，因此系統管理員必須手動將更新版本的 rpcproxy.dll 複製到原本的位置，才能防止這個弱點。

**更新的作用何在？**
本更新程式修改了受影響的元件對收到的訊息進行驗證的方式，因而消除了這項弱點。

#### 物件識別弱點 - CAN-2004-0124：

物件識別建立的方式中具有一項資料洩露的弱點。這個弱點可能會讓攻擊者賦予應用程式開啟網路通訊埠的能力。雖然攻擊者無法利用這項弱點直接破壞系統，但是能利用此弱點透過通訊埠進行網路通訊，同時無法預期攻擊者會利用哪一個通訊埠。

#### 物件識別弱點的緩和因素：

防火牆的最佳實務作法與標準的預設防火牆組態，都有助於保護網路免於遭受企業外部發動之攻擊的威脅。最佳的實務作法建議，是讓任何會連線至網際網路的系統僅開放最少量的連接埠。

#### 物件識別弱點的替代解決方案：

針對 **RPC Runtime 函式庫弱點 - CAN-2003-0813** 列出的替代解決方案，也適用於這項弱點。

#### 物件識別弱點常見問題集：

**這個弱點的範圍為何？**
這項弱點會造成資訊的洩漏。一旦攻擊得逞，攻擊者將能運用應用程式開啟網路通訊埠，包括原本並不用於網路通訊的應用程式。攻擊者並不能利用這項弱點直接破壞系統，但是能利用此弱點透過通訊埠進行網路通訊，同時無法預期攻擊者會利用哪一個通訊埠。

**造成這個弱點的原因為何？**
The way that COM object identifiers are created.

**What is a COM object identifier?**
每個應用程式都具有物件識別碼。所謂的物件識別碼就是一個獨特的數字，可以讓作業系統辨識應用程式。這個弱點可能會讓攻擊者得悉物件識別碼，攻擊者就可能得以強制應用程式開啟網路通訊埠，並使應用程式接受輸入的通訊要求。如需使用物件識別的詳細資訊，請瀏覽這個[網站](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnesscom/html/crossapartmentaccess.asp)。

**攻擊者可能會利用這項弱點採取什麼動作？**
一旦攻擊得逞，攻擊者將能強制應用程式接受輸入的通訊要求。攻擊者並不能利用這項弱點直接破壞系統，但是能利用此弱點透過通訊埠進行網路通訊，同時無法預期攻擊者會利用哪一個通訊埠。

**誰可以利用這項弱點？**
只要能將蓄意製作的 RPC 訊息傳送到受影響的系統上，任何匿名使用者都可以利用這些弱點。

**攻擊者如何利用這個弱點？**
利用這個弱點的攻擊者會透過受影響的 TCP/UDP 通訊埠，傳送蓄意製作的 RPC 訊息到受影響的系統上。

**這項弱點是否會對 Windows 98、Windows 98 Second Edition 或 Windows Millennium Edition 帶來重大的影響？**
不會。雖然這些作業系統可能包含了受影響的元件，但問題並不嚴重。如需更多有關這些嚴重性等級的資訊，請參閱此[網站](http://technet.microsoft.com/security/bulletin/rating)。

**更新的作用何在？**
本更新程式修改了物件識別建立的方式，新的行為將使得攻擊者更難得知物件識別碼。

安全性更新資訊
--------------

<span></span>
**安裝平台及必要條件：**

如需有關您使用平台的特定安全性更新的資訊，請按下適當的連結：

#### Windows Server 2003 (所有版本)

**必要條件**
這個安全性更新需要 Windows Server 2003 的發行版本。

**未來將包含於此 Service Pack 中：**
本問題的更新程式會包含在 Windows Server 2003 Service Pack 1 中。

**安裝資訊**

**/help** 顯示命令列選項

**安裝模式**

**/quiet** 無訊息模式 (無使用者互動，不顯示任何訊息)

**/passive** 自動安裝模式 (僅顯示進度列)

**/uninstall** 將套件解除安裝

**重新啟動選項**

**/norestart** 安裝完成時不要重新開機

**/forcerestart** 安裝之後重新開機

**特殊選項**

**/l** 列出安裝的 Windows Hotfix 或更新的套件

**/o** 不先提示，直接覆寫 OEM 檔案

**/n** 不備份解除安裝所需的檔案

**/f** 當電腦關機時，強制其他程式關閉

**注意：**您可以在同一個指令中合併使用這些參數。為符合回溯相容性，安全性更新程式也支援舊版安裝公用程式使用的設定參數。如需關於支援的安裝參數的詳細資訊，請參閱 Microsoft 知識庫文件編號 [262841](http://support.microsoft.com/default.aspx?kbid=262841)。

**部署資訊**

在 Windows Server 2003 上，如想在不需要使用者介入的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windowsserver2003-kb828741-x86-enu /passive /quiet**

在 Windows Server 2003 上，如想在不強制系統重新開機的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windowsserver2003-kb828741-x86-enu /norestart**

如想進一步瞭解如何透過「軟體更新服務」部署這個安全性更新，請瀏覽 [軟體更新服務網站](http://go.microsoft.com/fwlink/?linkid=21125)。

**重新開機需求**

套用此安全性更新程式之後，您必須重新啟動系統。

**移除資訊**

若要移除此更新程式，請使用 \[控制台\] 中的 \[新增/移除程式\]。

系統管理員也可以使用 Spuninst.exe 公用程式來移除此安全性更新。Spuninst.exe 位於 %Windir%\\$NTUninstallKB828741$\\Spuninst 資料夾中。Spuninst.exe 公用程式支援以下的安裝參數：

**/?：顯示安裝參數** ：顯示安裝參數

**/u：使用自動安裝模式**

**/f：當電腦關機時，強制其他程式結束**

**/z：安裝完成時，不重新啟動**

**/q：使用無訊息模式 (沒有使用者介面)**

**檔案資訊**

本補充程式的英文版本具有下表列出的檔案屬性 (或更新的版本)。這些檔案的日期及時間均使用 Coordinated Universal Time (UTC)。當您檢視檔案資訊時，它會轉換為當地時間。如想知道 UTC 及當地時間的時差，請使用 \[控制台\] 內的 \[日期/時間\] 工具的**\[時區\] 索引標籤**。

Windows Server 2003、Enterprise Edition、Windows Server 2003 Standard Edition、Windows Server 2003 Web Edition 及 Windows Server 2003 Datacenter Edition：

`日期     時間              版本            大小        檔案名稱         資料夾------------------------------------------------------------------------16-Mar-2004  03:09  2001.12.4720.130   263,680  Catsrv.dll       RTMGDR16-Mar-2004  03:09  2001.12.4720.130   587,264  Catsrvut.dll     RTMGDR16-Mar-2004  03:09  2001.12.4720.130    98,304  Clbcatex.dll     RTMGDR16-Mar-2004  03:09  2001.12.4720.130   493,056  Clbcatq.dll      RTMGDR16-Mar-2004  03:09  2001.12.4720.130    58,368  Colbact.dll      RTMGDR16-Mar-2004  03:09  2001.12.4720.139   189,440  Comadmin.dll     RTMGDR16-Mar-2004  03:09  2001.12.4720.130 1,202,176  Comsvcs.dll      RTMGDR16-Mar-2004  03:09  2001.12.4720.130   566,272  Comuid.dll       RTMGDR16-Mar-2004  03:09  2001.12.4720.130   226,816  Es.dll           RTMGDR16-Mar-2004  03:09  2001.12.4720.130   443,904  Msdtcprx.dll     RTMGDR16-Mar-2004  03:09  2001.12.4720.130   972,288  Msdtctm.dll      RTMGDR16-Mar-2004  03:09  2001.12.4720.130   160,768  Msdtcuiu.dll     RTMGDR16-Mar-2004  03:09  2001.12.4720.130    76,288  Mtxclu.dll       RTMGDR16-Mar-2004  03:09  2001.12.4720.130   108,032  Mtxoci.dll       RTMGDR16-Mar-2004  03:09  5.2.3790.138     1,189,376  Ole32.dll        RTMGDR16-Mar-2004  03:09  5.2.3790.137        26,112  Rpcproxy.dll     RTMGDR16-Mar-2004  03:09  5.2.3790.137       660,992  Rpcrt4.dll       RTMGDR16-Mar-2004  03:09  5.2.3790.132       294,400  Rpcss.dll        RTMGDR16-Mar-2004  03:17  2001.12.4720.130   263,680  Catsrv.dll       RTMQFE16-Mar-2004  03:17  2001.12.4720.130   587,264  Catsrvut.dll     RTMQFE16-Mar-2004  03:17  2001.12.4720.130    98,304  Clbcatex.dll     RTMQFE16-Mar-2004  03:17  2001.12.4720.130   493,056  Clbcatq.dll      RTMQFE16-Mar-2004  03:17  2001.12.4720.130    58,368  Colbact.dll      RTMQFE16-Mar-2004  03:17  2001.12.4720.139   189,440  Comadmin.dll     RTMQFE16-Mar-2004  03:17  2001.12.4720.130 1,202,176  Comsvcs.dll      RTMQFE16-Mar-2004  03:17  2001.12.4720.130   566,272  Comuid.dll       RTMQFE16-Mar-2004  03:17  2001.12.4720.130   226,816  Es.dll           RTMQFE16-Mar-2004  03:17  2001.12.4720.130   443,904  Msdtcprx.dll     RTMQFE16-Mar-2004  03:17  2001.12.4720.130   972,288  Msdtctm.dll      RTMQFE16-Mar-2004  03:17  2001.12.4720.130   160,768  Msdtcuiu.dll     RTMQFE16-Mar-2004  03:17  2001.12.4720.130    76,288  Mtxclu.dll       RTMQFE16-Mar-2004  03:17  2001.12.4720.130   108,032  Mtxoci.dll       RTMQFE16-Mar-2004  03:17  5.2.3790.139     1,188,352  Ole32.dll        RTMQFE16-Mar-2004  03:17  5.2.3790.141        26,112  Rpcproxy.dll     RTMQFE16-Mar-2004  03:17  5.2.3790.141       659,968  Rpcrt4.dll       RTMQFE16-Mar-2004  03:17  5.2.3790.142       293,888  Rpcss.dll        RTMQFE`

Windows Server 2003 64-Bit Enterprise Edition 及 Windows Server 2003 64-Bit Datacenter Edition：

`日期     時間              版本            大小        檔案名稱          平台     資料夾-------------------------------------------------------------------------------31-Mar-2004  03:29  2001.12.4720.130   641,024  Catsrv.dll       IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130 1,567,744  Catsrvut.dll     IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   263,680  Clbcatex.dll     IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130 1,294,336  Clbcatq.dll      IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   179,712  Colbact.dll      IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.139   412,160  Comadmin.dll     IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130 3,127,296  Comsvcs.dll      IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130 1,873,408  Comuid.dll       IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   653,312  Es.dll           IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130 1,301,504  Msdtcprx.dll     IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130 3,166,208  Msdtctm.dll      IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   462,848  Msdtcuiu.dll     IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   203,776  Mtxclu.dll       IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   315,904  Mtxoci.dll       IA64   RTMGDR31-Mar-2004  03:29  5.2.3790.146     3,567,616  Ole32.dll        IA64   RTMGDR31-Mar-2004  03:29  5.2.3790.137        73,216  Rpcproxy.dll     IA64   RTMGDR31-Mar-2004  03:29  5.2.3790.137     2,140,160  Rpcrt4.dll       IA64   RTMGDR31-Mar-2004  03:29  5.2.3790.146       687,104  Rpcss.dll        IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   263,680  Wcatsrv.dll      X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130   587,264  Wcatsrvut.dll    X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130    98,304  Wclbcatex.dll    X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130   493,056  Wclbcatq.dll     X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130    58,368  Wcolbact.dll     X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.139   189,440  Wcomadmin.dll    X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130 1,202,176  Wcomsvcs.dll     X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130   226,816  Wes.dll          X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130   443,904  Wmsdtcprx.dll    X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130   160,768  Wmsdtcuiu.dll    X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130    76,288  Wmtxclu.dll      X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130   108,032  Wmtxoci.dll      X86    RTMGDR\WOW31-Mar-2004  03:29  5.2.3790.146     1,189,376  Wole32.dll       X86    RTMGDR\WOW31-Mar-2004  03:29  5.2.3790.137        26,112  Wrpcproxy.dll    X86    RTMGDR\WOW31-Mar-2004  03:29  5.2.3790.137       542,208  Wrpcrt4.dll      X86    RTMGDR\WOW31-Mar-2004  03:25  2001.12.4720.130   641,024  Catsrv.dll       IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130 1,567,744  Catsrvut.dll     IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130   263,680  Clbcatex.dll     IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130 1,294,336  Clbcatq.dll      IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130   179,712  Colbact.dll      IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.139   412,160  Comadmin.dll     IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130 3,127,296  Comsvcs.dll      IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130 1,873,408  Comuid.dll       IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130   653,312  Es.dll           IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130 1,301,504  Msdtcprx.dll     IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130 3,166,208  Msdtctm.dll      IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130   462,848  Msdtcuiu.dll     IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130   203,776  Mtxclu.dll       IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130   315,904  Mtxoci.dll       IA64   RTMQFE31-Mar-2004  03:25  5.2.3790.146     3,565,056  Ole32.dll        IA64   RTMQFE31-Mar-2004  03:25  5.2.3790.141        73,216  Rpcproxy.dll     IA64   RTMQFE31-Mar-2004  03:25  5.2.3790.141     2,150,400  Rpcrt4.dll       IA64   RTMQFE31-Mar-2004  03:25  5.2.3790.146       685,568  Rpcss.dll        IA64   RTMQFE31-Mar-2004  03:26  2001.12.4720.130   263,680  Wcatsrv.dll      X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130   587,264  Wcatsrvut.dll    X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130    98,304  Wclbcatex.dll    X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130   493,056  Wclbcatq.dll     X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130    58,368  Wcolbact.dll     X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.139   189,440  Wcomadmin.dll    X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130 1,202,176  Wcomsvcs.dll     X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130   226,816  Wes.dll          X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130   443,904  Wmsdtcprx.dll    X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130   160,768  Wmsdtcuiu.dll    X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130    76,288  Wmtxclu.dll      X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130   108,032  Wmtxoci.dll      X86    RTMQFE\WOW31-Mar-2004  03:26  5.2.3790.146     1,188,352  Wole32.dll       X86    RTMQFE\WOW31-Mar-2004  03:26  5.2.3790.141        26,112  Wrpcproxy.dll    X86    RTMQFE\WOW31-Mar-2004  03:26  5.2.3790.141       544,256  Wrpcrt4.dll      X86    RTMQFE\WOW`

**附註：**當您在 Windows Server 2003 或 Windows XP 64-Bit Edition Version 2003 電腦上安裝安全性更新時，安裝程式會檢查系統上要更新的檔案先前是否曾經用 Microsoft Hotfix 作過更新。如果您先前曾經安裝 Hotfix 更新其中一個檔案，安裝程式會將 RTMQFE 檔案複製到您的系統中。否則，安裝程式會將 RTMGDR 檔案複製到您的系統中。如需更多資訊，請參閱 Microsoft 知識庫文件編號 [824994](http://support.microsoft.com/default.aspx?kbid=824994)。

**確認更新的安裝**

如果想確定受影響的系統是否安裝了某個安全性更新，您可以使用 Microsoft Baseline Security Analyzer (MBSA) 工具。這個工具能讓系統管理員掃描本機和遠端系統，判斷是否漏裝了安裝性更新或是有一般安全性設定不當的情形。如需更多有關 MBSA 的資訊，請瀏覽 [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) 網站。

您也可以查看下列的登錄機碼，來確認安全性更新安裝的檔案：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB828741\\Filelist

**注意：**如果管理員或 OEM 將 828741 安全性更新整合 (或 slipstream) 到 Windows 安裝來源檔時，這個登錄機碼可能無法正確建立。

#### Windows XP (所有版本)

**附註：**就 Windows XP 64-Bit Edition Version 2003 而言，這個安全性更新與 Windows Server 2003 64-Bit Edition 安全性更新是相同的。

**必要條件**
這個安全性更新程式需要 Windows XP 或 Windows XP Service Pack 1 (SP1) 的發行版本。如需更多資訊，請參閱 Microsoft 知識庫文件編號 [322389](http://support.microsoft.com/default.aspx?scid=kb;en-us;322389)。

**未來將包含於此 Service Pack 中：**
此問題的更新程式將包含在 Windows XP Service Pack 2 中。

**安裝資訊**
這個安全性更新支援以下的安裝參數：

**/help** 顯示命令列選項

**安裝模式**

**/quiet** 無訊息模式 (無使用者互動，不顯示任何訊息)

**/passive** 自動安裝模式 (僅顯示進度列)

**/uninstall** 將套件解除安裝

**重新啟動選項**

**/norestart** 安裝完成時不要重新開機

**/forcerestart** 安裝之後重新開機

**特殊選項**

**/l** 列出安裝的 Windows Hotfix 或更新的套件

**/o** 不先提示，直接覆寫 OEM 檔案

**/n** 不備份解除安裝所需的檔案

**/f** 當電腦關機時，強制其他程式關閉

**注意：**您可以在同一個指令中合併使用這些參數。為符合回溯相容性，安全性更新程式也支援舊版安裝公用程式使用的設定參數。如需關於支援的安裝參數的詳細資訊，請參閱 Microsoft 知識庫文件編號 [262841](http://support.microsoft.com/default.aspx?kbid=262841)。

**部署資訊**

在 Windows XP 上，如想在不需要使用者介入的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windowsxp-kb828741-x86-enu /passive /quiet**

在 Windows XP 上，如想在不強制系統重新開機的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windowsxp-kb828741-x86-enu /norestart**

如想進一步瞭解如何透過「軟體更新服務」部署這個安全性更新，請瀏覽[軟體更新服務網站](http://go.microsoft.com/fwlink/?linkid=21125)。

**重新開機需求**

套用此安全性更新程式之後，您必須重新啟動系統。

**移除資訊**

如果要移除這個安全性更新程式，請使用 \[控制台\] 中的 \[新增或移除程式\] 工具。

系統管理員也可以使用 Spuninst.exe 公用程式來移除此安全性更新。Spuninst.exe 位於 %Windir%\\$NTUninstallKB828741$\\Spuninst 資料夾中。Spuninst.exe 公用程式支援以下的安裝參數：

**/?：顯示安裝參數**

**/u：使用自動安裝模式**

**/f：當電腦關機時，強制其他程式結束**

**/z：安裝完成時，不重新啟動**

**/q：使用無訊息模式 (沒有使用者介面)**

**檔案資訊**

本更新程式的英文版本具有下表列出的檔案屬性 (或更新的版本)。這些檔案的日期及時間均使用 Coordinated Universal Time (UTC)。當您檢視檔案資訊時，它會轉換為當地時間。如想知道 UTC 及當地時間的時差，請使用 \[控制台\] 內的 \[日期/時間\] 工具的 **\[時區\] 索引標籤**。

Windows XP Home Edition、Windows XP Professional、Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP Tablet PC Edition 和 Windows XP Media Center Edition：

`日期     時間              版本            大小        檔案名稱         資料夾-----------------------------------------------------------------------06-Mar-2004  02:04  2001.12.4414.53   225,280  Catsrv.dll       (pre-sp1)06-Mar-2004  02:04  2001.12.4414.53   596,480  Catsrvut.dll     (pre-sp1)06-Mar-2004  02:04  2001.12.4414.53   110,080  Clbcatex.dll     (pre-sp1)06-Mar-2004  02:05  2001.12.4414.53   499,712  Clbcatq.dll      (pre-sp1)06-Mar-2004  02:04  2001.12.4414.53    64,512  Colbact.dll      (pre-sp1)06-Mar-2004  02:05  2001.12.4414.53   187,904  Comadmin.dll     (pre-sp1)17-Feb-2004  18:49  2001.12.4414.53     8,192  Comrepl.exe      (pre-sp1)06-Mar-2004  02:05  2001.12.4414.53 1,177,088  Comsvcs.dll      (pre-sp1)06-Mar-2004  02:05  2001.12.4414.53   499,200  Comuid.dll       (pre-sp1)06-Mar-2004  02:05  2001.12.4414.53   226,816  Es.dll           (pre-sp1)17-Feb-2004  18:50  2001.12.4414.53     6,656  Migregdb.exe     (pre-sp1)06-Mar-2004  02:05  2001.12.4414.53   365,568  Msdtcprx.dll     (pre-sp1)06-Mar-2004  02:05  2001.12.4414.53   977,920  Msdtctm.dll      (pre-sp1)06-Mar-2004  02:05  2001.12.4414.53   150,528  Msdtcuiu.dll     (pre-sp1)06-Mar-2004  02:05  2001.12.4414.53    64,512  Mtxclu.dll       (pre-sp1)06-Mar-2004  02:05  2001.12.4414.53    82,432  Mtxoci.dll       (pre-sp1)06-Mar-2004  02:05  5.1.2600.136    1,105,408  Ole32.dll        (pre-sp1)06-Mar-2004  02:05  5.1.2600.135      442,880  Rpcrt4.dll       (pre-sp1)06-Mar-2004  02:05  5.1.2600.135      214,528  Rpcss.dll        (pre-sp1)06-Mar-2004  02:05  2001.12.4414.53    97,280  Txflog.dll       (pre-sp1)06-Mar-2004  02:16  2001.12.4414.53   225,280  Catsrv.dll       (with sp1)06-Mar-2004  02:16  2001.12.4414.53   594,944  Catsrvut.dll     (with sp1)06-Mar-2004  02:16  2001.12.4414.53   110,080  Clbcatex.dll     (with sp1)06-Mar-2004  02:16  2001.12.4414.53   499,712  Clbcatq.dll      (with sp1)06-Mar-2004  02:16  2001.12.4414.53    64,512  Colbact.dll      (with sp1)06-Mar-2004  02:16  2001.12.4414.53   187,904  Comadmin.dll     (with sp1)17-Feb-2004  18:49  2001.12.4414.53     8,192  Comrepl.exe      (with sp1)06-Mar-2004  02:16  2001.12.4414.53 1,194,496  Comsvcs.dll      (with sp1)06-Mar-2004  02:16  2001.12.4414.53   499,200  Comuid.dll       (with sp1)06-Mar-2004  02:16  2001.12.4414.53   226,816  Es.dll           (with sp1)17-Feb-2004  18:50  2001.12.4414.53     6,656  Migregdb.exe     (with sp1)06-Mar-2004  02:16  2001.12.4414.53   367,616  Msdtcprx.dll     (with sp1)06-Mar-2004  02:16  2001.12.4414.53   977,920  Msdtctm.dll      (with sp1)06-Mar-2004  02:16  2001.12.4414.53   150,528  Msdtcuiu.dll     (with sp1)06-Mar-2004  02:16  2001.12.4414.53    64,512  Mtxclu.dll       (with sp1)06-Mar-2004  02:16  2001.12.4414.53    82,432  Mtxoci.dll       (with sp1)06-Mar-2004  02:16  5.1.2600.1362   1,183,744  Ole32.dll        (with sp1)06-Mar-2004  02:16  5.1.2600.1361     535,552  Rpcrt4.dll       (with sp1)06-Mar-2004  02:16  5.1.2600.1361     263,680  Rpcss.dll        (with sp1)06-Mar-2004  02:16  2001.12.4414.53    97,280  Txflog.dll       (with sp1)`

Windows XP 64-Bit Edition Service Pack 1：

`日期     時間              版本            大小        檔案名稱        平台---------------------------------------------------------------------06-Mar-2004  02:07  2001.12.4414.53   695,808  Catsrv.dll       IA6406-Mar-2004  02:07  2001.12.4414.53 2,127,360  Catsrvut.dll     IA6406-Mar-2004  02:07  2001.12.4414.53   360,960  Clbcatex.dll     IA6406-Mar-2004  02:07  2001.12.4414.53 1,554,432  Clbcatq.dll      IA6406-Mar-2004  02:07  2001.12.4414.53   204,288  Colbact.dll      IA6406-Mar-2004  02:07  2001.12.4414.53   478,720  Comadmin.dll     IA6409-Jan-2004  22:50  2001.12.4414.53    20,992  Comrepl.exe      IA6406-Mar-2004  02:07  2001.12.4414.53 3,591,168  Comsvcs.dll      IA6406-Mar-2004  02:07  2001.12.4414.53 1,817,600  Comuid.dll       IA6406-Mar-2004  02:07  2001.12.4414.53   740,864  Es.dll           IA6409-Jan-2004  22:51  2001.12.4414.53    12,800  Migregdb.exe     IA6406-Mar-2004  02:07  2001.12.4414.53 1,509,888  Msdtcprx.dll     IA6406-Mar-2004  02:07  2001.12.4414.53 3,484,160  Msdtctm.dll      IA6406-Mar-2004  02:07  2001.12.4414.53   513,024  Msdtcuiu.dll     IA6406-Mar-2004  02:07  2001.12.4414.53   194,048  Mtxclu.dll       IA6406-Mar-2004  02:07  2001.12.4414.53   286,720  Mtxoci.dll       IA6406-Mar-2004  02:07  5.1.2600.1362   4,339,200  Ole32.dll        IA6406-Mar-2004  02:07  5.1.2600.1361   2,317,824  Rpcrt4.dll       IA6406-Mar-2004  02:07  5.1.2600.1361     780,288  Rpcss.dll        IA6406-Mar-2004  02:07  2001.12.4414.53   345,088  Txflog.dll       IA6406-Mar-2004  02:16  2001.12.4414.53   225,280  Wcatsrv.dll      X8606-Mar-2004  02:16  2001.12.4414.53   594,944  Wcatsrvut.dll    X8606-Mar-2004  02:16  2001.12.4414.53   110,080  Wclbcatex.dll    X8606-Mar-2004  02:16  2001.12.4414.53   499,712  Wclbcatq.dll     X8606-Mar-2004  02:16  2001.12.4414.53    64,512  Wcolbact.dll     X8606-Mar-2004  02:16  2001.12.4414.53   187,904  Wcomadmin.dll    X8606-Mar-2004  02:16  2001.12.4414.53 1,194,496  Wcomsvcs.dll     X8606-Mar-2004  02:16  2001.12.4414.53   226,816  Wes.dll          X8606-Mar-2004  02:16  2001.12.4414.53   367,616  Wmsdtcprx.dll    X8606-Mar-2004  02:16  2001.12.4414.53   150,528  Wmsdtcuiu.dll    X8606-Mar-2004  02:16  2001.12.4414.53    64,512  Wmtxclu.dll      X8606-Mar-2004  02:16  2001.12.4414.53    82,432  Wmtxoci.dll      X8606-Mar-2004  02:16  5.1.2600.1362   1,183,744  Wole32.dll       X8606-Mar-2004  02:16  5.1.2600.1361     509,440  Wrpcrt4.dll      X8606-Mar-2004  02:16  2001.12.4414.53    97,280  Wtxflog.dll      X86`

Windows XP 64-Bit Edition Version 2003：

`日期     時間              版本            大小        檔案名稱          平台     資料夾------------------------------------------------------------------------------31-Mar-2004  03:29  2001.12.4720.130   641,024  Catsrv.dll       IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130 1,567,744  Catsrvut.dll     IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   263,680  Clbcatex.dll     IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130 1,294,336  Clbcatq.dll      IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   179,712  Colbact.dll      IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.139   412,160  Comadmin.dll     IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130 3,127,296  Comsvcs.dll      IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130 1,873,408  Comuid.dll       IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   653,312  Es.dll           IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130 1,301,504  Msdtcprx.dll     IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130 3,166,208  Msdtctm.dll      IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   462,848  Msdtcuiu.dll     IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   203,776  Mtxclu.dll       IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   315,904  Mtxoci.dll       IA64   RTMGDR31-Mar-2004  03:29  5.2.3790.146     3,567,616  Ole32.dll        IA64   RTMGDR31-Mar-2004  03:29  5.2.3790.137        73,216  Rpcproxy.dll     IA64   RTMGDR31-Mar-2004  03:29  5.2.3790.137     2,140,160  Rpcrt4.dll       IA64   RTMGDR31-Mar-2004  03:29  5.2.3790.146       687,104  Rpcss.dll        IA64   RTMGDR31-Mar-2004  03:29  2001.12.4720.130   263,680  Wcatsrv.dll      X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130   587,264  Wcatsrvut.dll    X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130    98,304  Wclbcatex.dll    X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130   493,056  Wclbcatq.dll     X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130    58,368  Wcolbact.dll     X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.139   189,440  Wcomadmin.dll    X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130 1,202,176  Wcomsvcs.dll     X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130   226,816  Wes.dll          X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130   443,904  Wmsdtcprx.dll    X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130   160,768  Wmsdtcuiu.dll    X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130    76,288  Wmtxclu.dll      X86    RTMGDR\WOW31-Mar-2004  03:29  2001.12.4720.130   108,032  Wmtxoci.dll      X86    RTMGDR\WOW31-Mar-2004  03:29  5.2.3790.146     1,189,376  Wole32.dll       X86    RTMGDR\WOW31-Mar-2004  03:29  5.2.3790.137        26,112  Wrpcproxy.dll    X86    RTMGDR\WOW31-Mar-2004  03:29  5.2.3790.137       542,208  Wrpcrt4.dll      X86    RTMGDR\WOW31-Mar-2004  03:25  2001.12.4720.130   641,024  Catsrv.dll       IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130 1,567,744  Catsrvut.dll     IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130   263,680  Clbcatex.dll     IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130 1,294,336  Clbcatq.dll      IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130   179,712  Colbact.dll      IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.139   412,160  Comadmin.dll     IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130 3,127,296  Comsvcs.dll      IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130 1,873,408  Comuid.dll       IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130   653,312  Es.dll           IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130 1,301,504  Msdtcprx.dll     IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130 3,166,208  Msdtctm.dll      IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130   462,848  Msdtcuiu.dll     IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130   203,776  Mtxclu.dll       IA64   RTMQFE31-Mar-2004  03:25  2001.12.4720.130   315,904  Mtxoci.dll       IA64   RTMQFE31-Mar-2004  03:25  5.2.3790.146     3,565,056  Ole32.dll        IA64   RTMQFE31-Mar-2004  03:25  5.2.3790.141        73,216  Rpcproxy.dll     IA64   RTMQFE31-Mar-2004  03:25  5.2.3790.141     2,150,400  Rpcrt4.dll       IA64   RTMQFE31-Mar-2004  03:25  5.2.3790.146       685,568  Rpcss.dll        IA64   RTMQFE31-Mar-2004  03:26  2001.12.4720.130   263,680  Wcatsrv.dll      X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130   587,264  Wcatsrvut.dll    X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130    98,304  Wclbcatex.dll    X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130   493,056  Wclbcatq.dll     X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130    58,368  Wcolbact.dll     X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.139   189,440  Wcomadmin.dll    X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130 1,202,176  Wcomsvcs.dll     X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130   226,816  Wes.dll          X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130   443,904  Wmsdtcprx.dll    X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130   160,768  Wmsdtcuiu.dll    X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130    76,288  Wmtxclu.dll      X86    RTMQFE\WOW31-Mar-2004  03:26  2001.12.4720.130   108,032  Wmtxoci.dll      X86    RTMQFE\WOW31-Mar-2004  03:26  5.2.3790.146     1,188,352  Wole32.dll       X86    RTMQFE\WOW31-Mar-2004  03:26  5.2.3790.141        26,112  Wrpcproxy.dll    X86    RTMQFE\WOW31-Mar-2004  03:26  5.2.3790.141       544,256  Wrpcrt4.dll      X86    RTMQFE\WOW`

**注意：**Windows XP 及 Windows XP 64-Bit Edition Version 2003 版的安全性更新是以雙重模式加以封裝的，其中包含 Windows XP 和 Windows XP Service Pack 1 (SP1) 兩種版本的原始檔案。有關雙重模式封裝的進一步資訊，請參閱 Microsoft 知識庫文件編號 [328848](http://support.microsoft.com/default.aspx?kbid=328848)。

當您安裝 Windows XP 64-Bit Edition Version 2003 安全性更新時，安裝程式會檢查系統上要更新的檔案先前是否曾經用 Microsoft Hotfix 作過更新。如果您先前曾經安裝 Hotfix 更新其中一個檔案，安裝程式會將 RTMQFE 檔案複製到您的系統中。否則，安裝程式會將 RTMGDR 檔案複製到您的系統中。如需更多資訊，請參閱 Microsoft 知識庫文件編號 [824994](http://support.microsoft.com/default.aspx?kbid=824994)。

**確認更新的安裝**

當您安裝 Windows XP 64-Bit Edition Version 2003 安全性更新時，安裝程式會檢查系統上要更新的檔案先前是否曾經用 Microsoft Hotfix 作過更新。如果您先前曾經安裝 Hotfix 更新其中一個檔案，安裝程式會將 RTMQFE 檔案複製到您的系統中。否則，安裝程式會將 RTMGDR 檔案複製到您的系統中。如需更多資訊，請參閱 Microsoft 知識庫文件編號 [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) 網站。

您也可以查看下列登錄機碼，來確認此安全性更新程式所安裝的檔案：

Windows XP Home Edition、Windows XP Professional、Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP 64-Bit Edition Service Pack 1、Windows XP Tablet PC Edition、Windows XP Media Center Edition：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP2\\KB828741\\Filelist

Windows XP 64-Bit Edition Version 2003：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB828741\\Filelist

**附註：**如果管理員或 OEM 將 828741 安全性更新整合 (或 slipstream) 到 Windows 安裝來源檔時，這個登錄機碼可能無法正確建立。

Edition (家用版) Service Pack 1、Windows XP Professional Service Pack 1、Windows XP 64-Bit Edition Service Pack 1、Windows XP Tablet PC Edition 和 Windows XP Media Center Edition：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB837001\\Filelist

Windows XP 64-Bit Edition Version 2003：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB837001\\Filelist

**附註：**如果管理員或 OEM 將 837001 安全性更新整合 (或 slipstream) 到 Windows 安裝來源檔時，這個登錄機碼可能無法正確建立。

#### Windows 2000 (所有版本)

**必要條件**
若為 Windows 2000，本安全性更新需要 Service Pack 2 (SP2)、Service Pack 3 (SP3) 或 Service Pack 4 (SP4)。

以上所列的軟體版本已經過測試判斷其是否會受到影響。其他版本已不再包含安全性更新支援，同時也不一定會受到影響。請瀏覽 [Microsoft 技術支援週期網站](http://go.microsoft.com/fwlink/?linkid=21742)，以瞭解您的產品及版本的支援生命週期。

如需有關取得最新 Service Pack 的進一步資訊，請參閱 Microsoft 知識庫文件編號 [260910](http://support.microsoft.com/default.aspx?scid=kb;en-us;260910)。

**未來將包含於此 Service Pack 中：**
此問題的更新程式將包含在 Windows 2000 Service Pack 5 中。

**安裝資訊**

這個安全性更新支援以下的安裝參數：

**/help** 顯示命令列選項

**安裝模式**

**/quiet** 無訊息模式 (無使用者互動，不顯示任何訊息)

**/passive** 自動安裝模式 (僅顯示進度列)

**/uninstall** 將套件解除安裝

**重新啟動選項**

**/norestart** 安裝完成時不要重新開機

**/forcerestart** 安裝之後重新開機

**特殊選項**

**/l** 列出安裝的 Windows Hotfix 或更新的套件

**/o** 不先提示，直接覆寫 OEM 檔案

**/n** 不備份解除安裝所需的檔案

**/f** 當電腦關機時，強制其他程式關閉

**注意：**您可以在同一個指令中合併使用這些參數。為符合回溯相容性，安全性更新程式也支援舊版安裝公用程式使用的設定參數。有關支援的安裝參數的其他資訊，請參閱 Microsoft 知識庫文件編號 [262841](http://support.microsoft.com/default.aspx?kbid=262841)。

**部署資訊**

如使用 Windows 2000 Service Pack 2、Windows 2000 Service Pack 3 和 Windows 2000 Service Pack 4，如想在不需要使用者介入的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windows2000-kb828741-x86-enu /passive /quiet**

如使用 Windows 2000 Server Service Pack 2、Windows 2000 Service Pack 3 和 Windows 2000 Service Pack 4，如想在無需強制重新開機的情況下安裝安全性更新程式，請在命令提示字元後輸入：

**Windows2000-kb828741-x86-enu /norestart**

如想進一步瞭解如何透過「軟體更新服務」部署這個安全性更新，請瀏覽[軟體更新服務網站](http://go.microsoft.com/fwlink/?linkid=21125)。

**重新開機需求**

套用此安全性更新程式之後，您必須重新啟動系統。

**移除資訊**

若要移除此安全性更新，請使用 \[控制台\] 中的 \[新增/移除程式\]。

系統管理員也可以使用 Spuninst.exe 公用程式來移除此安全性更新。Spuninst.exe 公用程式位於 %Windir%\\$NTUninstallKB828741$\\Spuninst 資料夾中。Spuninst.exe 公用程式支援以下的安裝參數：

**/?：顯示安裝參數**

**/u：使用自動安裝模式**

**/f：當電腦關機時，強制其他程式結束**

**/z：安裝完成時，不重新啟動**

**/q：使用無訊息模式 (沒有使用者介面)**

**檔案資訊**

本更新程式的英文版本具有下表列出的檔案屬性 (或更新的版本)。這些檔案的日期及時間均使用 Coordinated Universal Time (UTC)。當您檢視檔案資訊時，它會轉換為當地時間。如想知道 UTC 及當地時間的時差，請使用 \[控制台\] 內的 \[日期/時間\] 工具的 **\[時區\] 索引標籤**。

**注意：**日期和時間資訊可能會在安裝時有所變更。您應該使用版本、大小及檔案名稱資訊來判斷檔案的正確性。

Windows 2000 Service Pack 2、Windows 2000 Service Pack 3 和 Windows 2000 Service Pack 4：

`日期       時間         版本             大小       檔案名稱------------------------------------------------------------11-Mar-2004  21:29  2000.2.3511.0     169,232  Catsrv.dll11-Mar-2004  21:29  2000.2.3511.0     595,728  Catsrvut.dll11-Mar-2004  21:29  2000.2.3511.0      97,040  Clbcatex.dll11-Mar-2004  21:29  2000.2.3511.0     552,720  Clbcatq.dll11-Mar-2004  21:29  2000.2.3511.0      41,744  Colbact.dll11-Mar-2004  21:29  2000.2.3511.0     198,416  Comadmin.dll11-Mar-2004  21:29  2000.2.3511.0      97,552  Comrepl.dll11-Mar-2004  21:29  2000.2.3421.351   342,288  Comsetup.dll11-Mar-2004  21:29  2000.2.3511.0   1,467,664  Comsvcs.dll11-Mar-2004  21:29  2000.2.3511.0     625,936  Comuid.dll19-Feb-2004  22:03  2000.2.3511.0   1,816,552  Dtcsetup.exe11-Mar-2004  21:29  2000.2.3511.0     239,888  Es.dll11-Mar-2004  21:29  2000.2.3511.0      96,016  Msdtclog.dll11-Mar-2004  21:29  2000.2.3513.0     717,584  Msdtcprx.dll11-Mar-2004  21:29  2000.2.3511.0   1,139,984  Msdtctm.dll11-Mar-2004  21:29  2000.2.3511.0     153,872  Msdtcui.dll19-Feb-2004  22:44  2000.2.3511.0     155,408  Mtstocom.exe11-Mar-2004  21:29  2000.2.3511.0      52,496  Mtxclu.dll11-Mar-2004  21:29  2000.2.3511.0      26,896  Mtxdm.dll11-Mar-2004  21:29  2000.2.3511.0      35,600  Mtxlegih.dll11-Mar-2004  21:29  2000.2.3513.0     120,592  Mtxoci.dll11-Mar-2004  21:29  5.0.2195.6906     954,640  Ole32.dll11-Mar-2004  21:29  5.0.2195.6904      16,656  Rpcproxy.dll11-Mar-2004  21:29  5.0.2195.6904     449,808  Rpcrt4.dll11-Mar-2004  21:29  5.0.2195.6906     211,728  Rpcss.dll11-Mar-2004  21:29  2000.2.3511.0     398,608  Txfaux.dll11-Mar-2004  21:29  2000.2.3511.0      18,704  Xolehlp.dll`

**確認更新的安裝**

如果想確定受影響的系統是否安裝了某個安全性更新，您可以使用 Microsoft Baseline Security Analyzer (MBSA) 工具。這個工具能讓系統管理員掃描本機和遠端系統，判斷是否漏裝了安裝性更新或是有一般安全性設定不當的情形。如需更多有關 MBSA 的資訊，請瀏覽 [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134)。

您也可以查看下列的登錄機碼，來確認安全性更新安裝的檔案：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB828741\\Filelist

**附註：**如果管理員或 OEM 將 828741 安全性更新整合 (或 slipstream) 到 Windows 安裝來源檔時，這個登錄機碼可能無法正確建立。

#### Windows NT 4.0 (所有版本)

**必要條件**
這個安全性更新程式需要 Windows NT Workstation 4.0 Service Pack 6a (SP6a)、Windows NT Server 4.0 Service Pack 6a (SP6a) 或 Windows NT Server 4.0 Terminal Server Edition Service Pack 6 (SP6)。

以上所列的軟體版本已經過測試判斷其是否會受到影響。其他版本已不再包含安全性更新支援，同時也不一定會受到影響。請瀏覽 [Microsoft 技術支援週期準則網站](http://go.microsoft.com/fwlink/?linkid=21742)，以瞭解您的產品及版本的支援生命週期。

如需有關取得最新 Service Pack 的進一步資訊，請參閱 Microsoft 知識庫文件編號 [152734](http://support.microsoft.com/default.aspx?scid=kb;en-us;152734)。

**安裝資訊**

此安全更新支持以下安裝參數：

**/y**: 執行移除 (只使用 /m 或 /q )

**/f**：在關機程序中強制程式結束

**/n**：不建立解除安裝資料夾

**/z**：更新完成後不重新開機

**/q**：使用無訊息或自動安裝模式，無使用者介面 (這個參數是 /m 的超集合)

**/m**：使用有使用者介面的自動安裝模式

**/l**：列出已安裝的 Hotfix

**/x**：在不執行安裝程式的情況下解壓縮檔案

**附註：**您可以在同一個指令中合併使用這些參數。有關支援的安裝參數的其他資訊，請參閱 Microsoft 知識庫文件編號 [262841](http://support.microsoft.com/default.aspx?scid=kb;en-us;262841)。

**部署資訊**

在 Windows NT Server 4.0 上，如想在不需要使用者介入的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windowsnt4server-kb828741-x86-enu /q**

Windows NT Server 4.0 Terminal Server Edition：

**Windowsnt4terminalserver-kb828741-x86-enu /q**

Windows NT Workstation 4.0：

**Windowsnt4workstation-kb828741-x86-enu /q**

在 Windows NT Server 4.0 上，如想在不強制系統重新開機的狀況下安裝安全性更新，請使用以下的指令行命令：

**Windowsnt4server-kb828741-x86-enu /z**

Windows NT Server 4.0 Terminal Server Edition：

**Windowsnt4terminalserver-kb828741-x86-enu /z**

Windows NT Workstation 4.0：

**Windowsnt4workstation-kb828741-x86-enu /z**

如想進一步瞭解如何透過「軟體更新服務」部署這個安全性更新，請瀏覽[軟體更新服務網站](http://www.microsoft.com/windowsserversystem/sus/susoverview.mspx)。

**重新開機需求**

套用此安全性更新程式之後，您必須重新啟動系統。

**移除資訊**

若要移除此安全性更新，請使用 \[控制台\] 中的 \[新增/移除程式\]。

系統管理員可使用 Hotfix.exe 公用程式來移除此安全性更新。Hotfix.exe 公用程式位於 %Windir%\\$NTUninstallKB828741$ 資料夾中。Hotfix.exe 公用程式支援以下的安裝參數：

**/y：執行移除 (只使用 /m 或 /q 參數)**

**/f：在關機程序中強制程式結束**

**/n：不建立解除安裝資料夾**

**/z：安裝完成時，不重新啟動**: 安?完成?不重新??

**/q：使用無訊息或自動安裝模式，無使用者介面 (這個參數是 /m 參數的超集合)**

**/m：使用有使用者介面的自動安裝模式**

**/l：列出已安裝的 Hotfix**

**檔案資訊**

本更新程式的英文版本具有下表列出的檔案屬性 (或更新的版本)。這些檔案的日期及時間均使用 Coordinated Universal Time (UTC)。當您檢視檔案資訊時，它會轉換為當地時間。如想知道 UTC 及當地時間的時差，請使用 \[控制台\] 內的 \[日期/時間\] 工具的 **\[時區\] 索引標籤**。

**注意：**日期和時間資訊可能會在安裝時有所變更。您應該使用版本、大小及檔案名稱資訊來判斷檔案的正確性。

Windows 2000 Service Pack 2、Windows 2000 Service Pack 3 和 Windows 2000 Service Pack 4：

`日期           時間      版本                大小        檔案名稱----------------------------------------------------------25-Feb-2004  15:53  4.0.1381.7263     701,200  Ole32.dll08-Jan-2004  11:37  4.0.1381.7255      21,264  Rpcproxy.dll11-Aug-2003  14:29  4.0.1381.7230     345,872  Rpcrt4.dll25-Feb-2004  15:53  4.0.1381.7263     122,128  Rpcss.exe`

Windows NT Server 4.0 Terminal Server Edition：

`日期           時間      版本                大小        檔案名稱----------------------------------------------------------25-Feb-2004  15:52  4.0.1381.33562    701,200  Ole32.dll05-Dec-2003  17:51  4.0.1381.33559     21,264  Rpcproxy.dll11-Aug-2003  15:14  4.0.1381.33551    345,360  Rpcrt4.dll25-Feb-2004  15:52  4.0.1381.33562    124,176  Rpcss.exe`

**確認更新的安裝**

如果想確定受影響的系統是否安裝了某個安全性更新，您可以使用 Microsoft Baseline Security Analyzer (MBSA) 工具。這個工具能讓系統管理員掃描本機和遠端系統，判斷是否漏裝了安裝性更新或是有一般安全性設定不當的情形。如需更多有關 MBSA 的資訊，請瀏覽 [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) 網站。

您也可以查看下列的登錄機碼，來確認安全性更新安裝的檔案：

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Hotfix\\KB828741\\File 1

**附註：**如果管理員或 OEM 將 828741 安全性更新整合 (或 slipstream) 到 Windows 安裝來源檔時，這個登錄機碼可能無法正確建立。

### 其他資訊

**感謝：**

Microsoft [感謝](http://www.microsoft.com/technet/security/bulletin/policy.asp)下列人士協助我們一同保護我們的客戶：

-   [eEye Digital Security](http://www.eeye.com/html/) 報告 RPC Runtime 函式庫弱點 (CAN-2003-0813) 以及 RPCSS 服務弱點 (CAN-2004-0116)。
-   [Qualys](http://www.qualys.com/) 報告 CIS – RPC over HTTP 弱點 (CAN-2003-0807)。
-   [BindView](http://www.bindview.com/) 的 Todd Sabin 報告物件識別弱點 (CAN-2004-0124)。

**取得其他安全性更新：**

其他安全性議題的更新可由下列地點取得：

-   安全性更新可以從 [Microsoft 下載中心](http://www.microsoft.com/downloads/search.asp?search=keyword&value='security_patch'&opsysid=1) 取得，也可以利用 security\_patch 關鍵字搜尋輕易地找到。
-   使用者平台的更新可以在 [WindowsUpdate](http://go.microsoft.com/fwlink/?linkid=21130) 網站取得。

**支援**

-   美國及加拿大地區客戶可電洽 1-866-PCSAFETY [Microsoft 產品支援服務](http://go.microsoft.com/fwlink/?linkid=21131)以取得技術支援。 與安全性更新有關的支援電話不另外收費。
-   不同國家的客戶，可以從當地的 Microsoft 分公司取得支援。與安全性更新有關的支援電話不另外收費。關於如何連絡 Microsoft 技術支援的資訊，請造訪[世界各地技術支援網站](http://go.microsoft.com/fwlink/?linkid=21155)。

**Windows 安全性資源：**

-   [Microsoft TechNet 安全性](http://www.microsoft.com/technet/security/default.asp) 網站提供了有關 Microsoft 產品安全性的其他資訊。
-   [Microsoft 軟體更新服務](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   Windows Update 目錄：請參閱知識庫文件編號 [323166](http://support.microsoft.com/default.aspx?scid=kb;en-us;323166)，以取得更多關於 Windows Update 類別目錄的資訊。
-   [Office Update](http://office.microsoft.com/zh-tw/officeupdate/default.aspx)

**Software Update Services (SUS)：**

Microsoft Software Update Services (SUS) 能讓客戶以迅速可靠的方式，針對 Windows® 2000 和 Windows Server™ 2003 伺服器以及執行 Windows 2000 Professional 或 Windows XP Professional 的桌面系統部署最新的重要更新程式及安全性更新程式。

如想瞭解如何透過「軟體更新服務」部署這個安全性更新，請瀏覽[軟體更新服務](http://go.microsoft.com/fwlink/?linkid=21133)網站。

**Systems Management Server (SMS):**

Systems Management Server 可以用來協助部署這個安全性更新。如需更多有關 Systems Management Server 的資訊，請瀏覽 [SMS 網站](http://www.microsoft.com/taiwan/smserver/)。SMS 也提供一些額外的工具，例如 [SMS 2.0 Software Update Services Feature Pack](http://go.microsoft.com/fwlink/?linkid=21157) (英文) 及 [SMS 2.0 Administration Feature Pack](http://www.microsoft.com/taiwan/smserver/downloads/2003/adminpack.htm)，能協助系統管理員部署安全性更新。SMS 2.0 Software Update Services Feature Pack 能使用 Microsoft Baseline Security Analyzer 及 Microsoft Office Detection Tool，為安全性公告更新作業提供相當廣泛的支援。某些軟體更新程式在電腦重新啟動之後，會需要用到系統管理員的權限。

**注意：** SMS 2.0 Software Update Services Feature Pack 的編制清查能力，可以用來判斷特定系統所需安裝的更新程式，而 SMS 2.0 Administration Feature Pack 的 Elevated Rights Deployment Tool 則能夠用來進行安裝的作業。對於需要使用 Systems Management Server 來判斷安裝目標的更新，以及重新啟動系統之後需要管理員權限的更新而言，如此會是最佳的部署方式。

**免責聲明：**

Microsoft 知識庫 (Microsoft Knowledge Base) 中的資訊係按「現狀」提供，並不提供任何保證。不論明示或暗示，Microsoft 不作任何責任擔保，包括適售性以及適合特定用途之擔保責任。無論任何情況下的損害，Mi crosoft Corporation 及其供應商皆不負任何法律責任，包括直接、間接、偶發意外、推衍引發、業務利潤損失或特殊損害。即使 Microsoft corporation 及其供應商已被告知此類損害的可能性亦不負任何責任。某些地區並不允許排除及限制推衍後果或意外損害責任，因此前述限制不適用於這些地區。

**修訂：**

-   V1.0 (2004 年 4 月 13 日)：公告發行

*Built at 2014-04-18T01:50:00Z-07:00*

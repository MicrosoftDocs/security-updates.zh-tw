---
TOCTitle: 最佳化效能
Title: 最佳化效能
ms:assetid: '24dc9ca4-652b-41a6-9a99-95fdeca9120b'
ms:contentKeyID: 18112873
ms:mtpsurl: 'https://technet.microsoft.com/zh-tw/library/Cc720220(v=WS.10)'
---

最佳化效能
==========

本章節中的主題提供關於最佳化 RMS 部署效能的資訊。

最佳化目錄服務效能
------------------

您可以監看包括在 RMS 中的目錄服務效能計數器。如有需要，可以修改控制 Active Directory 快取屬性的登錄設定來達到最佳化效能。

登錄設定控制 Active Directory 快取的下列屬性：

-   最大快取主體數量
-   主體快取資訊的有效期間
-   最大快取群組數量
-   群組快取資訊的有效期間
-   最大快取群組成員項目數量
-   群組成員快取資訊的有效期間

一般而言，快取資訊的有效期間越長，或快取中的項目越多，RMS 回應取得目錄服務資訊要求的速度就越快。如果資訊儲存 Active Directory 快取中，就不需要反覆到 Active Directory 中執行查閱。這如此可縮短要求的回應時間。

將資訊儲存 Active Directory 快取中所需付出的代價是，需要較多的系統記憶體資源。在設定登錄設定時，需要考慮的另一個問題是，指定給一個項目的有效期間越長，從 Active Directory 快取所傳回的部分結果越可能無效。當 Active Directory 中的資訊變更，但是變更尚未反映到 Active Directory 快取時，可能會發生此狀況。如果 Active Directory 經常變更，您可能需要指定較短的快取資訊有效期間，以反應此變動頻率。

目錄服務效能計數器在本主題後面的＜[RMS：DirectoryServices 效能計數器](https://technet.microsoft.com/37afea1d-f320-4040-96d8-57c0b45e6d46)＞中加以說明。如需關於使用這些計數器的說明，請參閱本主題前面的＜[使用效能計數器](https://technet.microsoft.com/096c3b17-c082-46c4-939c-4373af0c9dec)＞。監看計數器是以「命中」相對於「未命中」的方式呈現。RMS 必須對每一個錯過執行 Active Directory 查閱。

如需關於登錄設定的詳細資訊及修改登錄設定的說明，請參閱本主題後面的＜[變更 Active Directory 快取設定](https://technet.microsoft.com/8789a7a5-2065-4fae-9104-e0a70f1f2fb6)＞。

最佳化 Active Directory 連線集區設定
------------------------------------

為了增進系統效能，您可以新增及修改控制 Active Directory 輕量型目錄存取通訊協定 (LDAP) 連線集區設定的登錄機碼。設定登錄機碼將在本主題後面的＜[變更連線集區登錄設定](https://technet.microsoft.com/c61d91db-a1ad-4ca5-a492-015da629afbc)＞中說明。

RMS 是設計來最佳化 LDAP 連線的。它建立每一個 Active Directory 通用類別目錄的連線，每一個連線可處理多重執行緒。為了提供強固性，它保存連線的集區以處理要求。為了避免對單一的通用類別目錄造成過重的負擔，RMS 使用演算法來發佈要求，方法是執行在通用類別目錄清單中的類別目錄間的負載平衡來做查詢。如有必要，它也會自動處理 LDAP 錯誤，和變更路徑到不同通用類別目錄的要求。

RMS 建立通用類別目錄清單，以使用「拓撲探索」演算法來做查詢。您可以指定在 RMS 服務啟動前，「拓撲探索」必須尋找的可用通用類別目錄的最大和最小數量。「拓撲探索」首先探索在目前網站中的通用類別目錄。如果需要其他的通用類別目錄，便會到其他的網站搜尋。也可以指定在 RMS 停止接受要求前，無法使用的最大連線數量。如果稍後無法使用查詢清單上的一或多個通用類別目錄，「拓撲探索」會開始搜尋替代的通用類別目錄，將其新增到查詢清單中。

另一種做法是，列出 RMS 可使用的通用類別目錄。在這種情況下，「拓撲探索」不會搜尋通用類別目錄來新增到查詢清單中。

您也可以設定 RMS 通用類別目錄間執行負載平衡時的設定方式。您可以指定傳送特定要求到特定通用類別目錄在方式上的相對重要性，下列為幾種方式：

-   **遞迴 (WtRoundRobin)**。此參數指定使用遞迴邏輯來達成負載平衡的相對重要性。預設比重設定為 1，表示是伺服器選取通用類別目錄時的最後考量。
-   **連線期間執行緒計數 (WtThreadCount)**。此參數指定配置到連線的執行緒數量的相對重要性。預設比重是設定為 100，表示減少所選取的通用類別目錄連線的執行緒數量，比使用遞迴達到負載平衡重要 100 倍。
-   **慢速連線 (WtSlow)**。此參數指定慢速連線的相對重要性。預設比重設定為 1,000，表示所選取的通用類別目錄連線不能太慢，比減少執行緒數量重要 10 倍。

---
TOCTitle: 系統復原準備
Title: 系統復原準備
ms:assetid: '885c047f-1e3b-4bf5-8248-3a4505759cbb'
ms:contentKeyID: 18113016
ms:mtpsurl: 'https://technet.microsoft.com/zh-tw/library/Cc747659(v=WS.10)'
---

系統復原準備
============

RMS 系統的任何元件故障 (包括 RMS 伺服器使用的網際網路與內部網路連線、RMS 憑證伺服器、任何子註冊 RMS 授權伺服器或主控 RMS 設定資料庫的資料庫伺服器) 都可能會導致無預警中斷服務。設定 RMS 系統時，務必考量 RMS 服務中斷對 IT 系統與您的機密資料造成的潛在影響，並準備要儘量有效復原元件。

主控 RMS 設定資料庫的資料庫伺服器發生故障可能是因為某種元件故障，因而阻礙繼續存取受 RMS 保護的資訊。本節說明為 RMS 系統準備系統復原的重要考量與因素，如下所示：

-   [網際網路連線](#bkmk_1)
-   [內部網路連線](#bkmk_2)
-   [憑證與授權服務](#bkmk_3)
-   [資料庫伺服器](#bkmk_4)
-   [Active Directory](#bkmk_5)

<span id="BKMK_1"></span>
網際網路連線
------------

如果您使用線上伺服器註冊，在提供過程中 RMS 伺服器需要網際網路連線，才能取得伺服器授權人憑證 (SLC)，並且每年更新一次。即將屆滿一周年時，憑證伺服器會將事件記錄到系統事件日誌，來通知您更新憑證。在 SLC 到期日前一個月 (事件識別碼 16)、在 SLC 到期日前一週 (事件識別碼 17) 及在 SLC 到期時 (事件識別碼 18) 記錄事件。RMS 管理網站的 RMS 通用管理網頁也會警示您 SLC 到期日即將來臨。如果使用 Microsoft Operations Manager (MOM) 的 RMS Management Pack，到期事件會啟動警示。如果 RMS 伺服器無法進行網際網路連線，則無法使用 RMS 管理網站中的 **\[更新\]** 按鈕來更新伺服器授權人憑證，必須使用離線註冊程序來要求更新的憑證。

基於最佳作法，請在到期日之前更新 SLC，以免在憑證到期時無法進行網際網路連線來更新。如果缺少有效的 SLC，RMS 伺服器無法提供 RMS 服務，這意味著使用者無法發行受 RMS 保護的資訊，或取得讀取受 RMS 保護的資訊所需的使用授權與權限帳號憑證 (RAC)。先前已取得部分受 RMS 保護的內容之使用授權與 RAC 的使用者可以繼續存取資訊，直到其使用授權或 RAC 過期為止。

<span id="BKMK_2"></span>
內部網路連線
------------

RMS 是一種依賴已連接的基礎結構之主從技術。如果內部網路無法正常運作，RMS 伺服器無法連線至企業內所需的服務或提供服務的使用者。如果未進行內部網路連線，使用者無法從 RMS 伺服器取得權限帳號憑證 (RAC)、用戶端授權人憑證 (CLC) 及使用授權。

基於最佳作法，組織應考慮從遠端到 RMS 伺服器端的備用路由架構與容錯移轉連結。

使用者取得使用者電腦的 CLC 後，使用者可以在未存取 RMS 伺服器時離線發行受 RMS 保護的資訊。部分 RMS 相容電子郵件應用程式已設定為在同步處理信箱時自動下載相關的受 RMS 保護的電子郵件訊息之使用授權，以便使用者即使無法再進行內部網路連線，也可以讀取受 RMS 保護的電子郵件訊息。

<span id="BKMK_3"></span>
憑證與授權服務
--------------

RMS 系統非常依賴 Internet Information Services (IIS) 6.0 版、憑證與授權服務內的兩個虛擬目錄。這些服務可讓使用者及其電腦向 RMS 環境與 RMS 相容應用程式註冊，以發行與存取受 RMS 保護的資訊。如果無法使用這些服務，可能已拒絕使用者使用服務，直到還原這些服務為止。

若要為潛在的服務中斷做好準備，請考慮建立憑證伺服器與子註冊授權伺服器叢集，這樣一來，叢集中的任何節點發生故障時也不會影響服務的可用性。

基於最佳作法，在叢集中增加一些容量，這樣一來，任何節點發生故障時都不會影響整體效能。安裝首部憑證伺服器與每部子註冊授權伺服器，或在叢集中安裝首部子註冊授權伺服器時，請詳細記錄設定選項及在提供過程中輸入的資料。

<span id="BKMK_4"></span>
資料庫伺服器
------------

RMS 系統中最重要的元件是擁有設定資料庫的資料庫伺服器。每部 RMS 伺服器或伺服器叢集使用資料庫儲存設定與記錄資訊。設定資訊對於 RMS 的操作非常重要。這些資料庫擁有伺服器授權人憑證、已產生的 RMS 原則範本以及在 RMS 系統內註冊的使用者清單，如果硬體安全性模組未與 RMS 伺服器搭配使用，它們還包含 RMS 伺服器的私密與公開金鑰。有了 RMS 資料庫的備份，您可以將先前的 RMS 安裝還原在新的伺服器上，並重新建立 RMS 系統。資料庫遺失的影響因資料庫而異。下列清單說明了特定資料庫故障的影響：

-   **設定資料庫**如果在操作 RMS 伺服器時無法使用此資料庫，RMS 服務還是可以繼續操作，因為 RMS 會在本機快取所需的資訊。但是，如果發生某個事件而需要 RMS 服務與設定資料庫進行互動 (如新的使用者註冊)，RMS 服務會發生錯誤，而且新使用者將無法使用受 RMS 保護的內容。如果進行某項操作而導致 RMS 伺服器捨棄快取的資訊，如重新啟動 IIS 服務或根據排程重新整理本機快取，則 RMS 服務會停止工作。RMS 伺服器無法回到正常的服務，除非設定資料庫又可以使用。
    如果設定資料庫已損毀或永久無法使用，RMS 伺服器將停止工作。
-   **目錄服務資料庫**擁有關於群組名稱的快取資訊，及從通用類別目錄伺服器取得的成員詳細資料。短時間內無法使用此表時，RMS 服務不會明顯減少。其主要目的是為通用類別目錄伺服器提供備用與減少服務負載。
-   **記錄資料庫**如果 RMS 伺服器已啟用記錄，則使用此資料庫儲存該記錄。如果無法使用該資料庫，則記錄項目會在 RMS 伺服器的 Message Queuing (亦稱為 MSMQ) 服務上堆積，並使用所有可用的磁碟空間，除非不是這樣設定。

基於最佳作法，請將資料庫伺服器叢集化以提供主動式備援的容錯移轉保護。此外，請定期備份 RMS 憑證伺服器與叢集的資料庫，以及授權伺服器與叢集的資料庫。

另一種最佳作法是，使用交易記錄傳送來維護準備就緒的備份資料庫。雖然此作法可能需要其他硬體，但是它可讓組織更快復原資料庫。Microsoft IT 已執行此方法來復原 RMS 設定資料庫。若要完成此操作，請在 RMS 提供過程中選取虛擬 SQL 名稱。虛擬 SQL 名稱可讓您使用網域名稱系統 (DNS) 對應至真實的 SQL 名稱。如果原始 SQL Server 停止工作，您可以改從原始伺服器對應至備份伺服器的 DNS 名稱，輕鬆地切換至備份 SQL Server。 如需關於在 Microsoft 內部執行此解決方案的詳細資訊，請參閱 [Microsoft 網站](http://go.microsoft.com/fwlink/?linkid=42070)(http://go.microsoft.com/fwlink/?LinkId=42070) 中的 Microsoft Corporation 個案研究。

<span id="BKMK_5"></span>
Active Directory
----------------

RMS 依靠 Active Directory 提供兩種重要服務：使用者驗證與通用類別目錄服務。如果無法使用 Active Directory，則無法進行使用者驗證，且使用者及其電腦將無法在 RMS 系統中註冊。需要憑證管線才能取得 RAC；此管線需要驗證。使用者具有 RAC 後，該個別使用者可以取得使用授權而無需進一步驗證，因為根據預設值，授權管線是匿名的。

由於企業實體可以使用 Active Directory 中的群組成員資格來表示誰可以存取受 RMS 保護的資訊，因此遺失 Active Directory 會禁止使用者取得使用授權。根據預設值，群組成員資訊會快取在 RMS 伺服器上 15 分鐘，因此可以容許暫時遺失通用類別目錄服務。如果要增加或減少更新快取之間的時間，您可以修改控制有效時間的登錄機碼。如需詳細資訊，請參閱本文件集內＜操作 RMS 伺服器＞一節中的＜修改 Active Directory 快取設定＞。

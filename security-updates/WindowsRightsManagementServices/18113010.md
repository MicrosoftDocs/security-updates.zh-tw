---
TOCTitle: 撤銷伺服器授權人憑證
Title: 撤銷伺服器授權人憑證
ms:assetid: '8020861d-d196-4431-8282-044675ef5616'
ms:contentKeyID: 18113010
ms:mtpsurl: 'https://technet.microsoft.com/zh-tw/library/Cc747578(v=WS.10)'
---

撤銷伺服器授權人憑證
====================

如果發生未預期的狀況導致 RMS 伺服器遭到入侵，組織可能需要撤銷伺服器授權人憑證。私密金鑰若沒有儲存在硬體安全性模組中，很容易被盜取。可控制伺服器的攻擊者，可能會洩漏組織中的伺服器授權人憑證和金鑰；或者對公司不滿的員工，可能會複製或移除憑證或金鑰。撤銷能夠封鎖危害並限制惡意使用者誤用。

根據預設值，發行授權或憑證的主體可以撤銷任何授權或憑證。因為 RMS 伺服器發行的授權和憑證和受到保護的內容有關聯，所以如有必要，永遠都可以將其撤銷。如果授權伺服器受到危害，可以撤銷其伺服器授權人憑證。當您在撤銷伺服器授權人憑證時，它所發行的所有的憑證和授權都變成無效。本主題前面的＜[執行撤銷](https://technet.microsoft.com/4735f060-7197-4ae2-830a-f91bcc4de30a)＞中提供了撤銷授權和憑證的指示。

但是，根憑證叢集是特殊的情況。根憑證叢集的伺服器授權人憑證是由 Microsoft「註冊服務」所發行，根據預設值，只有 Microsoft「註冊服務」可以撤銷其伺服器授權人憑證。

只有在收到法庭位要求且您已將伺服器的公開金鑰提供給法庭時，Microsoft 才會撤銷根憑證伺服器的伺服器授權人憑證。當法庭通知 Microsoft 已簽發撤銷命令時，Microsoft 將會依據撤銷清單中的公開金鑰來指定伺服器授權人憑證，並開放該撤銷清單以供存取。若要撤銷授權的伺服器符合下列情況時，您可以從法庭要求撤銷命令：

-   該伺服器屬於您所有，且其私密金鑰已被洩漏。
-   將由該伺服器發行的內容屬於您所有，且該發行動作已侵犯您的著作權。

請依照本節前面＜[部署撤銷清單](https://technet.microsoft.com/e331338b-66d4-45e4-8d3f-acccf2302ac4)＞中所述步驟，從 Microsoft 取得和發佈撤銷清單，此撤銷清單包括根憑證伺服器的已撤銷伺服器授權人憑證。

在提供根憑證伺服器時，您可以指定擁有撤銷根憑證叢集的伺服器授權人憑證授權的公開金鑰。該公開金鑰可以屬於組織或屬於協力廠商。由相對應的私密金鑰所發行的撤銷清單，可以撤銷伺服器授權人憑證。

若要撤銷根憑證伺服器的伺服器授權人憑證，您可以建立指定此伺服器授權人憑證的撤銷清單，以組織或協力廠商的私密金鑰簽署，然後將撤銷清單發佈給所有使用者。如需相關指示，請參閱本主題前面＜[部署撤銷清單](https://technet.microsoft.com/e331338b-66d4-45e4-8d3f-acccf2302ac4)＞中的＜部署組織的撤銷清單＞。

您可以使用下列參數來撤銷在撤銷清單中的伺服器授權人憑證：

-   **GUID**。可根據全域唯一識別碼 (GUID) 撤銷伺服器授權人憑證。如需關於在撤銷清單使用此參數的詳細資訊，請參閱本主題前面＜[建立撤銷清單](https://technet.microsoft.com/1ef75199-3344-4225-84de-a863a777696a)＞中的＜以 GUID 為基礎撤銷憑證和授權＞。
-   **雜湊值**。可以根據憑證主體中 Unicode 字元的 SHA-1 雜湊撤銷伺服器授權人憑證。如需關於在撤銷清單使用此參數的詳細資訊，請參閱本主題前面＜[建立撤銷清單](https://technet.microsoft.com/1ef75199-3344-4225-84de-a863a777696a)＞中的＜以雜湊值為基礎撤銷憑證和授權＞。

若要取得 RMS 安裝的伺服器授權人憑證，必須查詢 RMS 設定資料庫。下列步驟說明如何從 SQL 設定資料庫取得此資訊，並儲存成可以使用瀏覽器閱讀的檔案：

1.  開啟 SQL Query Analyzer，然後連線到根憑證伺服器的設定資料庫。
2.  在 **\[查詢\]** 功能表上按一下 **\[以文字顯示結果\]**。
3.  在 **\[工具\]** 功能表上，按一下 **\[選項\]** 以開啟 **\[選項\]** 對話方塊。按一下 **\[結果\]** 索引標籤，然後將 **\[每個資料行的最大字元數\]** 設定為 **8192**。
        ```
1.  從 **\[結果\]** 視窗複製結果，然後將這些結果貼到文字編輯器 (例如：記事本) 中。將結果儲存到副檔名為 .xml 的檔案中。

如需關於如何在撤銷清單中使用此資訊的詳細資訊，請參閱本主題前面的＜[建立撤銷清單](https://technet.microsoft.com/1ef75199-3344-4225-84de-a863a777696a)＞。

一旦將伺服器授權人憑證資訊儲存為 XML 檔案後，您就可以使用下列步驟從該檔案擷取公開金鑰：

1.  在 XML 或文字檔編輯器中開啟伺服器授權人憑證 XML 檔案。
2.  在 &lt;ISSUEDPRINCIPALS&gt; 區段，複製 &lt;PUBLICKEY&gt; 元素。
3.  將此資訊儲存為檔案並提交給法庭或放在組織撤銷清單中。

撤銷根憑證叢集的伺服器授權人憑證後，對於要求撤銷清單的內容而言，您的 RMS 安裝所發行的所有憑證與授權會變成無效，且該內容會變成無法存取。此程序並不會受使用者所擁有之授權類型所影響。若要保留伺服器所發行、且其授權已被撤銷的內容，您必須在執行撤銷清單前採取下列其中一個動作：

-   儲存該內容而不採用 RMS 保護。
-   重新發行該內容而不理會撤銷清單需求。

不論是由 Microsoft 撤銷或是由協力廠商撤銷，撤銷清單對所有繫結要求都生效，因為它是由使用授權的信任鏈結中之主體以私密金鑰所簽署。因此，所有涉及 RMS 安裝所發行授權的結合性要求將會失敗，此授權是經由使用撤銷的伺服器授權人憑證所發行。

| ![](images/Cc747578.note(WS.10).gif)附註 |
|-----------------------------------------------------------------------|
| Microsoft 只會在被法庭要求這麼做時才會撤銷伺服器授權人憑證。          |
